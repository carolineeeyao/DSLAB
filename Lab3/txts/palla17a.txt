  BirthDeath Process for Feature Allocation

Konstantina Palla   David Knowles   Zoubin Ghahramani    

Abstract

We propose   Bayesian nonparametric prior over
feature allocations for sequential data  the birthdeath feature allocation process  BDFP  The
BDFP models the evolution of the feature allocation of   set of   objects across   covariate       time  by creating and deleting features 
  BDFP is exchangeable  projective  stationary
and reversible  and its equilibrium distribution
is given by the Indian buffet process  IBP  We
show that the Beta process on an extended space
is the de Finetti mixing distribution underlying
the BDFP  Finally  we present the  nite approximation of the BDFP  the Beta Event Process
 BEP  that permits simpli ed inference  The
utility of the BDFP as   prior is demonstrated on
real world dynamic genomics and social network
data 

  Introduction   Problem Statement
We are interested in time series settings where we observe
data  Yt                        We consider problems
where the observations are explained by   latent structure
which assigns objects to features and this feature allocation changes over time  For instance  consider the topics covered by   number of newspapers over time  some
topics  die  while new ones are  born  The topic coverage of each paper is its latent feature allocation which
could be modelled with an Indian buffet process  Grif ths
  Ghahramani    IBP  While static feature allocation
models are well studied  these are not able to handle the
time series nature of many datasets  We propose   process
that extends the IBP by allowing the feature allocation to
evolve over the covariate as   result of  birth  and  death 
of features 

 University of Oxford  Oxford  UK  Stanford University  California  USA  University of Cambridge  Cambridge  UK  Uber AI
Labs  SF  California  USA  Correspondence to  Konstantina Palla
 konstantina palla gmail com 

Proceedings of the   th International Conference on Machine
Learning  Sydney  Australia  PMLR     Copyright  
by the author   

  Related Work
We target problems where the data depends on   covariate 
such as time or space  and is explained by   latent structure  in particular    multimembership  clustering of the
data points  The observations are result of the underlying
partitioning and its evolution over the covariate  Typical
models fall in two main categories  clustering and feature
allocation  The former allow each data point to belong to
one and only one class  cluster  while the latter let each
data point belong to multiple groups  features  Bayesian
nonparametric approaches are primarily based on the Chinese restaurant process  CRP  Aldous    or the Indian
buffet process  IBP  Grif ths   Ghahramani    corresponding to the two categories 
In particular    sample from   CRP is an assignment of data points to disjoint classes    clustering  while   sample from an IBP is
an allocation of the data points to  possibly  overlapping
classes    feature allocation  Dependent nonparametric
processes extend distributions over partitions to distributions over collections of partitions indexed by locations in
some covariate space  such as          continuous time 
        discrete time  or Rd       geographical location 
Teh et al    de ne such   process based on the duality between Kingman   coalescent  Kingman    and
the Dirichlet diffusion tree  Neal    In the resulting
 FragmentationCoagulation  process  FCP    partitioning
of the data points evolves over the covariate undergoing
fragmentation and coagulation events while maintaining
CRP marginals  More recently  Palla et al    derived
  dependent partitionvalued process  DPVP  on an arbitrary covariate space which  like the FCP  is exchangeable
and has CRP distributed marginals  In the setting of feature allocations  Williamson et al    propose   nonparametric process  the dependent IBP  dIBP  with IBP
distributed marginals and in which the feature allocations
are coupled over the covariate space using   Gaussian process  GP  Rasmussen   Williams    In   similar vein 
Van Gael et al   iFHMM    de ne the Markov Indian
Buffet process  mIBP    probability distribution over   potentially in nite number of binary Markov chains evolving
in discrete time  They use the mIBP to extend the factorial hidden Markov model  FHMM  Ghahramani   Jordan 
  to the in nite FHMM  iFHMM 
In this paper  we address the problem of dependence for

  BirthDeath Process for Feature Allocation

binary latent feature models  We propose   process that extends the IBP by allowing features to be  born  and  die 
at times learnt by the model  while maintaining the essential mathematical properties of the IBP  The process is  
Markov Jump process  MJP  where the events are the birth
or the death of   feature  The idea is closely related to the
FCP where the events are either   fragmentation of   cluster or   coagulation of two clusters  The partitions at each
location in the FCP are marginally   sample from   Chinese restaurant process  while the feature allocations in the
BDFP are marginally samples from an IBP  Compared to
the dIBP  both processes model feature allocations evolving over the covariate  However  while in the dIBP the
assignment of data points to   feature might change over
the covariate  in our process  it remains the same until the
feature dies  In the case of the iFHMM  the authors model
the dependence of   feature allocation on   discrete time
variable as opposed to our process where continuous covariate space is assumed  Moreover  in the iFHMM  the
marginal distribution of   feature allocation is analogous
but not equal to an IBP  We call the proposed process the
birthdeath feature allocation process  BDFP  The BDFP
is exchangeable  projective  stationary and reversible  and
its equilibrium distribution is given by the Indian buffet
process 

  Feature Allocations and the Indian Buffet

Process

Consider   dataset with   data points indexed by integers
                       allowing       Each datapoint   is associated with   binary vector Zn of length
  that de nes its feature allocation  Znk     if datapoint   has feature   and Znk     otherwise  The potential total number of features   may be in nite  The
     speci es   ranbinary matrix          ZT
dom feature allocation of      while ZN denotes the space
of all feature allocations of                   ZN   We de 
 ne mk as the number of datapoints that possess feature
   Kh as the number of features for which
mk     and Kh as the multiplicity of feature    that is
the number of times the same binary column   appears in
      Under the IBP  Grif ths   Ghahramani    the
probability of   matrix       is

       cid   

            ZT

    ZT

   cid  

   Kh 

exp HN  

     mk mk    

   

  cid 

  

           

 

 cid  

 
where       is the concentration parameter  HN  
  is the Nth harmonic number and           
is the number of distinct nonzero features in the allocation 
Thibaux   Jordan   showed one can construct the Indian buffet process from   BetaBernoulli process using the

  

following two stage sampling process for                 

 

where      cid 

        BP      Zn     BeP   

        and      cid 

   fk    First
  draw   is sampled from the Beta process BP   
 Hjort    with   as the base distribution    is   set
of pairs         sampled from   Poisson process on the
product space         with   evy intensity         
             Then    is used as the atomic
hazard measure for   Bernoulli process BeP    Each
Zn is   draw from the Bernoulli process and constitutes
  collection of atoms of unit mass on   Then  Zn is
  binary vector containing the  fk 
   values resulting
from tossing   countably in nite sequence of  conditionally independent  coins with success probabilities         
fk     Bernoulli    This construction allows the use
of de Finetti   theorem  de Finetti    that lets the joint
distribution of the rows to be written as

 cid   cid    cid 

 cid 

              ZN    

   Zn   

dP    

 

  

where   is the random measure that renders the variables
Zn conditionally independent  Equation   shows the exchangeability of the rows of Zn  since they can be described as   mixture of Bernoulli processes 

  BirthDeath Process for Feature Allocation
We consider   continuoustime Markov process        
in which each      is   random feature allocation taking values in the discrete space ZN   The state space is
countably in nite  it is determined by all the possible feature allocations de ned by   datapoints and   features 
where       The Markov process       evolves over
time jumping to different states  feature allocations  Let
            tJ              denote the times when the chain
jumps such that tj   inf    tj          cid    tj 
and   tj    ZN   These jumps are   result of   birth or
  death of   feature  The process       can only jump to
neighbouring states      
if the chain is currently at state
  tj       then at time tj  it transitions to   tj      cid 
where   new feature is created or an existing feature is
deleted after   birth or   death event respectively  Let
   
    ZN be the discrete space of neighboring states to
state    The process is time homogeneous with transition
probabilities                cid                     
  cid           pss cid    for all       where      cid          At
time tj  the process jumps to the next state   tj      cid 
with rate determined by the current state          and the
corresponding event      birth or death  More speci cally 
  Birth  Suppose     ZN is   feature allocation with
  is another feature

Ks nonzero features and   cid       

  BirthDeath Process for Feature Allocation

allocation that differs from   in having one additional
feature of size     so that   cid 
    Ks     We choose
the transition rate from   to   cid  as

Then 

        

   
  
  Kh 

 

exp  HN  

  cid 

  

qss cid     

              

   

 

mK   

 

where       is   parameter governing the birth
rate  The new feature   is   binary column of length

   There are cid      
ture and           cid  
 cid  
where HN  cid  

 cid  

 cid 

 cid  binary formulations for this fea 
 cid  for all possible fea 
 cid  
    cid  

  

 

ture births and thus  the total birth rate from   is
        HN
      is the Nth harmonic num 

         

  

  

   

 

 

ber and          

  Death  The rate of transitioning from   cid  to   is

qs cid    

Rr
 

 

where      
  is   parameter governing the death rate
and   is the multiplicity of the feature in   cid  that dies 
The multiplicity   is the combinatorial factor that accounts for all the possible ways of obtaining the same
equivalence class as de ned in Grif ths   Ghahramani     There are Ks cid  features  including repetitions of the same feature  in   cid  that might  die  thus
the total death rate from   cid  is RKs cid 
   

 cid 

 cid 

HN   Ks
 

The total rate of transition out of state     ZN is the sum
of the total birth and death rates  qs   RHN   RKs
   
  We call           birthdeath feature
 
allocation process with birth rate   and death rate  
  and
write BDFP    
Theorem   The Markov process         is irreducible
and has stationary distribution IBP  Furthermore  it is
reversible 

Proof    continuous time Markov chain is irreducible if it
is possible to eventually get from every state to every other
state with positive probability  It is reversible if detailed
balance holds       there is   probability distribution   on
ZN such that  sqss cid       cid qs cid   for all      cid    ZN   Then   is
also the invariant  equilibrium  distribution of the Markov
chain  The chain in BDFP is irreducible  because for any
      and any two distinct feature allocations       ZN  
there is   positive probability that if it starts at     ZN  
it will end at     ZN   Reversibility and the equilibrium
distribution can be demonstrated by detailed balance  Suppose     are feature allocations such that       ZN and  
differs from   in that it has one additional feature   of size
    The number of  nonzero  features in   is          

     mk mk    

              

 

   

    cid 

   
     mk mk    

 

  cid 
  cid 

  

  

   
     mk mk    

 
 
     mk mk    

   

  

   

 

ra

 
 

ra

exp  HN  

 

     
  
  Kh 
exp  HN  

exp  HN  

 

   
  
  Kh 

  

    

   
  
  Kh 

 

        

where      is the probability of   feature allocation  
under the IBP as de ned in Equation      is the transition rate from state   to state         are the number of
distinct features in states   and   respectively and ra is the
multiplicity  the times the feature is present at the current
feature allocation  of feature   that dies  Detailed balance
holds  and as such the process is reversible and the equilibrium distribution is IBP    

Assume that       is   realization of the BDFP      
over the  nite interval
            and we write
           With probability one the sample path
         will only contain    nite number of jump
events  each of which is either   birth or   death event  We
write   and   to denote the set of the features created or
turned off by birth or death events respectively 
Proposition   Writing        qz    to denote the total
transition rate out of state      the probability of   realization       under the law of the BDFP is 
 cid     
              

exp  HN   exp

 cid   

 cid   

  

Kh 

    dt
              

 

 cid         
 cid 

rd

 cid 

        

   

   

 

where                KT                      
HT             are the sets of features with zero multiplicity at their creation time or with multiplicity of one at
their death time respectively  and       denotes the set of
features at time   

  Dependent Beta Process Construction

The BDFP process can be constructed using   nonhomogenous Poisson process   Consider the   evy measure    dxdtbdt  on   product space              
    sample corresponds to set of points    
    xk  tk
   where the range of   is countably in nite 
Each atom corresponds to   feature and is associated with
     
  weight            location xk    birth time tk
       Figure   The   evy measure
and   lifespan tk
is of the form    dxdtbdt       dxdtbdt  and

    tk

  BirthDeath Process for Feature Allocation

 
 

 

tb

Figure   Cartoon for the dependent Beta process construction of
the BDFP    realisation of   Poisson process   over the product
space                 is drawn  The    dimension over
the space   is omitted in the axis representation  However 
each    corresponding to each point  feature  is drawn as   blue
line of length    starting at the associated birth time point 

corresponds to   Beta process on the combined space    
          with             and base
measure        dxdtbdtw  Setting   dtb    dtb and
 dt      exp Dt  dt  the base measure is      
 dx   dtb dt     dx dtbD exp Dt  dt  where
  is the death rate  The constant measure   dtb  over the
real line   is in nite but  nite  that is the total measure
         but there is   measurable partition  Ek  of  
 cid 
with each   Ek      Since       integrates to in   
                countably in nite number of        random points        
      is  
nite with probability one    Beta process is   completely
random measure  Kingman    and  as such    sample
             BP 
where the atoms       xk  tk
      and weights
    tk
        
Having drawn   sample   we can construct the feature allocations over an index space   as follows 

ity but satis es cid 
are obtained from the Poisson process and cid 
can be expressed as      cid 

 

  

 cid 
 cid 

  

   

    

      BP 

Sn   

bnk 

     BeP   

  

Znk      SnkI tk

    tk
 

        tk

 
with bnk     Bernoulli    and                  The binary matrix   of dimension        is   feature potential
matrix  Each binary element Snk indicates whether object
  possesses feature fk    is   global variable and doesn  
depend on time    At any time    the feature allocation matrix      is   deterministic function of the current features
present at    that is  fk   tk
                

        tk

    tk

    tk

 
    tk

        tk

  Repeat this process for all objects 

and the feature potential matrix         Znk        iff
Snk     and tk
The resulting feature allocation process  zn     is equivalent to the following  every time   new feature fk is created 
      
each object   joins with probability          znk tk
Bernoulli    If znk tk
        object   will possess feature fk until tk
Proposition   The BDFP is exchangeable and the Beta
process BP  on      describes its underlying
mixing measure 
Proof  Consider   sequence of variables  zn     with
                  such that each  zn     is the feature allocation evolution of object   over the index space    These
variables are not independent since each  zn     depends
on the                    However  given   sample from the     BP  described in Section   each
variable  zn     becomes conditionally independent and
the following holds
                           zN        

   zn       dB 

 cid    cid 

where     BP 

  

 

Equation   is the de Finetti representation of the BDFP
and as such the BDFP is exchangeable and the BP on
              is its underlying mixing measure 
Restricting our focus on each index    the overall Beta process BP  on           results in   set of dependent random measures over    one Bt for each        such
that each Bt is marginally   Beta process  Consider    xed
time point       and the space          the red vertical
plane in Figure   The point process on this plane  where
blue lines intersect the plane  corresponds to features alive
at time              tb  tb      The   evy measure on this
plane  is calculated by projecting the overall   evy measure
onto the plane 

     dx   

   dxdtbdt 

 cid   

 cid   

 

    

 

         dx 

 
where    is   measure over         for   speci         
More speci cally  it is the   evy measure of   Beta process
on   with             and base measure
   dx     dx 

    Thus we have that marginally
Bt       BP           

 
The restricted and projected measure at any index       de 
 nes   Beta process  Two draws  Bt and Bs  with          
will be dependent with the amount of dependence decreasing as         increases 
Proposition   The dependent Beta process construction
presented has IBP marginals at any   

  BirthDeath Process for Feature Allocation

Proof  At any        Bt       BP    It is straightforward to see that  marginally  the feature allocation matrix Zt obtained using the generative process in Equation   is equivalent to Zt Bt   BeP Bt  and therefore
Zt   IBP         
Corollary   At any        the feature allocation matrix
Zt can be generated by the following generative model as
     

      Beta

  Znk     Bernoulli   

 

 cid   

 cid 

 

for                 and                

The proof of the corollary in included in the supplementary
material  Note that the above is true only marginally      
at time       and it doesn   generste dependence structure
between Zt   
We underline the dependence of Zs and Zt when         
             The closer      are  the more the atoms
 features  Bs and Bt share  If we independently sampled
Zs Bs   BeP Bs  and Zt Bt   BeP Bt  then Zs  Zt
would be dependent  but not equal  even as            
However  in the BDFP the presence of the same features results in the same  not just similar  allocation as           
In both cases  the marginal distribution of the feature allocation matrix at any       is Zt Bt   BeP Bt  and
Zt    IBP  The BDFP results in   continuous evolution of the      over    formally Zt
This construction of the BDFP resembles the spatial normalised Gamma process  SN    by  Rao   Teh   
The main difference lies in the marginal distribution  the
SN   admits DP marginals as opposed to the Beta process
marginals of the dependent Beta process as shown in Equation  
Proposition   The feature allocation process described
by Equation   with     BP  has the same birth and
death rates as the BDF process 

   Zs as       

  Finite Model
For the BDFP  the inference simpli es considerably if we
consider    nite approximation which gives the countably in nite model
in the limit  Consider the space
                        where we restrict the
space of tb to be       instead of the whole real line
   This accounts for typical applications of the model
where we observe data at distinct
times over    nite
time range  Consider the   evy measure    dxdtbdt 
on the space    Then  under the dependent Beta process representation  see section   the expected number of atoms present
     dxdtbdt   
   dt    KT   where

in   is  cid 
    dtb cid   

   dx cid   

 cid   
     cid 

FEATURES PRESENT

fk

 

tfk
 

tfk
 

 

  cid 

 

      since cid   

Figure   Cartoon for the Beta event construction of the BDFP 
  Poisson KT   number of features are uniformly distributed
across the time range        blue lines  Each feature is assigned
  weight sampled from Beta   
      The leftmost point of each
line corresponds to the time of birth of that feature  while the
length of each line indicates the life span of each feature sampled from Exponential    To sample feature allocations from
the process  we consider random time points across time            cid 
and draw imaginary red lines  The feature allocation matrix at  
involves the features that are crossing the red line at    The membership of the objects                 to those features is de ned
by the values of the corresponding elemnts in the potential matrix
  

          By considering  nite  
we allow inference on    nite model which approximates
the in nite case with increasing  delity as      
The process is depicted in Figure   and the in nite case can
be derived as the limit       of the following 

Beta cid   

     cid  and                  

  Consider   time range       and   set of features   
such that       Poisson KT   Assign to each feature
fk                      weight   such that     
  Associate each feature fk                    with
   
tk
   
  For each fk      sample its life span tk
Exponential    where   is the death rate  De ne
  and tw  
the time of death tk
   

  birth time tk
       and tb      

  uniformly sampled in      

   
         
 

    tk

  as tk

    tk

   
   

 

         

We call the sequence of the above steps Beta Event Process  BEP  Putting everything together  generate   sample
          tb  tw    BEP            as follows 

 cid   

 cid 

      Poisson KT  

 

   

     Beta

           tk
  tk

    Exponential   
 
for                 Having drawn   sample   from the
BEP  we can construct the feature allocations over time as
follows

Snk     Bernoulli   
Znk      SnkI tk

        tk

    tk
 

 

  BirthDeath Process for Feature Allocation

where                  The feature potential matrix  as de 
 ned in section   has now         dimensions  Moreover  each      for       is   matrix of dimensions
          and             Figure     show the graphical model for the BEP 

 

 

 

 

 

 

tw

 

tb

tw

 

 

Yt

 

 

tb

Zt

   

Wt

 

Yt

 

Zt

   

Figure   Graphical representation of the BEP for   time point  
and for       linearGaussian likelihood and       sigmoid likelihood  The time series   and   are represented as single nodes
indexed by the time location    The birth and life span times of
the total KT features are depicted using vector notation tb and
tw  The black  Zt  and grey  Yt  nodes indicate deterministic
and observed parameters respectively 

Proposition   In the  nite model  the expected number
of features present at any       is   Nf      
  and for
     

  we have   Nf       
   

Hyperpriors  We put gamma priors on   and   

Likelihood models  We consider two different likelihood
models  linearGaussian for real data and logistic for binary network data 
For the linearGaussian likelihood model  consider   sequence of observations  Yt                        generated
as

Yt   ZtA     

  shared across time and        cid   

 
where Yt is         observation matrix at each time    
               is   factor loading matrix of dimension      
noise  We choose   Gaussian prior over        Af    
     

 cid  is Gaussian white

 

In the case of dynamic binary network data we extend
the latent feature relational model  LFRM  proposed by
 Miller et al    Let Yt be the       binary matrix
that contains links       ytij   Yt           iff we observe
  link from entity   to entity   at time    We assume that the
matrices Yt are symmetric and ignore diagonal elements
 selflinks  The probability of   link from one entity to another is determined by the combined effect of all pairwise
feature interactions  Let Wt be             realvalued
weight matrix where Wt      cid  is the weight that affects
the probability of there being   link from entity   to entity
  if entity   has feature   on       Ztik   Zt           and
entity   has feature   cid  on       Ztjk cid    Zt      cid      The
links are independent conditioned on Zt and Wt  and only
the features that are on for the entities   and   at time   in 
 uence the probability of   link between those entities at
that time  see Figure     Formally 
   ytij    Zt  Wt     

 cid cid 

ZtikZtjlWtkl    

 cid 

 

kl

for                    where   is   bias term and      
         is the sigmoid function  For completeness 

we assume the priors wt           cid     
  cid     

 cid  and    

 cid 

 

 

  Inference

As with many other Bayesian models  exact inference
is intractable so we employ Markov Chain Monte Carlo
 MCMC  for posterior inference over the latent variables
of the  nite model    detailed description is provided in
the supplementary material 

  Experiments
We experimentally evaluate the BEP model on realworld
genomics and social network data  To evaluate the model
    we compared the BEP model to independent models at
each time point 

  Circadian Rhythm Dataset

Here we used   subset of the gene expression data from
Piechota et al    including       genes in      
different conditions  exposure to different drugs  over    
  time intervals  The measurements indicate how active
  gene is at different times  We created   traintest splits
holding out   of the data  and ran   MCMC iterations  We see that in terms of predictive performance the
BEP outperforms independent IBP models  Table   The
genes belonging to each factor show enrichment for different known biological pathways  Figure   Of particular
note are the tryptophan metabolism genes enriched in factor   given tryptophan   suspected effects on drowsiness 

  BirthDeath Process for Feature Allocation

the vasopressin regulated water reabsorption  given this
hormone   known circadian regulation  Earnest   Sladek 
  Yamaguchi et al    and the regulation of insulin producing beta cells  another hormone with circadian
variation  Shi et al   

Table   Circadian dataset results using   held out data    truncation level of                 iterations and   burnin of
  Results are the average over   MCMC chains 

TRAIN ERROR
TEST ERROR
TRAIN LOG LIKELIHOOD
TEST LOG LIKELIHOOD

BEP

INDEPENDENT IBP
     
     
     
     
     
     
           

Figure   Circadian dataset  many of the features uncovered show
enrichment in known biological pathways from Reactome and
KEGG  Values here are   log    from   hypergeometric test for
enrichment of the genes in each factor against the   background
genes 

  ChIPseq Epigenetic Marks

For this experiment we used ChIPseq  chromatin immunoprecipitation sequencing  data downloaded from the ENCODE project  Consortium    representing histone
modi cations and transcription factor binding in human
neural crest cell lines  see  Park    for   nice review 
The observations involve counts associated with      
 human  cell lines and       proteins  The counts indicate what proteins  with what chemical modi cations  are
bound to DNA along the genome  The measurements are
stored in       matrix of counts Yt  for each cell line 
how many reads for each of the   proteins mapped to bin  
  base pair  bp  region of the genome                 
bins were considered at the start of chromosome     
bp in total  In Figure     each sub gure corresponds to
one of the   proteins and in each sub gure the counts for
the       cell lines are plotted over the genome section of length  Kbp  Before inference  the raw counts
were squareroot transformed    standard variance stabilizing transform for Poisson data  to make the Gaussian
likelihood appropriate  We ran   different heldout tests 
holding out   different   of the data each time  Results 
using   MCMC iterations  are presented in Table   The

BEP outperforms the independent IBP model in both test
likelihood and error with   statistically signi cant difference  The independent IBP appears to have better results
in train error and likelihood  again suggesting over tting 
Comparing the plots of the true measurements to the learnt
ones by the BEP and independent IBP model in Figure  
we see that both models successfully reproduce the data
but the BEP reconstructions provide   cleaned up picture
of the meaningful signal 
The features found by the model in the different genome
locations correspond to different states associated with the
speci   genome location  Genes and regulatory DNA elements such as enhancers  silencers and insulators are embedded in genomes  These genomic elements on the DNA
have footprints for the transacting proteins involved in transcription  either for the positioning or regulation of the transcriptional machinery  For instance  promoters are regions
of DNA which recruit proteins required to initiate transcription of   particular gene and located near the transcription
start sites  Enhancers are regions of DNA that can be bound
by proteins which activate transcription of   distal gene 
So   cell line  at speci   genome location  recall that here
each location corresponds to   base pairs  will have underlying feature membership  some promoters and some
enhancer for example  that determines whether particular
protein are found there using ChIPseq 
Genomic annotations  from ChromHMM  Ernst et al 
  are shown in Figure   in the supplementary document for the region we model  Different levels of the marks
in these different regions are much easier to see in the reconstructed signal using BEP in Figure    

Table   Quantitative results for the ChIPseq dataset     held
out data    truncation level of                 iterations
and   burnin of   Results are the average over   held out sets 

BEP

     
     
     

INDEPENDENT IBP
     
TRAIN ERROR
     
TEST ERROR
TRAIN LOG LIKELIHOOD            
     
TEST LOG LIKELIHOOD
  van de Bunt   Dataset
In van de Bunt et al      university freshman students in   given discipline at   Dutch university were surveyed at seven time points about who in their class they
considered as friends  Initially          most of the students
were unknown to each other  The  rst four time points are
three weeks apart  whereas the last three time points are six
weeks apart as showin in Figure   in the supplementary
matrial  We symmetrise the matrix by assuming friendship
if either individual reported it  We test the performance
of BEP using the sigmoid likelihood model as in Equation

feature index Kegg Tryptophan MetabolismKegg RibosomeKegg Ppar Signaling PathwayKegg Vascular Smooth Muscle ContractionKegg Vasopressin Regulated Water ReabsorptionReactome Formation Of   Pool Of Free    SubunitsReactome Formation Of The Ternary Complex And Subsequently The    ComplexReactome Influenza Viral Rna Transcription And ReplicationReactome Muscle ContractionReactome Nuclear Receptor Transcription PathwayReactome Regulation Of Beta Cell DevelopmentReactome Regulation Of Gene Expression In Beta CellsReactome Regulation Of Lipid Metabolism By Peroxisome Proliferator Activated Receptor AlphaReactome Translation Initiation Complex FormationReactome Viral Mrna TranslationReactome Smooth Muscle Contraction   BirthDeath Process for Feature Allocation

   

   

   

Figure   ChIPseq data  The observed     and reconstructed observations         The BEP reconstructions smooth out the noise
making the meaning signal much easier to visualize  In both models  the noise signal was removed from the reconstructions 

  by holding out   of all links across all time points 
We ran each model for   MCMC iterations  The results are shown in Table   The independent network LFR
models outperform BEP in the train setting and the test error while BEP outperforms in the test likelihood  However  here the results are comparable  Looking at Figure
  both models provide the same picture of the allocation 
It is possible the stationary assumption hurts the BEP  in
the VDB dataset the number of links almost exclusively increases over time 

Table   van de Bunt   dataset results using   held out data   
truncation level of                 iterations and   burnin
of   Results are the average over   MCMC chains 

TRAIN ERROR
TEST ERROR
TRAIN LOG LIKELIHOOD
TEST LOG LIKELIHOOD

BEP

INDEPENDENT LFRM
     
     
           
     
     

     
     

Figure   Inferred feature allocation matrices for the seven time
points  from left to right  in the van De Bunt friendship dataset 
First two rows  Feature allocation matrices inferred by BEP 
Last two rows  Feature allocation matrices inferred by independent LFRM 

  Discussion
Many modern machine learning and statistics tasks involve
multidimensional data positioned along some linear covariate  we have shown functional genomics data where the covariate is position in the genome  and network data where
links change over time  To model such data we need priors that utilize the dependencies through time  while handling high dimensionality  The BDFP is an expressive new
Bayesian nonparametric prior that ful lls these criteria  It
outputs timeevolving feature allocations  which can then
be effectively used to model highdimensional timeseries
data  Since the number of latent features is unbounded 
like other Bayesian nonparametric methods  the model
can adapt its complexity to the data  While the combinatorial BDFP may seem like   complex object to handle
computationally  our theoretical results showing that the de
Finetti measure underlying the BDFP is   speci   beta process  which can be well approximated by    nite   model 
the BEP  Our experimental results  compared to independent feature allocations  provides evidence that effectively
modeling dependency in the feature allocation through the
birthdeath mechanism is appropriate for   wide range of
statistical applications  Moreover  the BEP provides an interpretable structure using parameters not found  to the best
of our knowledge  in existing models       birth and death
rate of features  We are interested in scaling inference under the BEP to larger datasets  for example using  stochastic  variational inference methods that have been successful
for the IBP  Doshi et al   
Acknowledgements Konstantina   research leading to these
results has received funding from the European Research Council under the European Union   Seventh Framework Programme
 FP  ERC grant agreement no   

     ac human     me human     me human     me human     me human     me human     me human     ac human     me human     me human     ac human     me human     me human     me human     me human     me human     me human     ac human     me human     me human     ac human     me human     me human     me human     me human     me human     me human     ac human     me human     me human   BirthDeath Process for Feature Allocation

Rao  Vinayak and Teh  Yee Whye  Spatial normalized gamma

processes   

Rasmussen  Carl Edward and Williams  Christopher      Gaus 

sian processes for machine learning  MIT Press   

Shi  Shuqun  Ansari  Tasneem    McGuinness  Owen    Wasserman  David    and Johnson  Carl Hirschie  Circadian disruption leads to insulin resistance and obesity  Current Biology 
   

Teh        Elliott        and Blundell     Bayesian nonparametric modelling of genetic variations using fragmentationcoagulation processes  Submitted   

Thibaux  Romain and Jordan  Michael    Hierarchical beta proIn Proceedings of the
cesses and the indian buffet process 
Eleventh International Conference on Arti cial Intelligence
and Statistics  AISTATS  volume   pp     

van de Bunt  Gerhard    Van Duijn  Marijtje AJ  and Snijders 
Tom AB  Friendship networks through time  An actororiented
dynamic statistical network model  Computational   Mathematical Organization Theory     

Van Gael     Teh        and Ghahramani     The in nite factorial hidden Markov model  In Advances in Neural Information
Processing Systems  volume    

Williamson  Sinead  Orbanz  Peter  and Ghahramani  Zoubin  Dependent Indian buffet processes  In Proceedings of the Thirteenth International Workshop on Arti cial Intelligence and
Statistics  AISTATS   

Yamaguchi  Yoshiaki  Suzuki  Toru  Mizoro  Yasutaka  Kori  Hiroshi  Okada  Kazuki  Chen  Yulin  Fustin  JeanMichel  Yamazaki  Fumiyoshi  Mizuguchi  Naoki  Zhang  Jing  et al 
Mice genetically de cient in vasopressin     and     receptors are resistant to jet lag  Science     

References
Aldous       Exchangeability and related topics  In Ecole   Ete de
Probabilities de SaintFlour  volume XIII  pp    Springer 
 

Consortium  The ENCODE Project 

Identi cation and analysis
of functional elements in   of the human genome by the ENCODE pilot project  Nature       

de Finetti     Funzione Caratteristica Di un Fenomeno Aleatorio 
pp      Memorie  Academia Nazionale del Linceo 
 

Doshi     Miller        Van Gael     and Teh        Variational
inference for the Indian buffet process  In Proceedings of the
International Conference on Arti cial Intelligence and Statistics  volume    

Earnest  David   and Sladek  Celia    Circadian rhythms of vasopressin release from individual rat suprachiasmatic explants in
vitro  Brain research     

Ernst  Jason  Kheradpour  Pouya  Mikkelsen  Tarjei    Shoresh 
Noam  Ward  Lucas    Epstein  Charles    Zhang  Xiaolan 
Wang  Li  Issner  Robbyn  Coyne  Michael  et al  Mapping and
analysis of chromatin state dynamics in nine human cell types 
Nature     

Ghahramani  Zoubin and Jordan  Michael 

Factorial hidden

markov models  Machine Learning     

Grif ths  Thomas    and Ghahramani  Zoubin  In nite latent feature models and the indian buffet process  In In NIPS  pp   
  MIT Press   

Grif ths  Thomas    and Ghahramani  Zoubin  The indian buffet process  An introduction and review  Journal of Machine
Learning Research    July  

Hjort        Nonparametric Bayes estimators based on Beta processes in models for life history data  Annals of Statistics   
   

Kingman         The coalescent  Stochastic Processes and their

Applications         

Kingman  John       Completely Random Measures  Paci   Jour 

nal of Mathematics     

Miller  Kurt  Grif ths  Thomas  and Jordan  Michael  Nonparametric latent feature models for link prediction  In Advances in
Neural Information Processing Systems    

Neal  Radford    Density Modeling and Clustering Using DirichIn Bayesian Statistics   pp   

let Diffusion Trees 
 

Palla  Konstantina  Knowles  David    and Ghahramani  Zoubin 
  dependent partitionvalued process for multitask clustering
and time evolving network modelling   

Park  Peter    Chip seq  advantages and challenges of   maturing
technology  Nature Reviews Genetics     

Piechota  Marcin  Korostynski  Michal  Solecki  Wojciech 
Gieryk  Agnieszka  Slezak  Michal  Bilecki  Wiktor  Ziolkowska  Barbara  Kostrzewa  Elzbieta  Cymerman  Iwona 
Swiech  Lukasz  et al  The dissection of transcriptional modules regulated by various drugs of abuse in the mouse striatum 
Genome Biology       

