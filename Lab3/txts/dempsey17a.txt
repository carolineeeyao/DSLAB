iSurvive  An Interpretable  Eventtime Prediction Model for mHealth

Walter    Dempsey     Alexander Moreno     Christy    Scott   Michael    Dennis   David    Gustafson  

Susan    Murphy   James    Rehg  

Abstract

An important mobile health  mHealth  task is the
use of multimodal data  such as sensor streams
and selfreport  to construct interpretable timeto event predictions of  for example 
lapse to
Interpretability of
alcohol or illicit drug use 
the prediction model
is important for acceptance and adoption by domain scientists  enabling model outputs and parameters to inform
theory and guide intervention design  Temporal
latent state models are therefore attractive  and
so we adopt the continuous time hidden Markov
model  CTHMM  due to its ability to describe irregular arrival times of event data  Standard CTHMMs  however  are not specialized for predicting the time to   future event  the key variable for
mHealth interventions  Also  standard emission
models lack   suf ciently rich structure to describe multimodal data and incorporate domain
knowledge  We present iSurvive  an extension
of classical survival analysis to   CTHMM  We
present   parameter learning method for GLM
emissions and survival model  tting  and present
promising results on both synthetic data and an
mHealth drug use dataset 

  Introduction
In the emerging  eld of mobile health  mHealth  an important problem is the use of collected multimodal data
       sensor streams along with selfreport   to make
timevarying predictions of events like lapse  Chih et al 
  Using latent state models for prediction is an attractive choice for three reasons    States can be made
interpretable by representing behavioral constructs such as
stress and craving    Emission models can handle noisy

 Equal contribution  University of Michigan  Georgia Institute
of Technology  Lighthouse Institute  University of WisconsinMadison  Correspondence to  Alexander Moreno  alexander   moreno gatech edu 

Proceedings of the   th International Conference on Machine
Learning  Sydney  Australia  PMLR     Copyright  
by the author   

measurements  and   Parameters can capture domain
knowledge  Moreover  an interpretable model can represent   theoretical relationship  such as the hypothesized
link between increased stress and risk of smoking lapse  in
  form which supports learning from data  simulation and
visualization  and hypothesis testing  Such models can be  
tool for datadriven design and testing of theoretical models
by domain scientists  NahumShani et al    Further 
in the case of small sample sizes  the incorporation of domain knowledge may be critical for good performance  In
such cases  superior performance relative to an alternative
 black box  model can provide additional evidence for the
correctness of   behavioral theory 
Discrete time hidden Markov models  DTHMMs  are  
standard tool for regularlysampled sensor data  but many
important datatypes  such as EMAs or detected periods of
high stress  take the form of event data with irregular arrival
times  Fortunately  recent work  Wang et al    Rao  
Teh    makes it feasible to use continuous time HMMs
 CTHMMs  to model irregularlysampled data  This paper
builds on our prior work on ef cient parameter learning algorithms for CTHMMs  Liu et al   
In order to utilize CTHMMs for mobile health interventions  however  two limitations with existing models must
be addressed      mechanism is needed for predicting the
time to future events  and   Emission models must go beyond the standard Gaussian and multinomial observations
to embrace general multimodal data models  The  rst limitation can be addressed via classical methods for timeto 
event prediction from survival analysis  Prior work in joint
survival and longitudinal analysis has focused on sharedrandom effects models  Rizopoulos    or latent class
models  ProustLima et al    with Gaussian emissions 
Survival analysis has not been previously used in an interpretable hidden state setting with multimodal data  We
develop   method for using the states of   CTHMM as interpretable  timevarying covariates in   survival model  In
prior work  Lian et al    developed an interpretable
latent event process model  interpretability  however  was
achieved post hoc rather than being   builtin feature of the
model as is the case here  We describe additional differences between this prior work and our current approach in
the supplementary material 

iSurvive  An Interpretable  Eventtime Prediction Model for mHealth

We address the second limitation  the treatment of multimodal observations  by using   factorized GLM emission
model  Rather than simply  stacking  multimodal observations into   single vector  GLMs allow the speci cation
of   different link function for each type of observation
data  such as ordinal  count  and continuous data  Due
to this choice  the Mstep of EM does not have   closed
form solution  and the temporal dependencies are different from standard GLM training  We derive an iterative
Mstep update approach to solve this problem  and provide convergence guarantees to match  We believe we
are the  rst to use interpretable latent variables from  
CTHMM as covariates in   survival model with use of
GLM emissions to handle multimodal data types in   CTHMM  Our method allows us to make precise intuitive
statements like  under high risk and low engagement  the
probability of lapse is   Our publiclyreleased software  http cbi gatech edu SurvivalHMM 
will enable the mHealth and data science communities to
bene   from these new modeling capabilities  We show
promising results both in simulation and on   realworld
mHealth recovery support services dataset from individuals with substance use disorders 

  Model Description
Our latent variablebased survival model  which we term
iSurvive  has three components    continuoustime hidden Markov process    GLM emission models  and  
event process  We assume there are   participants  For
each participant    is the time in hours since the start of
the study  The studywindow length   is prespeci ed and
 xed for all participants 

  ContinuousTime HMM
  continuoustime hidden Markov model  Liu et al   
is   continuoustime latent Markov process where state
transitions and observations can occur at arbitrary times 
There are two sources of hidden information 
the states
and their transition times  The estimation problem involves
three sets of parameters    an emission model        relating observations   to the latent state        transition
rate matrix   that captures the exponentially distributed
transition rates between states  and   an initial state distribution 
Let   be   vector Markov process of length   with vector representation                      Sp    in which each
Si    takes discrete values in                Note that
this can always be reduced to an equivalent representation with   single discrete state       with cardinality     
Qp
        We will alternate between these representa 

tions as needed 

        pdimensional transition rate matrix   governs transitions for the latent Markov process     The negative diagonal element  Qii is the rate at which the process leaves
state         assumed exponentially distributed with parameter qi    Qii  The equationPj   Qij    Qii must
hold  If the latent process is currently in state   then at  
transition time from state    the probability of transitioning
to state   is Qij qi  Suppose we observe the latent state
transition times                                  and corresponding states                        From these we deduce the suf cient statistics    the number of transitions
between states  nij  
     and   the total length of time
spent in each state     
   The probability of this progression for the latent process is
   Yv 
The CTHMM also includes an observation process    
        which is only observed at observation times 
Let                 tV   denote the observation schedule 
note this is   random subset of     At each observation
time ti we observe the vector   ti  We assume       
              Let      denote the vector of observation
values at the observation schedule                 tV  
Consider   participant who has already had   observation
times      In this paper  we make the following conditional
independence assumption 

    tv  exp     tv   tv  tv      tv   tv     tv 

tk                         

 
In other words  the conditional distribution of the random
interval tk    tk only depends on the observed history 
Under both above conditional independence assumptions 
the joint probability of the latent process   and observation
sequence                        tV   is equal to

 pYi 

 Yj  

Qnij

ij     qi  

VYv 

    tv       tv   tv   Hv 

 

where Hv is the observed history         tv 
Each observation   tk  is   multimodal vector 
In an
mHealth application  for example  we may observe several selfreported ordinal ratings       EMA  along with
the number of times the mobile app has been used recently 
Thus  we have both ordinal and count data  Our observation model summarizes each component of the observation
vector in terms of the   latent sources 
We assume conditional independence of the   observation
components given the latent process  leading to the emission factorization 

               

MYm 

  Om          

iSurvive  An Interpretable  Eventtime Prediction Model for mHealth

This factorization simpli es the speci cation of the GLM
for each observation component 

  Emissions and Generalized Linear Models
  generalized linear model  GLM  is    exible generalization of ordinary linear regression where the error distributions need not be Gaussian    GLM has three components  McCullagh   Nelder    Agresti     
  response variable   following   dispersion exponential
family with distribution              with natural parameter   and dispersion term          linear predictor    
where   is   vector of weights and   our input vector  and
    link function   or activation function   
Suppose the   latent sources are binary       li     for each
   For the jth observation process  Oj    Oj     
the conditional mean given the latent process at time  
equals   Oj                          That is  the
conditional expectation is equal to the activation function
applied to   linear combination of the current values of the
  latent sources plus   constant  Note this is an assumption of parsimony as the number of parameters in the fully
nonparametric model would be    

  Interpretability via Link Restriction
Much of behavioral science theory concerns latent states
such as stress  craving  engagement and risk  We aim for
our model outputs to be interpretable by the clinician  an
important feature necessary for both acceptance and adoption by domain scientists  We achieve this through the
following assumption  some of the variables collected are
noisy measures of only one latent state and not the others 
For example  suppose   has latent binary sources      and
     representing stress and craving  respectively  Further
let      be   binary observation dependent only on stress 
and      be   second observation dependent on both stress
and craving  see Appendix   for the associated graphical
model  Then taking the logit link function  the form of the
conditional mean is

logit               baseline    stress       

 
Therefore      is conditionally independent of     
given      That is  given information about the user  
stress  the observation value does not depend on craving 
We call such conditional independence assumptions link
restrictions  iSurvive achieves interpretability via link refor each latent source  Si      there exstriction 
ists at least one observation process  Oj      such
that Oj    is   noisy measure of only Si    In an EMA
context  this can be achieved with questions such as  Are
you currently experiencing stress  which target   single
latent state construct  These direct observations enforce interpretability and allow us to incorporate additional more

complex observation processes that can provide improved
accuracy over selfreport  Using   survival model then allows us to make intuitive statements such as  The probability of lapse within the next   minutes when the participant
is stressed but not craving is  

  Event Process
We now build   model relating the interpretable  latent process   to the event process              of interest 
this is   binary process where           implies an event
occurs at time    In our case study  for example  the event of
interest is alcohol or drug use at   particular moment    Survival analysis provides the appropriate tools for modeling
the intensity function   the instantaneous rate of occurrence
of the event   given the latent process  Let              be
the number of events in the window            Then the
intensity function at time   is de ned 

       lim
   

 
  

                       

 

For this paper we consider the proportional hazards model
which expresses the hazard as

                exp  pXi 

 iSi   

 

where      is the baseline hazard function  In this paper
we consider   constant baseline hazard  moreover  we presuppose the intensity only depends on the latent process at
the current time    The proposed model is an interpretable
Cox process  Cox   Isham    Taylor et al       
generalization of   Poisson process in which the intensity
function is itself   stochastic process  Cox processes have
found success in event prediction problems with respect to
complex health data  Ranganath et al    Here the latent process is interpretable and therefore helps in answering both the prediction problem and the sequential decision making problem of interest  The Cox process assumes
 lapses  are conditionally independent given the latent process  Such   model is appropriate when lapse is only  
function of the latent behavioral constructs 
In mHealth applications  the event process can be measured
either via sensors  Sarker et al    Hossain et al   
      continuous monitoring  or selfreport       intermittent monitoring  Alternatively  scientists may schedule observation times at which the participant is asked if they have
used drugs within   prior window of time  In the case study
for this work  participants were asked if they used either alcohol or drugs within the past   minutes  This can be
modeled as

                        exp    

  

    ds   

iSurvive  An Interpretable  Eventtime Prediction Model for mHealth

Here we assume the window length           minutes 
is short enough so that   the latent process is likely to
be constant within the window  then given the latent process  the chance of no use  exponentiated term in eq   
can be wellapproximated by exp              
where           is the hazard  We focus on the latter
case with   similar discretized approximation for the remainder of the paper  For more on survival analysis see
 Aalen et al    Cook   Lawless   

  Parameter Estimation for iSurvive
Here we present an expectationmaximization algorithm
for parameter estimation of iSurvive  Our development
uses the context of our case study  and so we assume
that the event process and observation processes are measured via selfreport  EMA  following the same observation schedule                    It is straightforward to
apply our approach to other use cases 
One property of selfreport data is that participants may not
respond at   scheduled observation time  and instead may
decline to provide data  Let              be   binary process representing missing data  Suppose an observation is scheduled at time tv  we write    tv      if the
participant declines to provide information       the observation   tv  is missing  Consider   participant who already has   observations at times      Then de ne     
to
 
be the set of observation times at which we do observe the
observation        ti                ti     
We make the following conditional independence assumptions regarding the missing data indicator process 

   tk              

                

 

That is  the missing data indicator at tk  is independent of
the latent process  given the observed history       observation and missing data processes at prior observation times
of tk  This assumption plus variational independence      
no parameter sharing across components of the joint density  imply that likelihood estimation can ignore the missing data process  Note that observed missing data indicators can still be used in the survival and emission models 
For example  missing data may be an indicator of future
risk  assumption   only states that missing data may only
depend on the latent process through the observed history 
  plausible alternative to assumption   is conditional independence given the observed history and the latent process at the observation time 

   tk          tk        

                

 

Under this assumption  likelihood estimation cannot ignore the missing data process  however  the emission model
becomes hierarchical and so can be readily handled within
the iSurvive framework 

As the preceding discussion illustrates  the iSurvive framework is suf ciently  exible to describe   wide range of experiment designs and modeling assumptions  In the case
study in Section   behavioral scientists identi ed through
participant interviews that the primary cause for missed appointment was exogenous shocks to their schedule 

  EM Method
For ease of presentation  we present the EM algorithm
based on equation   under the conditional independence
assumptions for observations and missing data given by
equations   and   respectively  Excluding the initial
state distribution  the expected complete loglikelihood is
given by

        

 Xj  
log qij Ehnij                   
Ehlog     tv      tv                   

PXi 
  qiEh                    
VXv 

 

where             are the parameter estimates from the lth
iteration  Under variational independence of the emission
models and the latent Markov process  the maximization
step can be done separately for the latent variable parameters and emission models 
We begin by describing the EMsteps for the transition matrix  The Mstep for the transition matrix yields the following        iteration estimate 

     

ij

 

Ehnij                  
Eh                    

 

for       and  Qii    Pj  

 Qij 

The main challenge here is in the Estep  which  Liu et al 
  solved by breaking up the expectations into terms
per observation  and terms conditioned on the possible
state transitions between observations  Let           denote the transition probability     tv         tv   
                    Then
  nij                 
   Xv 
                    
   Xv 

            Ehnij     tv         tv             
            Eh       tv         tv               

SXs   
SXs   

 

 

Liu et al    adapt methods from the continuoustime
Markov chain  CTMC  literature to compute the endstate

iSurvive  An Interpretable  Eventtime Prediction Model for mHealth

for

the

density

observation

conditioned expectations  and develop an equivalent inhomogeneous discretetime hidden Markov model to calculate the pairwise beliefs          
The
kth
process   Ok                  can be rewritten in the
following exponential dispersion family form 
  Ok                               exp   sT           
De ne            tv                     Then the
corresponding component of the expected complete loglikelihood  ECLL  is given by

    

VXv 

SXs 

     log     tv     

 sT    tv        

    

   

Maximizing the ECLL  which is done after maximization
of the transition terms  does not have   closed form solution  and Fisher scoring or Newton   method must be used 
However  Fisher scoring for GLMs assumes an unweighted
loglikelihood  which is not the case for this objective because of the      terms  Appendix   extends the Fisher
scoring method to the weighted setting above    similar
learning procedure was derived in  Escola et al    but
focused on incorporating covariates into an HMM rather
than using GLM emissions 

Algorithm   Forwardbackward   Weighted Fisher scoring estimation procedure

  

processes

observation

  participants 

   observation times       

Input 
      
Output  rate matrix     emission parameters  
Smart initialization         
Set      
repeat
Use
compute           and        for                
and                     
Compute

forwardbackward

algorithm to

and

Eh                     

Ehnij                   
Compute       via equation  
Compute     via weighted Fisher scoring with
weights       

until loglikelihood converges

  Parameter Initialization and Convergence
Algorithm   presents the EMalgorithm for iSurvive using   combination of the forwardbackward and weighted
Fisher scoring procedures  The algorithm requires initial
estimates         and these initial values will effect

   

its convergence properties  We want to ensure that EM converges to intuitively reasonable estimates so that we can
interpret the resulting model parameters in the context of
relevant behavioral theory 
Prior theoretical work has provided some convergence
guarantees for standard EM algorithms  Balakrishnan
et al    Wang et al    To guarantee convergence 
in each case strong concavity and  rstorder stability conditions are required along with reasonable parameter initialization  Here we provide   similar guarantee for EM
parameter estimation for the case of CTHMMs with factorized GLM emissions and conditional independence on
the observation schedule  Our development is based on the
assumption of strong concavity  which seems likely to hold
based on prior work  Kakade et al    on almost strong
concavity of exponential families  Our supporting simulation results in Section   provide additional evidence   
proof of strong concavity remains for future work 
For iSurvive  the Qfunction of the EMalgorithm is decomposable into three components for the latent process 
the observation model  and the event process  Decomposability allows us to discuss the assumption of strong concavity separately for each component  in particular  it allows us to isolate the issue of strong concavity for generalized linear models and investigate this independently of the
other model components  Further  since the Qfunction is
decomposable  so is the Mstep 
Under the assumption that the participant trajectories are
independent and identically distributed  the law of large
numbers ensures that as the sample size   increases  the
samplebased Qfunction approaches its expectation 

            QN      

    ES           log               

The population Mfunction can then be de ned as
       arg max          When applying EM   
corresponds to     the parameters of the previous iteration  The population Mfunction is also decomposable  We
now present Lemma   which provides convergence guarantees and motivates our approach to parameter initialization 
Lemma  
the population Mfunction satis es strong concavity and  rstorder stability
conditions for parameters       then for sample size  
suf ciently large the EMalgorithm satis es

If each component of

             tk        

       

 

 

     

where   is the MLE      is the tth EMiteration estimates           is   measure of  rstorder stability 
    measure of strong concavity  and        is the sum
of highprobability lower bounds on the distance between
MN   and      for each component 

iSurvive  An Interpretable  Eventtime Prediction Model for mHealth

See Appendix   for additional technical details  Lemma  
motivates   practical problem  how do we choose the initial
parameter estimates  iSurvive leverages GLMs for connecting the latent process to each component of the observable process  Kakade et al    shows  almost  strong
concavity of exponential families  In particular  their Theorem   quanti es the fact that  exponential families behave in   strongly concave manner only in    suf ciently
small  neighborhood of   These  ndings combined with
equation   highlight the importance of appropriately
choosing     good initialization will ensure convergence to high quality parameter estimates 
We propose   smart initialization strategy which leverages
domain expertise  First  we treat rate matrix and emission
initializations separately  For the rate matrix  we obtain
an initial estimate of the hidden state sequences by assuming that the direct observations of the states resulting from
link restriction  see Section   are noisefree  This allows
us to estimate an initial   corresponding to   CTMC over
the observed states using the method of  Metzner et al 
  For the emission parameters  we handdesign an initial emission model by drawing from behavioral theory to
connect the latent states to the observations  For example 
we can ascertain the likelihood that   participant is experiencing stress if they answer positively to   question about
being stressed  We can then choose GLM weight parameters accordingly  Note that this initialization method provides an indirect test of of our behavioral theories  if they
are correct  they should lead to good predictive accuracy 

  Prediction and Validation
iSurvive is designed to be an interpretable event prediction model  Here we show how to take parameter estimates         and answer the question  Given observed
data      what is the probability that   lapse will not occur
at any of   future set of observation times                 
Note we allow for multiple events to occur and thus are interested in whether any event occurs in the window or not 
This is the primary question of interest when analyzing the
recovery support services data in Section   In this case 
prior data includes selfreported alcohol or drug use at observation times                    As we are interested
in predicting selfreported lapse  we do not require the full
generality of equation   as we only need to compute the
chance of no use within   small prior window         discretized approximation  At time    we can use the forward
algorithm to compute the posterior distribution of the latent
process at time    conditional on the observed data  We
can then compute the probability of not observing   lapse
at time    To do this  we use   logistic emission model
for      ti          ti       This is equivalent to the
discretized approximation described in Section   for the

event process  We iterate on this procedure to compute  
sequence of conditional probabilities of not lapsing  conditional on observed history and the fact that the participant
has yet to lapse at any future scheduled observation time 
multiplying them together yields the prediction of interest 
Algorithm   presents pseudocode 
We use the brier score  Blanche et al    van Houwelingen   Putter    and logloss to de ne prediction accuracy  Use of the loglikelihood is inappropriate as it measures overall     which is not the main quantity of interest 
We choose   time   and windowlength   We then produce
the probability of no lapses at any of the scheduled observations times within the interval           Let        
denote this prediction for the nth participant  We compute
an indicator of whether no events occur at these scheduled
observation times within the window for the chosen participant In      The brier score is the average squared
difference in these quantities           In     
The complete brier score and logloss are then

BS   

LL     

   tj      In tj   

mnXj 
NXn 
mnXj In tj    log       tj   
NXn 
      In tj    log   tj   

respectively where  tj mn
   are   set of chosen  participant
speci   times  The Brier score and logloss are two ways
to verify the accuracy of   probability forecast  the former
ranges from    completely accurate  to    wholly inaccurate  while the latter from   to  
For each experiment that follows  we perform   crossvalidation based assessment of prediction accuracy  We
randomly partition the   participants into groups of
size    Suppose         and we label each partition
uniquely                  then the Brier score and logloss
for the mth run is denoted BSm  and LLm  respectively  The crossvalidated complete brier score and log 

loss is then given byPm BSm  andPm LLm  re 

spectively  We perform this calculation for various choices
of   to observe performance over   range of windowlengths 

  Synthetic Experiments

Our experiments are focused on the setting of selfreported
alcohol or illicit drug use at scheduled observation times 
which is the basis for our case study in Section  
We start with   synthetic experiment aimed at illustrating

iSurvive  An Interpretable  Eventtime Prediction Model for mHealth

Algorithm   Event prediction algorithm

Input  Rate matrix    emission parameters   prior observations      current time    and future observation
times             tk 

     ti  for                 

Output Qk
Compute                               
for                   do
Compute         exp   ti   ti 
for                  do
Set  ti     hPs   ti        
  si
Set  ti       ti        ti          ti      
Set   ti   Ps    ti   
Normalize  ti       ti   Ps  ti   

end for

end for

Figure   Convergence to the generating parameters   iterations  measured via Frobenius     in count case  norm    with
smart initialization    without it  With smart initialization we recover good estimates of the generating parameters  while without
it we do not even get closer to them in the binary case  The count
difference norms are exponentiated to make visual comparison
easier 

the importance of good initialization  Due to our desire for
interpretability  we are concerned with how close the parameter estimates are to the true parameter values  We now
brie   describe the synthetic experiment  see Appendix  
for details  The latent process has three binary sources 
We generate   random transition matrix     We generate

three ordinal ratings  each taking binary values  Each ratings question is associated with only one latent source      
one binary question per latent source  We also generate
count data to represent the number of times   user has used
the app in the past   minutes  All emissions models are
generalized linear models  for the ordinal ratings we assume   logit link while for the count data we assume   logarithmic link  For each  we are interested in observing the
effect of smart initialization 
Figure   shows convergence   iterations  of the emission coef cients to the generating parameters    with and
   without smart initialization  With smart initialization 
convergence is very good  and without it  convergence is
very poor  in fact  the estimated logistic parameters do not
even converge toward the generating parameters 

  Recovery Support Services     Case Study
Here we analyze   set of recovery support studies on individuals with substance use disorders  SUDs  In particular 
we analyze two pilot studies      week study of adults
       and    week study of adolescents         
where participants have recently been discharged from outpatient  intensive outpatient  or residential treatment  Each
study was done using   modi ed version of the Addiction Comprehensive Health Enhancement Support System
 ACHESS   Gustafson et al    Participants of each
pilot study have met criteria for substance use disorder in
the year prior to the original treatment intake and have used
alcohol or other drugs in the   days prior to the original
treatment  prompts occur at six random times by the mobile phone per day  At each prompt  selfreport data is collected concerning the prior   minutes exposure to internal
and external protective and risk factors  Ratings were given
to how each factor aids in their recovery or makes them
want to use drugs alcohol  Selfreport also included questions regarding physical pain  illness or withdrawal from
drugs alcohol  level of craving for drugs alcohol  exposure
to drugs alcohol  and resistance to drugs alcohol  Participants were given smartphones enabled with   access
to   range of drug abuse and HIV ecological momentary
interventions  Dennis et al    Scott et al    Participants were asked to selfreport use of drugs alcohol in
the prior   minutes  Sensor data was collected including information on when EMIs  Ecological momentary interventions  interventions delivered in real time  were accessed and the amount of time engaged with the EMI  Such
  rich dataset of complex longitudinal data       simultaneously measuring EMI usage  drug use  selfreported ratings  is becoming increasingly common as the  eld of mobile health grows  We are interested in using the collected
complex longitudinal data in event prediction   in particular the probability of any substance use within   future

iSurvive  An Interpretable  Eventtime Prediction Model for mHealth

window of time 
Prompts occur at random times so the observation schedule
automatically satis es the sequential conditional independence assumption  Prompts cannot occur from midnight to
 AM every morning  since participants are likely asleep
at these times  we compute time since recruitment after
removing these  sleeping windows  Consider   prompt
at time    we consider the reduced observation       
                      This is    dimensional vector where      is    level ordinal response to   question
on how one   current feelings helps with supports recovery 
     is    level ordinal variable related to EMI usage 
     is   binary variable indicating whether the participant kept all default answers in the selfreport  and      
is the binary event process indicating use of drugs alcohol 
We assume the latent process                  is
comprised of two binary sources       represents level of
engagement       represents level of risk  In this paper engagement is de ned in terms of active engagement in selfreport and is therefore connected to the indicator     
We now specify the models for each observation component conditional on      For the event variable       we
assume   logit model where the mean is   linear  additive
model in terms of      and      For the engagement
variable      we assume   logit model where the mean
is   linear  additive model in terms of only      For
the EMI usage variable      we assume   proportional
odds model where the linear predictor is additive in terms
of      and      The risk variable      is   mixture
depending on engagement  Given the participant is not currently engaged  the responses are not related to latent risk 
given the participant is currently engaged  we assume   proportional odds model where the linear predictor is additive
only in terms of      Appendix   provides further details
on the observations  latent states  and models 
We    several alternative discriminative models aiming to
predict future events given    xed window length   We
   both logistic regressions and kernel SVMs where the
response is an indicator of use in   future window with  
particular choice of features from the history  The  rst feature set is simply the current observation values  the second
adds an additional covariate indicating whether an event
occurred at the current observation time  the third adds an
additional covariate indicating whether an event occurred
in the prior twentyfour hours  the fourth adds an additional covariate indicating whether an event occurred in
the prior week  Finally  we add as   covariate the number of scheduled observation times in the future window 
For each discriminative model and iSurvive  we compute
the crossvalidated complete brier score and complete logloss  Figure   shows that iSurvive outperforms the discriminative models in terms of the crossvalidated Brier score

for each       days  Figure   in Appendix   shows iSurvive also outperforms the alternative discriminative models
in terms of the crossvalidated logloss 

Figure   Crossvalidated complete Brier score on recovery support services study for several discriminative models and iSurvive

Our analysis via iSurvive yields the interpretable  nding
that  minute probability of lapse is highest for individuals in the latent states of High risk and Low engagement
  decreases for High risk and High engagement
  decreases more for Low risk and Low Engagement   and is negligible for Low risk and High engagement   The  nding is intuitive for our behavioral scientist collaborators and can be used to help decide
what types of interventions to provide and when to provide
them 

  Conclusion and Future Work
In this paper we introduce iSurvive  an interpretable  eventtime prediction model for mHealth  By using   continuoustime hidden Markov model and   factorized GLM emission
model with link restriction  we can summarize our observations in terms of interpretable latent variables  We then use
these in   survival model to predict event times  iSurvive is
designed with an interest toward treatment policies  by having interpretable latent states  we hope to leverage iSurvive
in optimizing the delivery of mobile health interventions as
future work 

Acknowledgements
We thank the reviewers for their useful comments and
the members of the Statistical Reinforcement Learning
Lab at the University of Michigan for valuable discussions  We acknowledge support from the National Institutes of Health under BD   grant   EB  and
grants   EY    AA     DA 
and   HL  This work was also supported by
NIDA    DA  and additional grants from NIAAA 
NIDA and NIMH 

iSurvive  An Interpretable  Eventtime Prediction Model for mHealth

References
Aalen     Borgan     and Gjessing     Survival and event
history analysis    process point of view  New York 
SpringerVerlag   

Agresti     Foundations of Linear and Generalized Linear

Models  Wiley  New York   rst edition   

Balakrishnan     Wainwright       and Yu     Statistical guarantees for the em algorithm  From population to
samplebased analysis   

Blanche     ProustLima        Loub ere     Berr  Dartiguesand       and JacqminGadda     Quantifying and
comparing dynamic predictive accuracy of joint models
for longitudinal marker and timeto event in presence of
censoring and competing risks  Biometrics   
   

Chih     Patton     McTavish     Isham     JudkinsFisher        Atwood        and Gustafson        Predictive modeling of addiction lapses in   mobile health
application  Journal of Substance Abuse Treatment   
   

Cook     and Lawless     The statistical analysis of recur 

rent events  Springer   

Cox       and Isham     Point Processes  Chapman  

Hall  London    edition   

Dennis       Scott        Funk        and Nicholson 
     pilot study to examine the feasibility and potential
effectiveness of using smartphones to provide recovery
support for adolescents  Substance abuse   
   

Escola  Sean  Fontanini  Alfredo  Katz  Don  and Paninski 
Liam  Hidden markov models for the stimulusresponse
relationships of multistate neural systems  Neural computation     

Gustafson       McTavish        Chih        Atwood 
      Johnson        Boyle             Levy 
Driscoll     Chisholm       Dillenburg     and Isham 
     smartphone application to support recovery from
alcoholism    randomized clinical trial  JAMA psychiatry     

Hossain  Syed Monowar  Ali  Amin Ahsan  Rahman 
Md  Mahbubur  Ertin  Emre  Epstein  David  Kennedy 
Ashley  Preston  Kenzie  Umbricht  Annie  Chen  Yixin 
and Kumar  Santosh  Identifying drug  cocaine  intake
events from acute physiological response in the presence
of freeliving physical activity 
In Proceedings of the
 th International Symposium on Information Processing in Sensor Networks  IPSN   pp     

Kakade     Shamir     Sindharan     and Tewari 
   Learning exponential families in highdimensions 
Strong convexity and sparsity  AISTATS  pp   
 

Lian     Rao       Eriksson     and Carin     Modeling correlated arrival events with latent semimarkov
processes  In Proceedings of the  th International Conference on Machine Learning   

Liu     Song     Li     Li     and Rehg     Ef cient
continuoustime hidden markov model for disease modeling  In Proceedings for Advances in Neural Information Processing Systems  NIPS   

McCullagh     and Nelder       Generalized Linear Mod 

els  Springer   nd edition   

Metzner  Philipp  Horenko  Illia  and Sch utte  Christof 
Generator estimation of markov jump processes based
on incomplete observations nonequidistant
in time 
Physical Review       

NahumShani  Inbal  Hekler  Eric    and SpruijtMetz 
Donna  Building health behavior models to guide the
development of justin time adaptive interventions   
pragmatic framework  Health Psychology   
   

ProustLima     Sne     Taylor       and JacqminGadda    
Joint latent class models for longitudinal
and timeto event data    review  Statistical Methods
in Medical Research     

Ranganath     Perotte     Elhadad     and Blei     The
survival  lter   joint survival analysis with   latent time
series  Uncertainty in Arti cial Intelligence   

Rao  Vinayak and Teh  Yee Whye  Fast mcmc sampling
for markov jump processes and extensions  Journal of
Machine Learning Research     

Rizopoulos     Joint models for longitudinal and timeto 

event data  With applications in    CRC Press   

Sarker  Hillol  Tyburski  Matthew  Rahman  Md Mahbubur  Hovsepian  Karen  Sharmin  Moushumi  Epstein 
David    Preston  Kenzie    FurrHolden     Debra 
Milam  Adam  NahumShani  Inbal  al Absi  Mustafa 
and Kumar  Santosh  Finding signi cant stress episodes
in   discontinuous time series of rapidly varying mobile
sensor data  In Proceedings of the   CHI Conference
on Human Factors in Computing Systems  CHI   pp 
  ACM   

Scott        Dennis        Gustafson     and Johnson    
  pilot study of the feasibility and potential effectiveness
of using smartphones to provide recovery support  Drug
  Alcohol Dependence       

iSurvive  An Interpretable  Eventtime Prediction Model for mHealth

Taylor  Benjamin    Rowlingson  Barry  Moraga  Paula 
and Diggle  Peter    Spatial and spatiotemporal loggaussian cox processes  Extending the geostatistical
paradigm  Statistical Science     

van Houwelingen  Hans and Putter  Hein  Dynamic Prediction in Clinical Survival Analysis  CRC Press  Inc 
Boca Raton  FL  USA   st edition   

Wang  Xiang  Sontag  David  and Wang  Fei  Unsupervised
learning of disease progression models  In Proceedings
of the  th ACM SIGKDD international conference on
Knowledge discovery and data mining  pp    ACM 
 

Wang  Zhaoran  Gu  Quanquan  Ning  Yang  and Liu  Han 
High dimensional em algorithm  Statistical optimization
and asymptotic normality  In Proceedings of the  th International Conference on Neural Information Processing Systems  NIPS  pp     

