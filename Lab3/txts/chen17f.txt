Identi cation and Model Testing in Linear Structural Equation Models using

Auxiliary Variables

Bryant Chen   Daniel Kumor   Elias Bareinboim  

Abstract

We developed   novel approach to identi cation and model testing in linear structural equation models  SEMs  based on auxiliary variables
 AVs  which generalizes   widelyused family
of methods known as instrumental variables  The
identi cation problem is concerned with the conditions under which causal parameters can be
uniquely estimated from an observational  noncausal covariance matrix  In this paper  we provide an algorithm for the identi cation of causal
parameters in linear structural models that subsumes previous stateof theart methods  In other
words  our algorithm identi es strictly more coef cients and models than methods previously
known in the literature  Our algorithm builds
on   graphtheoretic characterization of conditional independence relations between auxiliary
and model variables  which is developed in this
paper  Further  we leverage this new characterization for allowing identi cation when limited
experimental data or new substantive knowledge
about the domain is available  Lastly  we develop
  new procedure for model testing using AVs 

  Introduction
The problem of estimating causal effects is one of the fundamental problems in the datadriven sciences  In order to
estimate   causal effect  the desired effect must be identi ed
or uniquely expressible in terms of the probability distribution over the available data  Causal effects are identi ed
by design in randomized control trials  but in many applications  such experiments are not possible  When only observational data is available  determining whether   causal

 IBM Research  San Jose  California  USA  Purdue University  West Lafeyette 
Indiana  USA  Correspondence to 
Bryant Chen  bryant chen ibm com  Daniel Kumor  dkumor purdue edu 

Proceedings of the   th International Conference on Machine
Learning  Sydney  Australia  PMLR     Copyright  
by the author   

effect is identi ed requires modeling the underlying causal
structure  which is generally done using structural equation models  SEMs   also called structural causal models 
 Pearl    Bareinboim and Pearl   
  structural equation model consists of   set of equations
that describe the underlying datagenerating process for  
set of variables  While SEMs  in their most general  nonparametric form do not require any assumptions about the
form of these functions  in many  elds  including machine
learning  psychology  and the social sciences  linear SEMs
are used    linear SEM consists of   set of equations of
the form              where           xn   is  
vector containing the model variables    is   matrix containing the coef cients of the model  and  ij represents the
direct effect of xi on xj  and           un   is   vector
of normally distributed error terms  which represents omitted or latent variables  The matrix   contains zeroes on
the diagonal  and  ij     whenever xi is not   cause of
xj  The covariance matrix of   will be denoted by   and
the covariance matrix over the error terms     by  
In
this paper  we will restrict our attention to semiMarkovian
models  Pearl    models where the rows of   can be
arranged so that it is lower triangular  and the corresponding graph is acyclic 
When modeling using SEMs  researchers typically specify
the model by setting certain entries of   and   to zero      
exclusion and independence restrictions  while leaving the
rest of the entries as free parameters to be estimated from
data  Restricting   particular entry  ij to zero re ects the
assumption that Yi has no direct effect on Yj  Similarly 
restricting  ij to zero re ects the assumption that there are
no unobserved common causes of both Yi and Yj  Once the

 Instrumental and auxiliary variables can also be used when
normality is not assumed  but to simplify the proofs in the paper 
we will  as is commonly done by empirical researchers  assume
normality 

 There are   number of algorithms for discovering the model
structure from data Spirtes et al    Shimizu et al   
Pearl    Zhang and Hyv arinen    Mooij et al   
However  it is only in very rare instances that these methods are
able to uniquely determine the model structure  As   result  model
speci cation generally utilizes knowledge about the domain under
study 

Identi cation and Model Testing using AVs

parameters are estimated  causal effects  as well as counterfactual quantities  can be computed from the structural
coef cients directly  Pearl    Chen and Pearl   
However  in order to be estimable from data    parameter
must  rst be identi ed  In some cases  the modeling assumptions are not strong enough  and there are multiple 
often in nite  values for the parameter that are consistent
with the observed data  As   result  two fundamental problems in SEMs are to identify and estimate the model parameters and to test the underlying assumptions that enable
identi cation 
The problem of identi cation has been studied extensively
by econometricians and social scientists  Fisher   
Bowden and Turkington    Bekker et al    Rigdon    and more recently by the AI and statistics communities using graphical methods  Spirtes et al   
Tian      Brito and Pearl          Bareinboim and Pearl    To our knowledge  the most general  ef cient algorithm for model identi cation is the gHT
algorithm given by Chen   combined with ancestor
decomposition  Drton and Weihs    This method generalizes the halftrek algorithm of Foygel et al    and
utilizes ancestor decomposition  which expands on an idea
by Tian   where the model is decomposed into simpler submodels  Graphical methods have also been applied
to the problem of testing the causal assumptions embedded
in an SEM  For example  dseparation  Pearl    and
overidenti cation  Pearl    Chen et al    provide
the means to discover testable implications of the model 
which can be used to test it against data 
Despite decades of attention and work from diverse  elds 
the identi cation problem  has still not been ef ciently
solved  There are identi able parameters and models that
none of the above methods are able to identify  Similarly  there are testable implications of SEMs that the above
methods are unable to detect  One promising avenue to aid
in both tasks are auxiliary variables  Chen et al   
Each of the aforementioned methods for identi cation and
model testing only utilizes restrictions on the entries of  
and   to zero  Auxiliary variables can be used to incorporate knowledge of nonzero coef cient values into existing
methods for identi cation and model testing  These coef 
cient values could be obtained  for example  from   previously conducted randomized experiment  from substantive
understanding of the domain  or even from another identi cation technique  The intuition behind auxiliary vari 

 To be precise  we are referring to the problem of identi 
cation almost everywhere  Brito and Pearl      also called
generic identi cation  Foygel et al   

 An exhaustive procedure can be obtained using Gr obner
bases methods  Foygel et al    However  these methods
are computationally intractable for anything but the smallest of
graphs 

ables is simple  if the coef cient from variable   to     
is known  then we would like to remove the direct effect of
  on   by subtracting it from    This removal eliminates
confounding paths through   and is performed by creating
  variable              which is used as   proxy for    In
many cases     allows the identi cation of parameters or
testable implications using existing methods when   could
not 
Chen et al    demonstrated how auxiliary variables
could be utilized in simple instrumental sets  instrumental sets that do not utilize conditioning to block spurious
paths   Brito and Pearl      van der Zander et al   
and proved that any model identi able using the gHT algorithm is also identi able using auxiliary simple instrumental sets 
Since auxiliary variables allow knowledge of nonzero coef cient values to be incorporated into existing methods
for identi cation  they are also directly applicable to the
problem of zidenti cation  Bareinboim and Pearl   
in which partial experimental data is available  Additionally  the cancellation of paths that results from adding an
AV may result in conditional independence constraints between the AV and other variables that can be used to test
the model 
In this paper  we generalize the results of Chen et al   
and demonstrate how auxiliary variables can be utilized in
generalized instrumental sets  which allow for conditioning to block spurious paths  We prove that  unlike auxiliary simple instrumental sets  this generalization strictly
subsumes the gHT algorithm  Additionally  we introduce
quasiinstrumental sets  which utilize auxiliary variables
to identify coef cients when partial experimental data is
available  Quasiinstrumental sets are incorporated into
our identi cation algorithm  allowing it to better address
the problem of zidenti cation  To our knowledge  this
algorithm is the  rst systematic method for tackling zidenti cation in linear systems  We also demonstrate how
auxiliary instrumental sets and quasiinstrumental sets can
be used to derive overidentifying constraints  which can
be used to test the model speci cation against data  Moreover  we prove that these overidentifying constraints subsume conditional independence constraints among auxiliary variables  Lastly  we discuss related work  showing
how auxiliary IVs are able to unite   variety of disparate
methods under   single framework 

  Preliminaries
The causal graph or path diagram of an SEM is   graph 
              where   are nodes or vertices    directed
edges  and   bidirected edges  The nodes represent model
variables  Directed eges encode the direction of causal 

Identi cation and Model Testing using AVs

ity  and for each coef cient  ij  cid    an edge is drawn
from xi to xj  Each directed edge  therefore  is associated with   coef cient in the SEM  which we will often
refer to as its structural coef cient  Additionally  when it is
clear from context  we may abuse notation slightly and use
coef cients and directed edges interchangeably  The error
terms  ui  are not shown explicitly in the graph  However 
  bidirected edge between two nodes indicates that their
corresponding error terms may be statistically dependent
while the lack of   bidirected edge indicates that the error
terms are independent 
We will use standard graph terminology with        denoting the parents of    Anc    denoting the ancestors of    
De    denoting the descendants of    and Sib    denoting
the siblings of    the variables that are connected to   via
  bidirected edge  He    denotes the heads of   set of directed edges     while        denotes the tails  Additionally  for   node    the set of edges for which He        is
denoted Inc    Lastly  we will utilize dseparation  Pearl 
 
We will use           to denote the partial covariance between two random variables    and    given   set of variables      and            as the partial covariance between random variables   and   given   implied by the
graph    We will assume without loss of generality that
the model variables have been standardized to mean   and
variance  
De nition   For   given unblocked  given the empty set 
path    from   to    Left  is the set of nodes  if any 
that has   directed edge leaving it in the direction of   in
addition to    Right  is the set of nodes  if any  that has  
directed edge leaving it in the direction of   in addition to
  
For example  consider the path         vL
    vT   vR
vL
    
  vR
vT is   member of both Right  and Left 
De nition     set of paths          has no sided intersection if for all                  such that     cid     
Left   Left   Right   Right       

       
       In this case  Left 
        vT 

        vT  and Right      

        vR

  vL

Wright   rules  Wright    allow us to equate the modelimplied covariance            between any pair of variables    and   
to the sum of products of parameters
along unblocked paths between   and    Let    

 Wright   rules characterize the relationship between the covariance matrix and model parameters  Therefore  any question
about identi cation using the covariance matrix can be decided
by studying the solutions for this system of equations  However 
since these equations are polynomials and not linear  it can be
very dif cult to analyze identi cation of models using Wright  
rules 

          denote the unblocked paths between   and
   and let pi be the product of structural coef cients along
path     Then the covariance between variables   and   is

 cid 

  pi 

Lastly  we de ne auxiliary variables and the augmented
graph 
De nition    Auxiliary Variable  Given   linear SEM with
 cid 
graph   and   set of edges   whose coef cient values
are known  an auxiliary variable is   variable          
  eiti  where       ek        Inc    and ti       ei 
for all           
If not otherwise speci ed     refers to the auxiliary variable                 cltl  where       cl  are the coef cients of     Inc    and   is the set of directed
edges whose coef cient values are known  In other words 
   is the auxiliary variable for   where as many known
coef cients are subtracted out as possible  Chen et al 
  demonstrated that the covariance between any auxiliary variables and model variables can be computed using
Wright   rules on the augmented graph  de ned below 
De nition    Chen et al    Let   be   linear SEM
with graph   and   set of directed edges   such that their
coef cient values are known  The Eaugmented model 
     includes all variables and structural equations of
  in addition to new auxiliary variables    
   one
for each variable in He            yk  such that the
structural equation for   
    where
Xi                yi  for all            The corresponding augmented graph is denoted GE 

     
    yi    XiyiT  

is   

 

For example  consider Figure    
If the value of   is
known  we can generate an auxiliary variable            
The  augmented graph    is depicted in Figure     In
some cases     allows the identi cation of coef cients and
testable implications using existing methods when   could
not  due to the fact that the backdoor paths from   to   that
go through   cancel with the backdoor paths from    to  
that go through   This can be seen by expressing the
covariance of    and   in terms of the model parameters
using Wright   rules 

  Auxiliary and QuasiInstrumental Sets
Two  perhaps the most common  methods for estimating causal effects are OLS regression and twostage leastsquares  SLS  regression  Both of these methods assume that the underlying causal relationships between variables are linear  in addition to other causal assumptions that
guarantee identi cation  The singledoor criterion  Pearl 
  graphically characterizes when the assumptions suf 
 cient to estimate   causal effect using regression are satis ed in   linear SEM  Similarly  Brito and Pearl    
gave   graphical characterization for when   variable  

Identi cation and Model Testing using AVs

   

   

   

Figure         is not identi ed using IVs       is identi ed using    as an auxiliary IV given        conditioning on descendants of  
induces correlation between    and  

quali es as an IV so that  SLS regression provides   consistent estimate of the causal effect  In this section  we give
  graphical criterion for when AVs can be utilized in generalized instrumental sets  which extends both the singledoor criterion and IVs  Additionally  we introduce quasiinstrumental sets  which utilize AVs to better address the
problem of zidenti cation 
First  we give   simple graphical criterion for when an AV
would be conditionally independent of another variable 
which will allow us to incorporate AVs into instrumental
sets  as well as other identi cation and model testing methods that require the ability to detect conditional independence in the graph 
Theorem   Given   linear SEM with graph    where    
Inc    is   set of edges whose coef cient values are known 
if         does not contain descendants of   and GE 
represents the graph   with the edges for   removed  then
      GE  if and only if         GE 
   

Proof  Proofs for all theorems and lemmas can be found in
the Appendix  Chen et al   

Next  we demonstrate how AVs can be incorporated into
generalized instrumental sets  de ned below 

 The theorem disallows descendants of the generating variable in the conditioning set  At  rst glance  this may appear to
limit the ability to block biasing paths among AVs  However  we
conjecture that if   cannot be separated from   in    then    will
almost surely not be independent of   given     if   contains
descendants of    To illustrate  consider the example shown in
Figure                 is independent of    as can be veri 
 ed using Wright   rules  but    is not independent of   given
   An intuitive explanation for this surprising result is that conditioning on      descendant of    in Figure    induces correlation between the error term of   and    since   acts as    virtual
collider  As   result  we have    virtual path  from    to   
         ux          See Pearl        for   detailed
discussion of virtual colliders 

Theorem    Brito and Pearl      Given   linear model
with graph    the coef cients for   set of edges    
          xk     are identi ed if there exists triplets
             zk  Wk  pk  such that for           
     zi   Wi GE  where   does not contain any descendants of   and GE  is the graph obtained by
deleting the edges    from   

 ii  pi is   path between zi and xi that is not blocked by

Wi  and

 iii  the set of paths        pk  has no sided intersec 

tion 

If the above conditions are satis ed  we say that   is   generalized instrumental set for   or simply an instrumental
set for   

In some cases    variable   may not satisfy condition    
above but an auxiliary variable    does  For example  in
Figure     we cannot identify   using Theorem   Blocking the path           by conditioning on   opens the
path             Moreover  we cannot use   or   in
an instrumental set due to the edges       and       
However    is an IV for   allowing us to generate an AV 
                as in Figure     Now    can be identi ed
using    as an auxiliary instrument given   
Theorem   tells us when     of Theorem   can be satis ed
using an AV    
    We simply check whether zi can be separated from   in GE Ez  where Ez   Inc zi  is the set
of zi   edges whose coef cient values are known  When an
instrumental set includes AVs  we call the set an auxiliary
instrumental set or auxiliary IV set for short 

 Brito and Pearl     provided an alternative statement of
condition  iii    proof that the two statement are  in fact  equivalent is given in the Appendix  Chen et al   

 Note that when          is an IV for        Further  if

        then    satis es the singledoor criterion for       

Identi cation and Model Testing using AVs

   

   

Figure         is not identi ed using IVs       is identi ed using
  as   quasiIV after adding auxiliary variable    

Figure    also demonstrates the importance of extending
the simple auxiliary instrumental sets introduced by Chen
et al    to allow for conditioning    can only be identi ed if we block the paths            and         
       by conditioning on   
When knowledge of coef cient values are known   priori 
it may be helpful to generate an AV from the outcome variable    For example  in Figure       cannot be identi ed 
However  suppose that it is possible to run   surrogate experiment and randomize    This experiment would allow
us to estimate   and generate the AV                Now 
  is not technically an instrument for   but it can be shown
that     rY     
  Chen et al    called such variables
rXZ
quasiinstrumental variables or quasiIVs for short 
Interestingly  while quasiIVs are valuable for the problem
of zidenti cation  they do no better than instrumental sets
when applied to the standard identi cation problem  where
no external knowledge of coef cient values is available 
For example  consider again Figure     In order to use  
as   quasiIV for   we would  rst have to identify   using
an IV  If such   variable existed  say   cid  then we could have
simply identi ed     using the IV set       cid 
Next  we formally de ne quasiinstrumental sets or quasiIV sets for short  Note that auxiliary IV sets are also quasiIV sets 
De nition   Given   linear SEM with graph      set of
edges EK whose coef cient values are known  and   set of
structural coef cients               the set    
      zk  is   quasiinstrumental set if there exist triples
             zk  Wj  pk  such that 

    For            either 

    the elements of Wi are nondescendants of   
where Ey   EK  

and  zi   Wi GE Ey
Inc   
and    and  zi   Wi GE Ezy
EK    Inc      Inc   

    the elements of Wi are nondescendants of zi
where Ezy  

 ii  for            pi is   path between zi and xi that is

not blocked by Wi  where xi   He    and

 iii  the set of paths       pk  has no sided intersection

Theorem   If    is   quasiinstrumental set for    then
  is identi able 

Lastly  the following corollary provides   simple graphical
condition for when   single variable or AV quali es as  
quasiIV 
Corollary   Given   linear SEM with graph       is  
quasiIV for   given   if   does not contain any descendants of    and   is an IV for   given   in GEz Ey 
where Ez   Inc    and Ey   Inc    are sets of edges
whose coef cient values are known 

Auxiliary and quasiIV sets enable   bootstrapping procedure whereby complex models can be identi ed by iteratively identifying coef cients and using them to generate
new auxiliary variables  For example  consider Figure    
First  we are able to identify   and   using IVs  but no other
coef cients  Once   is identi ed  Corollary   tells us that  
is identi ed using   
  since    is an IV for   when the edge
for   is removed  see Figure     Now  the identi cation of
  allows us to identify   and   using   
  since    is an IV
for   and   when the edge for   is removed  see Figure    
This general strategy is the basis for our identi cation  zidenti cation  and model testing algorithm  described next 

  Identi cation and zIdenti cation

Algorithm

In this section  we construct an identi cation algorithm
that operationalizes the bootstrapping approach described
in Section   First  we describe how to algorithmically  nd
  quasiinstrumental set for   set of coef cients    given  
set of known coef cients  IDEdges 
The problem of  nding generalized instrumental sets was
addressed by van der Zander and Liskiewicz   They
provided an algorithm  TestGeneralIVs  that determines
whether   given set   is   generalized instrumental set for
  set of edges     that runs in polynomial time if we bound
the size of the coef cient set to be identi ed  More specifically  their algorithm has   running time of     nk 
where   is the number of variables in the graph and    
   
Our method  TestQIS  given in the Appendix  Chen et al 
  generalizes TestGeneralIVs  for quasiIV sets 

 van der Zander and Liskiewicz   also give an algorithm
that tests whether   is   simple conditional instrumental sets in
  nm  time    simple conditional instrumental set is   generalized instrumental set where               Wk

Identi cation and Model Testing using AVs

   

   

   

Figure         is identi ed using either    or    as an instrument and   is identi ed using   as an instrument       is identi ed using   
as an auxiliary instrument given       and   are identi ed using   

  as an auxiliary instrument

 

 cid 

 cid 

 cid 

 cid 

 cid 

FindQIS  also given in the Appendix  Chen et al   
searches for   quasiIV set by checking all subsets of    
 Anc zi    Anc    using TestQIS  It returns   quasiIV
set  as well as its conditioning sets  if one exists 
In some cases an instrumental set may not exist for   
  where      
but one exists for  
  Conversely  there
may not be an instrumental set for  
  but there is one for
     
  As   result  we may have to check all possible subsets of   variable   coef cients in order to determine
whether   given subset is identi able using auxiliary instrumental sets  This search can be simpli ed somewhat
by noting that if   is   connected edge set  de ned below 
with no instrumental set  then there is no superset  
with
an instrumental set 
De nition    Chen et al    For an arbitrary variable 
    let               ak be the unique partition of Pa   
such that any two parents are placed in the same subset 
  ai  whenever they are connected by an unblocked path   
connected edge set with head   is   set of directed edges
from   ai to   for some             
The ID algorithm  called qID utilizes FindQIS to identify as many coef cients as possible in   given model with
graph    It iterates through each connected edge set and
attempts to identify it using FindQIS 
If it is unable to
identify the connected edge set  it then attempts to identify subsets of the connected edge set  After the algorithm has attempted to identify each connected edge set  it
again attempts to identify each unidenti ed connected edge
set  since each newly identi ed coef cient may enable the
identi cation of previously unidenti able coef cients  This
process is repeated until all coef cients have been identi 
 ed or no new coef cients have been identi ed in the last
iteration  The algorithm is polynomial if the degree of each
node in the graph is bounded 
Our algorithm identi es the model depicted in Figure    in
the following way  First  let us assume that the connected
edge sets are arbitrarily ordered                 
Now  the  rst edge to be identi ed would be   using   
as an IV  There is no auxiliary IV set for           and we
would attempt to  nd one for its subsets  We  nd that    
is identi ed using     as an IV set with conditioning set

    Now      is identi ed using          bx  and  
is identi ed using   
  In the second iteration  we return to
          and  nd that it is now identi ed using the auxiliary
IV set           
 

Algorithm   qID      IDEdges 

Initialize  EdgeSets   all connected edge sets in  
repeat

for all ES in EdgeSets such that
ES  cid  IDEdges do

    He ES 
for all     ES such that    cid  IDEdges do
          FindQIS    ES  IDEdges 
if          cid  then
Identify ES using    as an auxiliary
instrumental set in   IDEdges Inc   
IDEdges   IDEdges   ES

end if

end for

end for

until All coef cients have been identi ed or no coef 
cients have been identi ed in the last iteration

In contrast  Figure    is not identi ed using simple instrumental sets and auxiliary variables  We cannot identify  
without conditioning on    which means that the only coef cients identi ed using auxiliary simple instrumental sets
is    Since Chen et al    showed that any coef cient
identi ed using the generalized halftrek criterion  gHTC 
can be identi ed using auxiliary variables and simple instrumental sets  we know that qID is able to identify coef 
 cients and models that the gHT algorithm is not  Moreover  qID will identify any coef cients that are identi able
using auxiliary variables and simple instrumental sets  giving us the following theorem 
Theorem   Given an arbitrary linear causal model  if  
set of coef cients is identi able using the gHT algorithm 
then it is identi able using qID  Additionally  there are
models that are not identi ed using the gHT algorithm 
but identi ed using qID 

Identi cation and Model Testing using AVs

   

   

Figure                  where               
        and  equivalently    is overidenti ed using    and    as IVs     the model
is identi ed using auxiliary instrumental sets  but not the gHT
algorithm

  Deriving Testable Implications using AVs
Theorem   also enables us to derive new vanishing partial
correlation constraints that can be used to test the model 
For example  in Figure       can be identi ed using    as
an instrument  Once   is identi ed  we can generate the
AV                        
         and Theorem   tells us
that the correlation of    and    should vanish  As   result 
we can test the model speci cation by verifying that this
constraint holds in the data 
Theorem   also tells us that the correlation between    and
   should also vanish  However  upon closer inspection 
we  nd that this implication does not actually constrain the
covariance matrix 

                  

        

necessary to generate the AV  The key point is that this
identi cation cannot rely on the same lack of edge whose
existence we are trying to test 
In the above example  we identi ed   using    as an IV 
           follows from the lack of edge between   
and    However  even if this edge did exist     still equals
         
         In contrast             follows from the
lack of edge between    and    The existence of this edge
would disallow    as an instrument and              cid 
         
Another way to derive the constraint            is via
overidenti cation    can be identi ed using either    or   
and equating the corresponding expressions yields the constraint      
      which is clearly equivalent to the
previous constraint            In fact  we show  Theorem   that whenever   variable   cannot be separated from
another variable    but    can be  the resulting AV conditional independence  if it is nonvacuous  is equivalent to an
overidentifying constraint that can be derived using quasiIVs  As   result  all nonvacuous AV conditional independences are captured by overidentifying constraints derived
using quasiIVs 
First  we give   suf cient condition for when   set of edges
  is overidenti ed 
Theorem   Let   be   quasiIV set for structural coef 
cients             and   be   set of known edges  If
there exists   node   satisfying the conditions listed below 
then   is overidenti ed and we obtain the constraint  

             

               
      

          

         

In other words  our  testable implication  that         
  is equivalent to stating                      tautology  In contrast 

                        
      

          

does provide   true testable implication 
Shpitser et al    noticed   similar phenomenon when
deriving dormant independences in nonparametric models  and their explanation applies to conditional independence constraints among AVs as well  The idea is the following  When the model implies that two variables are conditionally independent  it relies on the modeled assumption
that there is no edge between those variables  As   result 
verifying that the constraint holds in data represents   test
that this assumption is valid  However  unlike conditional
independence constraints between model variables  conditional independence constraints among AVs rely upon the
absence of certain edges in order to identify the coef cients

 ii  There exists an unblocked path between   and   in 

cluding an edge in  

 iii  There exists   conditioning set   that does not block

the path    such that either 

    the elements of   are nondescendants of    and

          Ey  where Ey       Inc   
    the elements of   are nondescendants of   and
   and           Es Ey  where Es      
Inc   

The above theorem can be used to derive an overidentifying
constraint for every variable that satis es    iii  above  It
can also be applied when   is known   priori  yielding  
zoveridentifying constraint  In this case        would be
  quasiIV set that trivially identi es  
The following theorem states that nonvacuous AV conditional independence constraints are subsumed by quasiIV
overidentifying and zoveridentifying constraints 

Identi cation and Model Testing using AVs

Theorem   Let                     ektk and suppose
there does not exist   such that            There ex 
       is nonists   such that     De        and    
vacuous if and only if   satis es the conditions of Theorem
  for           ek 

The above theorem also applies when   is an AV  called
In this case  we simply replace           with
  
        GEy   where Ey   Inc    is   set of edges
whose coef cient values are known 
Algorithm   uses quasiIV sets to output overidenti ying
constraints in   graph given an optional set of identi ed
edges  It uses isEIV  which is   slightly modi ed version
of FindQIS that tests whether    ts the conditions of Theorem   Details of isEIV can be found in the Appendix
 Chen et al   

Algorithm   Finds overidentifying constraints for  

for all ES   Edge Sets of   do

function CONSTRAINTFINDER   IDEdges 
          FINDQIS ES   IDEdges 
if          cid    then
for all              He ES  do
if ISEIV   ES   IDEdges  then
Add constraint awA     bw

end if

end for

end if

end for

end function

  Discussion and Related Work
In this section  we discuss how  singlevariable  auxiliary
IVs encompass   number of previous identi cation methods developed in economics  Hausman and Taylor   
computer science  Chan and Kuroki    and epidemiology  Shardell   
Hausman and Taylor   showed that if the equation for
  given variable                 kpk   uz  is identi ed 
then the error term uz can be estimated and used as an instrument for other coef cients  In this case  the auxiliary
variable                     kpk is equal to the error
term uz  As   result  whenever the error term is estimable
and can be used as an IV  we can also generate an auxiliary instrument  However  there are times when only some
of the coef cients in an equation are identi able  and as  
result  the error term cannot be used as an instrument  but
we can nevertheless generate an auxiliary instrument  As  
result  auxiliary IVs strictly subsume error term IVs 
Chan and Kuroki   gave suf cient conditions for
when   descendant of   and   descendant of   could be

used in analogous manner to IVs to identify the effect of
  on    In the context of AVs  this method is equivalent
to generating an auxiliary instrument from the descendant
by subtracting the total effect of   on the descendant or the
total effect of   on the descendant  depending on whether
the variable is   descendant of   or    In this paper  we
generated AVs by subtracting out direct effects  but clearly
the work can be extended to subtracting out total effects 
The bene   of AVs over these descendant IVs is that they
can be generated from   variety of variables  not just descendants of   and    Additionally  descendants of   or  
can generate AVs from other total or direct effects  not just
the effect of   or   on the descendant 
The notion of  subtracting out   direct effect  in order to
turn   variable into an instrument was also noted by Shardell   when attemping to identify the total effect of  
on    It was noticed that in certain cases  the violation of the
independence restriction of   potential instrument          
is not independent of the error term of    could be remedied
by identifying  using ordinary least squares regression  and
then subtracting out the necessary direct effects on    AVs
generalize and operationalize this notion so that it can be
used on arbitrary sets of known coef cient values and be
utilized in conjunction with existing graphical methods for
identi cation and enumeration of testable implications 
Additionally  as we have alluded to earlier  the highly algebraic  stateof theart gHTC can also be understood in
terms of auxiliary instruments  Identi cation using the gHTC is equivalent to identi cation using auxiliary simple
instrumental sets 
In summary  auxiliary instruments are not only the basis
for the most general identi cation algorithm yet devised 
but they also unify disparate identi cation methods under
  single framework  Moreover  AVs are directly applicable
to the tasks of zidenti cation and model testing  Finally 
they can  in principle  enhance any method for identi cation  model testing  or other tasks that relies on graphical
separation 

  Conclusion
In this paper  we graphically characterized conditional independence among AVs  allowing us to demonstrate how
they can help generalized instrumental sets in the problem
of identi cation  We provided an algorithm that identi es
more models than the gHT algorithm  subsuming the stateof theart for identi cation in linear models  Additionally 
we introduced quasiIV sets  and constructed an algorithm
that utilizes them to attack the problem of zidenti cation 
Finally  we proved that AV conditional independences are
subsumed by overidentifying constraints and gave an algorithm for deriving overidentifying constraints 

Identi cation and Model Testing using AVs

Acknowledgements
We would like to thank Judea Pearl  Mathias Drton 
Thomas Richardson  and Luca Weihs for helpful discussions  This research was supported in parts by grants from
NSF  IIS  and  IIS  and ONR    
  and    

References
BAREINBOIM     and PEARL       Causal inference
by surrogate experiments  zidenti ability  In Proceedings of the TwentyEighth Conference on Uncertainty
in Arti cial Intelligence     de Freitas and    Murphy 
eds  AUAI Press  Corvallis  OR 

BAREINBOIM     and PEARL       Causal inference and the datafusion problem  Proceedings of the
National Academy of Sciences    

BEKKER     MERCKENS     and WANSBEEK      
Identi cation  Equivalent Models  and Computer Algebra  Statistical Modeling and Decision Science  Academic Press 

BOWDEN     and TURKINGTON       Instrumental Variables  Cambridge University Press  Cambridge 
England 

BRITO     and PEARL         Generalized instrumenIn Uncertainty in Arti cial Intelligence 
tal variables 
Proceedings of the Eighteenth Conference     Darwiche
and    Friedman  eds  Morgan Kaufmann  San Francisco   

BRITO     and PEARL           graphical criterion
for the identi cation of causal effects in linear models 
In Proceedings of the Eighteenth National Conference
on Arti cial Intelligence  AAAI Press The MIT Press 
Menlo Park  CA   

BRITO     and PEARL           new identi cation
condition for recursive models with correlated errors 
Journal Structural Equation Modeling    

BRITO     and PEARL       Graphical condition for
identi cation in recursive SEM  In Proceedings of the
TwentyThird Conference on Uncertainty in Arti cial Intelligence  AUAI Press  Corvallis  OR   

CHAN     and KUROKI       Using descendants
as instrumental variables for the identi cation of direct
In Proceedings of the
causal effects in linear sems 
Thirteenth International Conference on Arti cial Intelligence and Statistics  AISTATS 

CHEN       Identi cation and overidenti cation of
linear structural equation models  In Advances In Neural
Information Processing Systems   

CHEN     KUMOR     and BAREINBOIM      
Identi cation and model testing in linear structural equation models using auxiliary variables  arXiv preprint
arXiv  Technical report    Purdue AI
Lab  Dept  of Computer Science  Purdue University   

CHEN     and PEARL       Graphical tools for
linear structural equation modeling 
Tech  Rep    
   http ftp cs ucla edu pub stat ser   pdf  Department of Computer Science  University of California 
Los Angeles  CA  Forthcoming  Psychometrika 

CHEN     PEARL     and BAREINBOIM       Incorporating knowledge into linear structural equation modIn Proceedings of the
els using auxiliary variables 
Twenty fth International Joint Conference on Arti cial
Intelligence     Kambhampati  ed 

linear

structual

of

CHEN     TIAN     and PEARL       Testable
equation modimplications
the Twentyeighth AAAI
els 
Conference on Arti cial
Intelligence        Brodley and    Stone  eds  AAAI Press  Palo  CA 
 http ftp cs ucla edu pub stat ser   reprint pdf 

In Proceedings of

DRTON     and WEIHS       Generic identi ability of linear structural equation models by ancestor
Scandinavian Journal of Statistics
decomposition 
        sjos 
URL
 

http dx doi org sjos 

FISHER       The Identi cation Problem in Econo 

metrics  McGrawHill  New York 

FOYGEL     DRAISMA     and DRTON       Halftrek criterion for generic identi ability of linear structural equation models  The Annals of Statistics    
 

HAUSMAN        and TAYLOR         

Identi 
cation in linear simultaneous equations models with covariance restrictions  an instrumental variables interpretation  Econometrica  Journal of the Econometric Society  

MOOIJ        PETERS     JANZING     ZSCHEISCHLER     and SCH  OLKOPF       Distinguishing
cause from effect using observational data  methods and
benchmarks  Journal of Machine Learning Research  
 

PEARL       Robustness of causal claims  In Proceedings of the Twentieth Conference Uncertainty in Arti cial Intelligence     Chickering and    Halpern  eds 
AUAI Press  Arlington  VA   

Identi cation and Model Testing using AVs

ZHANG     and HYV  ARINEN       On the identi ability of the postnonlinear causal model  In Proceedings
of the TwentyFifth Conference on Uncertainty in Arti 
cial Intelligence  AUAI Press 

PEARL       Causality  Models  Reasoning  and Inference   nd ed  Cambridge University Press  New York 

RIGDON            necessary and suf cient identi 
 cation rule for structural models estimated in practice 
Multivariate Behavioral Research    

SHARDELL       Methods to overcome violations
of an instrumental variable assumption  Converting  
confounder into an instrument  Computational statistics
  data analysis    

SHIMIZU     HOYER        HYV  ARINEN     and KERMINEN         linear nongaussian acyclic model
for causal discovery  Journal of Machine Learning Research    

SHPITSER     RICHARDSON        and ROBINS       

  Testing edges by truncations  In IJCAI 

SPIRTES     GLYMOUR        and SCHEINES      

Causation  prediction  and search  vol    MIT press 

SPIRTES     RICHARDSON     MEEK     SCHEINES 
   and GLYMOUR       Using path diagrams as
  structural equation modelling tool  Sociological Methods and Research    

TIAN       Identifying direct causal effects in linear
models  In Proceedings of the National Conference on
Arti cial Intelligence  vol    Menlo Park  CA  Cambridge  MA  London  AAAI Press  MIT Press   

TIAN         criterion for parameter identi cation
In Proceedings of the
in structural equation models 
TwentyThird Conference Annual Conference on Uncertainty in Arti cial Intelligence  UAI  AUAI Press 
Corvallis  Oregon 

TIAN       Parameter identi cation in   class of linIn Proceedings of the
ear structural equation models 
TwentyFirst International Joint Conference on Arti cial
Intelligence  IJCAI 

VAN DER ZANDER     and LISKIEWICZ      
Searching for generalized instrumental variables  In Proceedings of the  th International Conference on Arti 
cial Intelligence and Statistics  AISTATS 

VAN DER ZANDER     TEXTOR     and LISKIEWICZ    
  Ef ciently  nding conditional instruments for
In Proceedings of the TwentyFourth
causal inference 
International Joint Conference on Arti cial Intelligence
 IJCAI  

WRIGHT       Correlation and causation  Journal of

Agricultural Research    

