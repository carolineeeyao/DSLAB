Regret Minimization in BehaviorallyConstrained ZeroSum Games

Gabriele Farina   Christian Kroer   Tuomas Sandholm  

Abstract

Noregret learning has emerged as   powerful
tool for solving extensiveform games  This was
facilitated by the counterfactualregret minimization  CFR  framework  which relies on the instantiation of regret minimizers for simplexes at
each information set of the game  We use an
instantiation of the CFR framework to develop
algorithms for solving behaviorallyconstrained
 and  as   special case  perturbed in the Selten
sense  extensiveform games  which allows us to
compute approximate Nash equilibrium re nements  Nash equilibrium re nements are motivated by   major de ciency in Nash equilibrium  it provides virtually no guarantees on how
it will play in parts of the game tree that are
reached with zero probability  Re nements can
mend this issue  but have not been adopted in
practice  mostly due to   lack of scalable algorithms  We show that  compared to standard algorithms  our method  nds solutions that have
substantially better re nement properties  while
enjoying   convergence rate that is comparable to
that of stateof theart algorithms for Nash equilibrium computation both in theory and practice 

  Introduction
Noregret learning algorithms have become   powerful
tool for solving largescale zerosum extensiveform games
 EFGs   Bowling et al    Brown et al    This has
largely been facilitated by the counterfactualregret minimization  CFR  algorithm  Zinkevich et al    and
its newer variants  Lanctot et al    Sandholm   
Bowling et al    Brown and Sandholm    Brown
et al    Brown and Sandholm    This framework
works by de ning   notion of regret local to an information

 Carnegie Mellon University  Pittsburgh PA   USA  Correspondence to  Gabriele Farina  gfarina cs cmu edu  Christian Kroer  ckroer cs cmu edu  Tuomas Sandholm  sandholm cs cmu edu 

Proceedings of the   th International Conference on Machine
Learning  Sydney  Australia  PMLR     Copyright  
by the author   

set  and instantiating   standard regret minimizer at each
information set in order to minimize local regret  Zinkevich et al    prove that this scheme of local regret
minimization leads to   Nash equilibrium in twoplayer
zerosum extensiveform games of perfect recall  The
framework works with any regretminimizing algorithm 
but in practice variants of the regret matching algorithm
have been dominant  Hart and MasColell    Bowling et al    Brown and Sandholm    Brown et al 
  We investigate the extension of regretmatching 
 RM   Tammelin et al    an even faster regretmatching algorithm  to more general regretminimization
problems over  nitelygenerated  convex polytopes  We
use these results to instantiate RM  for linearly constrained
simplexes  which in turn allows us to model and solve
behaviorallyconstrained EFGs  which are EFGs with additional linear constraints on the simplexes at each information set  An important special case of this framework is
behaviorallyperturbed EFGs  which can be used to compute Nash equilibrium re nements 
Nash equilibrium re nements are motivated by major de 
ciencies in the Nash equilibrium solution concept  Nash
equilibria provide no guarantees on performance in information sets that are reached with probability zero in
equilibrium  beyond not giving up more utility than the
value of the game  Thus  if an opponent makes   mistake 
Nash equilibrium is not guaranteed to capitalize on it  but
may instead give back up to all of that utility  Miltersen
and   rensen    This is especially relevant when
Nash equilibria are used as   solution concept for playing against imperfect opponents  Equilibrium re nements
ameliorate this issue by introducing further constraints on
behavior in information sets that are reached with probability zero  We will be interested in equilibrium concepts

 The idea of certain kinds of behavioral perturbations to CFR
has been suggested by Neller and Lanctot   They suggest
that at every information set  with small probability     player
will make   random move  However  they provide no results of
what the re nement consequences are       what kind of re nement this would lead to  and it is unclear whether the proposed
method actually leads to re nements  In contrast  we establish  
connection to  approximate  EFPEs in this paper  Furthermore 
Neller and Lanctot cite Miltersen and   rensen   which is
about quasiperfect equilibrium  where   player assumes she will
not make errors in the future  while the   modeling of Neller and
Lanctot makes   errors at future information sets as well 

Regret Minimization in BehaviorallyConstrained ZeroSum Games

that achieve this through the notion of perturbations or
trembling hands  Selten    At each decisionpoint   
player is assumed to tremble with some small probability 
and   Nash equilibrium is then computed in this perturbed
game    re nement is then   limit point of the sequence of
Nash equilibria achieved as the probability of trembles is
taken to zero  In quasiperfect equilibria  players take into
account only the trembles of their opponents  van Damme 
  whereas in an extensiveform perfect equilibrium
 EFPE  players take into account mistakes made both by
themselves and opponents  Selten   
We compare our algorithm for perturbed EFGs to stateof 
theart largescale zerosum EFGsolving algorithms  the
standard CFR  algorithm  Tammelin et al    and the
excessive gap technique  EGT   Nesterov      instantiated with   stateof the art smoothing function  Nesterov 
    Hoda et al    Kroer et al        We
 nd that our perturbed variant of CFR  converges  in the
perturbed game  at the same rate as those algorithms converge while ours leads to orders of magnitude more re ned
strategies  Our algorithm also converges at the same rate
in the unperturbed game  almost until the point where the
imposed behavioral constraints necessarily prevent further
convergence 

  Related work
Noregret algorithms have   long history in EFG solving 
Gordon   developed the Lagrangian Hedging algorithm  which can be used to  nd   Nash equilibrium in
EFGs  However  it suffers from   drawback 
it requires
projection onto the strategy space at each iteration  Zinkevich et al    developed CFR  which avoids projection
while maintaining the same convergence rate  It has since
been extended in   number of ways  Lanctot et al   
showed how to incorporate sampling in CFR  Brown and
Sandholm   showed how to achieve greater pruning
in CFR  thereby reducing the iteration costs  CFR  is
  stateof theart variant of CFR  Tammelin et al   
which has vastly superior practical performance compared
to standard CFR  though it is not known to be stronger
from   theoretical perspective  Gordon et al    shows
how noregret algorithms can also be utilized for computing extensiveform correlated equilibria in EFGs 
Polynomialtime algorithms have been proposed for computing certain equilibrium re nements in twoplayer zerosum perfectrecall EFGs  Miltersen and   rensen  
develop   linear program  LP  for computing quasiperfect
equilibria by choosing   suf ciently small perturbation to
realization plans  Farina and Gatti   develop   similar
approach for EFPE computation  but rely on perturbations
to behavioral strategies of players  These approaches rely
on solving modi ed variants of the sequenceform LP for

computing Nash equilibrium  von Stengel    in EFGs 
These algorithms are of theoretical interest only and do not
work in practice  They require rational numbers of precision   log   bits  where   is the number of sequences in the
game  Another issue is that LP algorithms do not scale to
large EFGs even when just  nding Nash equilibria  and in
practice CFRbased or EGTbased approaches are used to
achieve scalability  Kroer et al      recently showed
how smoothing functions for  rstorder methods such as
EGT can be extended to games with perturbations 
Johanson et al    consider robust strategies that arise
from assuming that the opponent will randomize between
playing   Nash equilibrium and   strategy within some
model of opponent behavior 
Johanson and Bowling
  consider   similar modelbiased Nash equilibrium
approach on games where an independent model is used at
each information set  Ganzfried and Sandholm   develop an opponent modeling approach that adds opponentmodeled constraints across information sets  Our approach
provides   principled framework for solving modelbiased
games that use general constraints on perinformation set
behavioral strategies  Constraints across information sets
currently require the much less scalable LP approach 

  Preliminaries
We brie   introduce several of the basic concepts we use
in the rest of the paper  We denote by    and  
  the set
of nonnegative and nonpositive reals  respectively 

  NormalForm Games
De nition     twoplayer zerosum normalform game
 for the rest of the paper  simply normalform game or
NFG  is   tuple           where    represents the  nite
set of actions that player   can play     represents the  nite
set of actions that player   can play  and                
is the payoff function for player   mapping the pair of actions        of the players into the payoff for player   The
corresponding payoff for player   is given by         
Usually  the payoff function   is given as   matrix    called
the payoff matrix of the game  The rows of   represent
the actions                       of player   while the
columns of   represent the actions                      
of player   At the intersection of the ith row and the jth
column is the payoff for the action pair           
De nition     mixed strategy   for player         is  
probability mass function over the set Ai 

When players play according to mixed strategies   and  
respectively  the expected payoff is given by

      

            

 

 cid 

 cid 

    

    

Regret Minimization in BehaviorallyConstrained ZeroSum Games

  Generalized NormalForm Games

Telgarsky   and Abernethy et al    propose  
generalization of the concept of normalform games  which
conveniently allows us to remove all expectation operators 
making the notation lighter and more legible  In this generalization  players select deterministic strategies from   convex compact set  For   normalform game  this set is the
space of all mixed strategies 
De nition     twoplayer zerosum generalized normalform game               is   tuple de ned by   pair of
convex and compact action spaces     Rn      Rm 
one for each player  as well as   biaf ne utility function
               The utility function         maps the pair
of actions                of the players into the payoff
for player   while the corresponding payoff for player   is
given by         
Observation   Any normalform game can be mapped
to an instance of   generalized normalform game  Given
              where         and          the set of
all mixed strategies for player   forms the ndimensional
simplex         while the set of all mixed strategies for
player   forms the mdimensional simplex         Let
  be the payoff matrix associated with   Using Equation   we conclude that   is equivalent to the generalized
twoplayer zerosum normalform game              
where             cid     for all                
  ExtensiveForm Games
De nition     twoplayer zerosum extensiveform game
with imperfect information and perfect recall   is   tuple
             fc         composed of 

        nite set of possible sequences  or histories  of
actions  such that the empty sequence        and
every pre     of   in   is also in   
those se 
         the set of terminal histories      
quences that are not   proper pre   of any sequence 
       function mapping           to the set of avail 
      the player function  mapping each nonterminal
history           to        representing the player
who takes action after    If            the player is
chance 

able actions at nonterminal history   

            probability mass function over     

  fc    function assigning to each           such that
  Ii  for         partition of                    
with the property that            cid  for each      cid 
in the same set of the partition  For notational convenience  we will write      to mean      for any of the
       where     Ii  Ii is the information partition of
player    while the sets in Ii are called the information
sets of player   

     utility function mapping       to the utility   
real number  gained by player   when the history is
reached  The corresponding utility for player   is
given by      

We further assume that all players can recall their previous
actions and the corresponding information sets 

In the rest of the paper  we will use the more relaxed term
extensiveform game  or EFG  to mean   twoplayer zerosum extensiveform game with imperfect information and
perfect recall 
Observation   Extensiveform games can be represented
as generalized NFGs  for example  via the normal form representation or sequence form representation  Romanovskii 
  Koller et al    von Stengel   

  Regret and Regret Minimization

Suppose there exists an iterative algorithm which  at each
step                   computes   strategy xt     for player
  and plays    generalized  normalform game          
against player   using such strategy  Let yt be the strategy
used by player   at step    The average external regret of
player   up to step   against action        is

 RT

       

 
 

     yt      xt  yt 

 RT
         

The case for player   is symmetrical    regretminimizing
scheme is   function that assigns  for each sequence of
past actions               xt  yt  an action xt such that
lim supT  max    
Regretmatching  RM   Hart and MasColell    is  
regretminimizing scheme for normalform games  based
on Blackwell   approachability theorem  Blackwell   
The following theorem    proof of which is given by CesaBianchi and Lugosi   characterizes the convergence
rate of RM 
Theorem   Given   normalform game           the
maximum average external regret for player   at iteration
    when player   plays according to the regretmatching
algorithm  is

  cid 

  

 cid 
    

 

max

  

 RT
         

where  

 
  maxx             minx          

Regretmatching  is an extension of RM  and converges
signi cantly faster in practice  Tammelin et al 
 
Lemma   proved that the convergence rate of RM  is the
same as that of RM above 

  Nash Equilibria and Re nements

We now review the needed solution concepts from game
theory  We mostly focus on generalized normalform

Regret Minimization in BehaviorallyConstrained ZeroSum Games

games  allowing   compact presentation of concepts
pertaining both normalform games and extensiveform
games 
De nition    Approximate best response  Given   generalized normalform game           and   strategy       
we say that       is an  best response to   for player   if
                      for all          Symmetrically  given
        we say that       is an  best response to   for
player   if                          for all        
De nition    Approximate Nash equilibrium  Given  
generalized normalform game           the strategy pair
               is    Nash equilibrium for the game if  
is an  best response to   for player   and   is an  best
response to   for player  
De nition    Nash equilibrium  Given   generalized
normalform game             Nash equilibrium for the
game is    Nash equilibrium 

There exists   wellknown relationship between regret and
approximate Nash equilibria  De nition   as summarized
in the next theorem 
Theorem   In   zerosum game  if the average external
regrets of the players up to step   are such that

 RT
         

 RT
         

for all actions                  then the strategy pair

 cid 

  cid 

  

yi

       

 cid 

  cid 

  

 
 

 xT    yT  

 
 
is an      Nash equilibrium 

 
 

xi 

Theorem   basically says that if there exists an iterative algorithm able to progressively propose strategies so that the
maximum average external regret go to zero  then recovering   Nash equilibrium is straightforward  and just   matter
of averaging the individual strategies proposed 
We now turn to the class of perturbed games  Selten   
Intuitively    perturbation restricts the set of playable strategies by enforcing   lower bound on the probability of playing each action  We recall the de nition and some of the
properties of game perturbations  starting from the normalform case  We focus on player   but remark that the same
de nitions hold symmetrically for player   as well 
De nition   Let               be an NFG and let
tion                  such that cid 
               be its generalized NFG repre 
 cid 
sentation  see Observation     perturbation is   funca             and
              The corresponding perturbed NFG    is
where  Xp  cid           xa             
the generalized NFG where each action   must be played
with probability at least      Formally          Xp   Yp    
 ned analogously 

 cid   Yp is de 

In the case of extensiveform games    perturbation for
player   assigns   lowerbound on each action playable by
the player  More precisely 
De nition   Let                  fc         be an
extensiveform game    perturbation is   function   mapping each pair        where             and          to  
nonnegative real  such that

 cid 

      

           

             

The corresponding perturbed EFG    is the analogous
game where each action   at each information set   has
to be played with probability at least        

Perturbations play an important role in equilibrium re nement  as they form the basis for the concept of equilibrium
perfection  Selten    In this paper we only focus on
the case of extensiveform perfect equilibria  EFPEs 
De nition     strategy pair                is an EFPE
of   if it is   limit point of   sequence  xp  yp    where
 xp  yp  is   Nash equilibrium of the perturbed game    

Intuitively  an EFPE is an equilibrium re nement that takes
into account an imperfect ability to deterministically commit to   single action 

  Generalized NormalForm Games over

FinitelyGenerated Convex Polytopes

In this section  we show how to adapt   regretminimization
algorithm to handle generalized normalform games played
on  nitelygenerated convex polytopes  The key insight
is that when the action space is    nitelygenerated convex polytope 
the generalized game can be cast back
as   normalform game         generalized normalform
game played over simplexes  and  solved  by   regretminimization algorithm  subsequently  the solution for the
normalform game gets mapped back into the polytope 
This is achieved by constructing new simplex action spaces
for the players  where each point in   simplex denotes  
convex combination of weights on the vertices of that players   nitelygenerated convex polytopal action space 
Theorem   Let               be   generalized normalform game played on the  nitelygenerated convex polytopes   and    There exists   regretminimizing scheme
for player   in  

Proof  Let             bn  be   convex basis for     and
            cm  be   convex basis for    also  let          
    bn  and               cm  be the basis matrices for
  and    respectively  We construct   generalized normalform game                where

       

 
    Bx  Cy 

Regret Minimization in BehaviorallyConstrained ZeroSum Games

for all                 Of course Bx       Cy    
for all   and    so the de nition is valid  Let    be any of
regretminimizing schemes for normalform games      
RM or RM  We construct   regretminimizing scheme  
for   such that  at each iteration                

Algorithm   RM  algorithm for generalized normalform
games played over  nitelygenerated convex polytopes 
  procedure REGRETMATCHING 

 cid                and   is    xed convex basis for  
 cid  note  this re ects the point of view of player  

 
 
 
 
 
 

 

 

 
 

 

 

                 xt  yt    Bf                        
where       denotes the coordinates of      with respect to
the basis of       respectively  note that this de nition is
wellde ned since the coordinates are guaranteed to belong
to       

  The regret induced by this scheme is

  cid 
  cid 

  

  

 RT

       

 

 
 

 
 

     yt      xt  yt 

                          

Notice that the last expression is exactly the average regret for player   up to iteration   against action     in
  Since    is   regretminimizing scheme  the average regret against any action converges to zero  mean 
 RT
    
          for each    
ing that
lim supT 
 RT
          This proves that   is  
lim supT  max    
regretminimizing scheme for   concluding the proof 

Another way to think about the construction above is that at
each iteration  we compute the regret for not playing each
of the  strategies  forming the vertices of the polytope  and
updating the next strategy by taking   convex combination
of the vertices  in   way proportional to the regret against
them 
Algorithm   represents an instantiation of the construction given in the proof of Theorem   where the regretminimizing scheme for the normalform game was chosen to be RM    careful analysis of the construction
also reveals that the convergence bound for RM  carries
over  as expressed by Theorem   At time    RM  projects
the cumulative regret rt  onto the nonnegative orthant
Rn
  the projection is equal to the vector  rt  where
   
 
Theorem   Given   generalized normalform game
          with  nitely generated   and    the maximum
average external regret for player   at iteration     when
player   plays according to Algorithm   is bounded by

 
  max  ai 

 cid 
    

max
    

 RT
         

 
  maxx             minx           and     de 

where  
notes the number of vertices of    
coordinate vector will do  as long as the choice is deterministic 

 Passage to coordinates might not be unique  In this case  any

                cid    Rn
                cid    Rn
for                 do
if rt    Rn
then
 
  cid 
else

xt   any action    Xp

     

 rt 

 

  

 rt 
   

xt    
play action xt
observe yt     played by opponent

      yt      xt  yt 

 rt   

rt  

 

 
 

    

     
 

    

 
 

  bn  yt      xt  yt 
xt

 cid     contains the average strategy for player  

  Behavioral Constraints and Perturbations
Behavioral constraint are linear constraints on the simplexes at each information set  In order to obtain   regret
minimizer for   behaviorallyconstrained EFG  we could
try to cast the game as   generalized NFG by means of
the normalform or sequence form representation  see Observation   However  the number of vertices of this representation is exponential  and therefore it does not work
well with Theorem   Counterfactual Regret  CFR  Zinkevich et al    solves this problem  by de ning   regretminimizing scheme that runs in polynomial time in the size
of the game  Intuitively  CFR minimizes   variant of instantaneous regret  called immediate counterfactual regret 
at each information set separately  and later combines the
strategies computed at each information set 
It requires
simplex regret minimizers for each information set  If we
have    nite number of them  each information set can be
modeled as    nitelygenerated convex polytope  We can
then use Theorem   to get regret minimizers for each information set  Perturbations can be handled as   special case 
Theorem   below shows that CFR  instantiated with such
regret minimizers for each behaviorallyconstrained information set converges to an equilibrium of the constrained
EFG  For this approach to be practical  we need the set
of vertices for each information set to be of manageable

 cid 
size  as re ected in the dependence on maxI  
 QI  in
Theorem   where  QI  is the number of vertices in the
behaviorallyconstrained simplex at information set   
Theorem   Let
an
represent the
extensiveform game  let QI        
behaviorallyconstrained strategy space at information set
   for all             The maximum average external
regret for player   in the constrained game at iteration    
when player   plays according to CFR  is bounded by

             fc        

be

 cid 

 RT
       

maxI     QI 

 

  

where  

 
  maxx             minx          
  Perturbed NormalForm Games
Section   established that  in general  the problem of  nding an approximate Nash equilibrium for player   in the
generalized normalform game               where   is
  convex polytope generated by   vectors  can be solved
via regretmatching 
We now specialize this result for the speci   case of perturbed normalform games  The following holds 
Proposition   Let               be   normalform
game  where                  an  and let   be   perturbation for player   Let         Xp   Yp     be the generalized
normalform game corresponding to the perturbation  Definition   Then the perturbed action space  Xp is    nitely
generated convex polytope of dimension      basis of which
is given by the columns of the following invertible matrix 

         

    

 

 
 

Bp

    

         

 

 
 
 
 

 

    
    

 

  an 

  an 

       an 

where   

 
                   an 

This means that Algorithm   is applicable and provides  
regretminimizing scheme  We remark that when computing the instantaneous regrets  Algorithm   Line   it is
important to remember these values have to be computed
against the basis             bn  of  Xp  However  computing the  expected  utility of the game when player   plays
according to   mixed strategy is usually more expensive
than the same task when player   plays   deterministic action  For this reason  we express the instantaneous regret
calculation against             bn  in terms of instantaneous
regrets against the pure actions             en  in the unperturbed game  In particular  by using the fact that the utility

Regret Minimization in BehaviorallyConstrained ZeroSum Games

function is biaf ne  we can write  for each                 

  bi  yt     

  aj ej  yt

 pei  

   pu ei  yt   

  aj   ej  yt 

so that  by introducing     
 
corresponding vector   
                   cid  we have

 
    ei  ut      xt  yt  and the

 

 cid 

   

  

  cid 
  cid 
     

  

 

  an 

rt   rt            

This allows us to compute the regret update in terms of
the instantaneous regret against             en  in the unperturbed game  without introducing any overhead from an
asymptotic point of view 
The maximum average external regret for player   at iteration   is given by Theorem   in this case    Xp       
  Perturbed ExtensiveForm Games
As discussed in Section   it is possible to use CFR in conjunction with any regretminimizing scheme for generalized NFGs  in order to de ne   regretminimizing scheme
able to support any behaviorallyperturbed EFG  thus including the restricted case of perturbed EFGs  In Algorithm   we propose an implementation of CFR       CFR
instantiated with the RM  algorithm able to handle perturbed EFGs  Algorithm   assumes that we are given  
perturbation   of the extensiveform game     
  denotes the
perturbed simplex for information set    and       is as in
Proposition  
The following theorem characterizes the convergence guarantee of the proposed algorithm 
Theorem   Let              fc         be an extensive form game  let   be the perturbation applied to the
game  The maximum average external regret for player  
in the perturbed game at iteration     when player   plays
according to Algorithm   is bounded by

 cid 

where  

 RT
       

maxI         
 
 
  maxx             minx          
Proof  Follows as   corollary of Theorem  

  

Notice that
the bound provided by Theorem   is the
same provided by the original CFR algorithm proposed
by Zinkevich et al    In other words  our modi cation does not impair the convergence and speed guarantees
given by the original algorithm 

Regret Minimization in BehaviorallyConstrained ZeroSum Games

Algorithm   Regret minimization algorithm for perturbed
extensiveform games 
  procedure REGRETMATCH INFOSET      

 
 
 

 

 

 cid  we assume                    an 

if rI

else

 

then

     Rn
 
  cid 
    any action       
 cid 
 cid rI
xI
         
        

    

  

xI
   

  

 

 

     an 

 cid 

 cid rI

  
  

  procedure TRAVERSE             

 cid  assume   belongs to information set  

if       then
return     
if           then

 cid  chance node

  Experimental Evaluation
We conducted experiments to investigate the practical performance of our perturbedregret minimization approach
when used to instantiate the CFR and CFR  algorithms for
computing approximate EFPE in EFGs  We compare these
algorithms to stateof theart Nashequilibrium nding algorithms  EGT  Nesterov      on an unperturbed polytope using the stateof theart smoothing technique by
al   Kroer et al      CFR  Zinkevich et
Kroer et 
al    and CFR   Tammelin et al    We conducted the experiments on Leduc hold em poker  Southey
et al      widelyused benchmark in the imperfectinformation gamesolving community 
In our variant 
Leduc    the deck consists of   pairs of cards            for
  total deck size of     We experiment on the standard
Leduc game where       and   larger game where      
Each player initially pays one chip to the pot  and is dealt
  single private card  After   round of betting    community card is dealt face up  After   subsequent round
of betting  if neither player has folded  both players reveal their private cards 
If either player pairs their card
with the community card they win the pot  Otherwise 
the player with the highest private card wins  In the event
that both players have the same private card  they draw and
split the pot  We consider         We test our approach on games subject to different uniform perturbations
            for all information sets   and actions         
for              
Figure   reports on convergence to Nash equilibrium  The
xaxis shows the number of tree traversals performed  We
use tree traversals rather than iterations because EGT requires more tree traversals than CFR  per iteration  The
yaxis shows the sum of player regrets in the full  unperturbed  game  For both Leduc   and   we  nd that the
  perturbations have only   small effect on overall convergence rate until convergence within the perturbed polytope 
at which point the regret in the unperturbed game stops
decreasing  as expected  Until bottoming out  the convergence is almost identical for all CFR  algorithms  This
shows that our approach can be utilized in practice  there
is no substantial loss of convergence rate  Later in the run
once the perturbed algorithms have bottomed out  there is  
tradeoff between exploitability in the full game and re nement       better performance in lowprobability information sets 
The second set of experiments  Figure   investigates the
improvement that our perturbation approach achieves compared to standard Nash equilibrium solutions in terms of
equilibrium re nement  Our measure of re nement is the
maximum regret at any information set  conditioned on
reaching that information set  As discussed  convergence
to   Nash Equilibrium does not guarantee that this measure goes to zero  Again  the xaxis shows the number

 
 
 
 
 
 

 

 
 

 

 
 

 

  

    

 cid  player    turn

 

vI
   

else

sample     fc   
return TRAVERSE ha        
else if           then

REGRETMATCH INFOSET      

TRAVERSE han       yI

  TRAVERSE ha       yI
  TRAVERSE ha     xI
 rI

           

TRAVERSE han     xI
   cid vI
      xI
 
     vI
  

         

vI
   

rI
   

     

 

    

      

        

 

     an 

 
 
 cid 

 

  
 

 cid                   fc        

 xI    xI    xI

 

return   

 
 
  procedure CFR 
for all        do
 
 
 
 
 
 
 
 
 

for all        do

 cid 

 xI  

for                 do

               cid          
rI
 xI              cid          
play according to strategy xt
observe strategy yt played by opponent
TRAVERSE        

 xI  cid     

  

 xI
 

 cid 

 cid     contains the average strategy for player  

Regret Minimization in BehaviorallyConstrained ZeroSum Games

Figure   Regret in Leduc   and Leduc   as   function of the number of iterations for EGT and CFR  with various   perturbations
 denoted in parentheses  Both axes are on   log scale 

of tree traversals performed  The yaxis shows the maximum regret at any individual information set  Both unperturbed CFR  and EGT perform badly in both games
with respect to this measure of re nement 
In Leduc  
both have maximum regret two orders of magnitude worse
than the perturbed approach  In Leduc   EGT still does as
poorly  CFR  does slightly better  but is still worse than
our stronger re nements by more than an order of magnitude  The maximum regret one can possibly cause in an
information set in either Leduc game is   so CFR  and
unperturbed EGT also do poorly in that sense 
In contrast to this  we  nd that our  perturbed solution
concepts converge to   strategy with low regret at every information set  The choice of   is important  for      
the smallest perturbation  we see that it takes   long time to
converge at lowprobability information sets  whereas we
converge reasonably quickly for       or       for
      and       the perturbations are too large  and
we end up converging with relatively high regret  due to
being forced to play every action with probability   Thus 
within this set of experiments          seems to
be the ideal amount of perturbation 

  Discussion
We extended the RM and RM  regret minimization algorithms to  nitelygenerated convex polytopes  and specialized our results to linearlyconstrained simplexes and
behaviorallyperturbed EFGs  We then showed how this
allows us to compute an approximate EFPE  Our experi 

Figure   Maximum regret at any individual information set in
Leduc   and Leduc   as   function of the number of iterations 
for standard EGT as well as with various   perturbations  denoted
EGT  and CFR  The yaxis is on   log scale 

ments showed that this approach leads to much stronger
strategies for information sets reached with low probability 
while maintaining the strong convergence rate of CFR 
Our experiments raise an interesting question  Across both
games  we see that the maximum information set regret
goes down much faster for larger amounts of perturbation 
but then it bottoms out earlier than for smaller perturbations
 as expected  To get the best of both large and small perturbations  it may be possible to decrease the perturbations
over time  leading to faster convergence rate  while never
bottoming out  However  this has   number of challenges
associated with it  Most importantly  we need   variant of
RM or RM  that can handle   slowly expanding feasible
set within the simplex  This would also require decreasing the perturbations at the correct rate  if decreased too
quickly  it is unlikely that we will converge to   re nement 
and if decreased too slowly  we might still bottom out 
The CFR algorithms have been shown to work well with  
number of other techniques  notably sampling  Lanctot et
al    and abstraction  Lanctot et al    Kroer and
Sandholm    It would be both theoretically and practically interesting to see how well our re nement approach
works in conjunction with these techniques 

Acknowledgments
This material is based on work supported by NSF grant IIS 
  and ARO award   NF 

 CFR CFR CFR EGTCFR CFR CFR Numberoftreetraversals approx ofNEinunpert gameLeduc CFR CFR CFR EGTCFR CFR CFR Numberoftreetraversals approx ofNEinunpert gameLeduc CFR CFR CFR EGTCFR CFR CFR NumberoftreetraversalsMaxinformationsetregretLeduc CFR CFR CFR EGTCFR CFR CFR NumberoftreetraversalsMaxinformationsetregretLeduc Regret Minimization in BehaviorallyConstrained ZeroSum Games

References
Jacob Abernethy  Peter   Bartlett  and Elad Hazan  Blackwell approachability and noregret learning are equivalent  In Conference on Learning Theory  COLT  pages
   

David Blackwell  An analog of the minmax theorem for
vector payoffs  Paci   Journal of Mathematics   
 

Michael Bowling  Neil Burch  Michael Johanson  and Oskari Tammelin  Headsup limit hold em poker is solved 
Science    January  

Noam Brown and Tuomas Sandholm  Regretbased pruning in extensiveform games  In Proceedings of the Annual Conference on Neural Information Processing Systems  NIPS   

Noam Brown and Tuomas Sandholm  Reduced space and
faster convergence in imperfectinformation games via
pruning  In International Conference on Machine Learning  ICML   

Noam Brown  Sam Ganzfried  and Tuomas Sandholm  Hierarchical abstraction  distributed equilibrium computation  and postprocessing  with application to   chamIn International
pion nolimit Texas Hold em agent 
Conference on Autonomous Agents and MultiAgent Systems  AAMAS   

Noam Brown  Christian Kroer  and Tuomas Sandholm  Dynamic thresholding and pruning for regret minimization 
In AAAI Conference on Arti cial Intelligence  AAAI 
 

Nicolo CesaBianchi and   abor Lugosi  Prediction  learn 

ing  and games  Cambridge university press   

Gabriele Farina and Nicola Gatti  Extensiveform perfect
equilibrium computation in twoplayer games  In AAAI
Conference on Arti cial Intelligence  AAAI   

Sam Ganzfried and Tuomas Sandholm  Game theorybased opponent modeling in large imperfectinformation
In International Conference on Autonomous
games 
Agents and MultiAgent Systems  AAMAS   

Geoffrey    Gordon  Amy Greenwald  and Casey Marks 
In International
Noregret learning in convex games 
Conference on Machine Learning  ICML  pages  
  ACM   

Geoffrey    Gordon  Noregret algorithms for online con 

vex programs  NIPS     

Samid Hoda  Andrew Gilpin  Javier Pe na  and Tuomas
Sandholm  Smoothing techniques for computing Nash
equilibria of sequential games  Mathematics of Operations Research     

Michael Johanson and Michael Bowling  Data biased robust counter strategies  In International Conference on
Arti cial Intelligence and Statistics  AISTATS   

Michael Johanson  Martin Zinkevich  and Michael Bowling  Computing robust counterstrategies  In Proceedings of the Annual Conference on Neural Information
Processing Systems  NIPS   

Daphne Koller  Nimrod Megiddo  and Bernhard von Stengel  Ef cient computation of equilibria for extensive
twoperson games  Games and Economic Behavior 
   

Christian Kroer and Tuomas Sandholm 

Imperfectrecall
abstractions with bounds in games  In Proceedings of the
ACM Conference on Economics and Computation  EC 
 

Christian Kroer  Kevin Waugh  Fatma     nc Karzan  and
Faster  rstorder methods for
Tuomas Sandholm 
In Proceedings of the
extensiveform game solving 
ACM Conference on Economics and Computation  EC 
 

Christian Kroer  Gabriele Farina  and Tuomas Sandholm  Smoothing method for approximate extensiveIn Proceedings of the Interform perfect equilibrium 
national Joint Conference on Arti cial Intelligence  IJCAI   

Christian Kroer  Kevin Waugh  Fatma KilincKarzan  and
Tuomas Sandholm  Theoretical and practical advances
on smoothing for extensiveform games  In Proceedings
of the ACM Conference on Economics and Computation
 EC   

Marc Lanctot  Kevin Waugh  Martin Zinkevich  and
Michael Bowling  Monte Carlo sampling for regret minimization in extensive games  In Proceedings of the Annual Conference on Neural Information Processing Systems  NIPS   

Marc Lanctot  Richard Gibson  Neil Burch  Martin Zinkevich  and Michael Bowling  Noregret
learning in
extensiveform games with imperfect recall  In International Conference on Machine Learning  ICML   

Sergiu Hart and Andreu MasColell    simple adaptive
procedure leading to correlated equilibrium  Econometrica     

Peter Bro Miltersen and Troels Bjerre   rensen  Computing   quasiperfect equilibrium of   twoplayer game 
Economic Theory     

Regret Minimization in BehaviorallyConstrained ZeroSum Games

Todd    Neller and Marc Lanctot  An introduction to counterfactual regret minimization  Tutorial    Available
from http modelai gettysburg edu cfr cfr pdf 

Yurii Nesterov  Excessive gap technique in nonsmooth convex minimization  SIAM Journal of Optimization   
 

Yurii Nesterov  Smooth minimization of nonsmooth func 

tions  Mathematical Programming     

   Romanovskii  Reduction of   game with complete mem 

ory to   matrix game  Soviet Mathematics     

Tuomas Sandholm  The state of solving large incompleteinformation games  and application to poker  AI Magazine    Special issue on Algorithmic Game Theory 

Reinhard Selten  Reexamination of the perfectness concept
for equilibrium points in extensive games  International
Journal of Game Theory   

Finnegan Southey  Michael Bowling  Bryce Larson 
Carmelo Piccione  Neil Burch  Darse Billings  and Chris
Rayner  Bayes  bluff  Opponent modelling in poker  In
Proceedings of the  st Annual Conference on Uncertainty in Arti cial Intelligence  UAI  July  

Oskari Tammelin  Neil Burch  Michael Johanson  and
Michael Bowling 
Solving headsup limit Texas
hold em  In Proceedings of the  th International Joint
Conference on Arti cial Intelligence  IJCAI   

Matus Telgarsky  Blackwell Approachability and Minimax

Theory  ArXiv eprints  October  

Eric van Damme    relation between perfect equilibria
in extensive form games and proper equilibria in normal form games  International Journal of Game Theory 
 

Bernhard von Stengel  Ef cient computation of behavior
strategies  Games and Economic Behavior     

Martin Zinkevich  Michael Bowling  Michael Johanson 
and Carmelo Piccione  Regret minimization in games
with incomplete information  In Proceedings of the Annual Conference on Neural Information Processing Systems  NIPS   

