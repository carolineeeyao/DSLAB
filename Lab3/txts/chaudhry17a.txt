Uncertainty Assessment and False Discovery Rate Control

in HighDimensional Granger Causal Inference

Aditya Chaudhry   Pan Xu   Quanquan Gu  

Abstract

Causal inference among highdimensional time
series data proves an important research problem
in many  elds  While in the classical regime one
often establishes causality among time series via
  concept known as  Granger causality  existing approaches for Granger causal inference in
highdimensional data lack the means to characterize the uncertainty associated with Granger
causality estimates       pvalues and con dence
intervals  We make two contributions in this
work  First  we introduce   novel asymptotically
unbiased Granger causality estimator with corresponding test statistics and con dence intervals to
allow  for the  rst time  uncertainty characterization in highdimensional Granger causal inference 
Second  we introduce   novel method for false discovery rate control that achieves higher power in
multiple testing than existing techniques and that
can cope with dependent test statistics and dependent observations  We corroborate our theoretical
results with experiments on both synthetic data
and realworld climatological data 

  Introduction
The advent of  big data  in recent years has generated countless opportunities for the prediction of real world phenomena with unprecedented accuracy and at unprecedented scale 
Statistical methods for prediction exploit associations in existing data to predict some response variable  However  the
task at hand is often not to predict the response variable from
preexisting data  but rather to determine how   change in
one or more of the explanatory variables will cause changes
in the response variable 

 Department of Mathematics  University of Virginia  Charlottesville  VA   USA  Department of Computer Science 
University of Virginia  Charlottesville  VA   USA  Correspondence to  Quanquan Gu  qg   virginia edu 

Proceedings of the   th International Conference on Machine
Learning  Sydney  Australia  PMLR     Copyright   by
the author   

In statistics  causality is often established by means of   controlled  randomized experiment  Nevertheless  controlled 
randomized experiments are often infeasible  leaving researchers with only access to observational data  This situation arises routinely when working with time series data 
Areas that must cope with this obstacle frequently include
genetics  Shojaie   Michailidis    and neuroscience
 Seth et al    The natural question that arises is  how
can one determine which factors cause changes in   certain response variable using only data in which all variables
change simultaneously  Causal inference seeks to address
this problem 
The classic method for causal inference among time series is   concept from econometrics known as Granger
causality  named after Nobel Prize winning econometrician
Clive Granger  Granger    Granger causality formalizes the intuitive notion that in   causal system  the cause
must precede the effect  and the cause must hold some
unique information that helps predict the effect  For example  let            XT and            YT be two stationary
onedimensional time series  We can model time series  
using the following autoregressive model  Stock   Watson 
 

Yt  

pXi 

aiYt        

 

where            ap are the coef cient parameters for the regression        is the maximal lag of the model  and    is
the error term  To determine whether or not   is   Granger
cause of     we also form   second autoregressive model 

Yt  

pXi 

biYt    

pXi 

ciXt        

 

with coef cient parameters            bp             cp  and error
term    
In this classical regime  where the number of
observations exceeds the number of variables             
one can    both of these models with ordinary least squares
 OLS  We can conduct an Ftest between models   and
  as well as hypothesis tests on coef cients ci         
   to determine if the extra information encompassed by
previous values of   signi cantly aides in the prediction of

Uncertainty Assessment and False Discovery Rate Control in HighDimensional Granger Causal Inference

future values of     If this pair of models passes the Ftest
and at least one of the coef cient hypothesis tests at some
signi cance level   then we may reject the null hypothesis
that   is not   Granger cause of    Granger   
Although the concept of Granger causality has existed for
decades  Granger   only rigorously treated the bivariate case  However  as noted by Arnold et al    Eichler
  provided one framework for multivariate analysis by
applying graphical models to Granger causal inference 
Multivariate Granger causal inference relies on hypothesis
testing of model coef cients in    tted vectorautoregressive
 VAR  model  Lutkepohl    VAR models are    with
OLS  In the highdimensional regime  where the number of
parameters exceeds the number of observations         pd 
where   is the number of time series in the VAR model 
OLS estimation is impossible  Hence  one must employ
regularized regression methods  Perhaps the most wellknown such method is the Lasso  Tibshirani    which
encourages sparsity in the coef cient parameter vector via
an   penalty  To conduct Granger causal inference in the
highdimensional regime  Arnold et al    proposed the
 Lasso Granger  estimator  which we fully specify in  
Unfortunately  since the limiting distribution of the underlying Lasso estimator is not normal  Knight   Fu    and
intractable in general  Javanmard   Montanari    one
cannot construct con dence intervals or compute test statistics for hypothesis tests of Lasso Granger coef cient point
estimates  Thus  existing methods for highdimensional
Granger causal inference do not allow for the assessment
of uncertainty  Uncertainty characterization proves an important  and often necessary  element of research in the
natural sciences  Therefore  uncertainty assessment techniques would augment the versatility of highdimensional
Granger causal inference methods  and drive their wider
adoption by the scienti   community 
Another issue in highdimensional causal inference is how
to limit the number of false positives generated when testing
  large number of explanatory variables without sacri cing
identi cation of the true causal effects  That is  the researcher wants to attain high power while still maintaining  
low type   error rate  To this end  false discovery rate  FDR 
control  Benjamini   Hochberg    proves an important
part of any method for highdimensional causal inference 
Unfortunately  existing FDR control methods cannot cope
with the two challenges posed by our setting  dependent test
statistics and dependent observations  These methods thus
prove unsuitable in many practical applications 
In this paper  we make two contributions  First  we propose   novel asymptotically unbiased estimator for highdimensional Granger causal inference inspired by Javanmard   Montanari   We leverage this estimator  
unbiasedness to construct con dence intervals and pvalues

for coef cient point estimates  In this way  we allow  for the
 rst time  uncertainty characterization in highdimensional
Granger causal inference  Second  we propose   novel FDR
control technique that can cope with dependent teststatistics
and dependent observations  In addition to surmounting
these theoretical obstacles to existing methods  our FDR
control technique also achieves higher power in multiple
testing than existing methods  Additionally  the proof techniques we use to extend highdimensional results from the
independent and identically distributed         setting to our
time series setting are of independent interest  Speci cally 
to establish the asymptotic unbiasedness and normality of
our estimator  we appeal to Talagrand   generic chaining
 Talagrand    and martingale theory  We further employ
martingale theory  along with empirical process theory  to
prove the asymptotic validity of our FDR control procedure 
The rest of this paper is organized as follows  Section  
contextualizes our contributions in the existing literature 
Section   sets up the problem of highdimensional Granger
causal inference  Section   presents our novel debiased estimator and FDR control procedure  Section   establishes our
main theoretical results  which we corroborate empirically
in Section   Section   concludes the paper 

  Related Work
As mentioned above  Clive Granger examined bivariate
Granger causality in    Granger    Advances in
the area of graphical models provided   strong framework
for multivariate causal inference in general  Pearl   
Graphical models were  rst applied speci cally to Granger
causal inference by Eichler   and Eichler   and
have provided   foundation for more complex models 
However  these methods rely on OLS estimation  which is
impossible in the highdimensional regime  Meinshausen  
  uhlmann   applied Lasso to the estimation of highdimensional graphical models  Arnold et al    then
applied the method proposed by Meinshausen     uhlmann
  to multivariate Granger causal inference  and introduced the estimator of primary interest for this work  the
Lasso Granger estimator  The Lasso Granger estimator
yields   coef cient vector in which nonzero coef cients
indicate conditional Granger causes of the response variable 
Classical methods for uncertainty analysis prove impossible
for the Lasso Granger estimator  Recent work  Lee et al 
  Lockhart et al    Taylor et al    in the area
of highdimensional inference has made great strides toward
addressing this issue  Early work focussed on constructing pvalues and con dence intervals for Lasso coef cients via the
bootstrap  Chatterjee et al    Liu et al      However  later work found that these methods perform poorly
compared to more recent methods  Dezeure et al   
especially in noni      settings  Karoui   Purdom   

Uncertainty Assessment and False Discovery Rate Control in HighDimensional Granger Causal Inference

Perhaps the most promising work in highdimensional inference has emerged from the perspective of bias correction
   uhlmann et al    Zhang   Zhang    Subsequent work by Van de Geer et al    and Javanmard
  Montanari   introduced   method to debias the
Lasso solution to yield asymptotically valid con dence intervals and hypothesis tests for coef cient point estimates 
Nevertheless  these existing methods assume that the observations forming the design matrix are independent  and
so cannot tackle causal inference among time series  Our
method applies the Lasso debiasing technique to the original Lasso Granger estimator  We overcome the inability
of existing methods to cope with noni      data by using
Talagrand   generic chaining  Talagrand    and the martingale technique to derive the asymptotic distribution of
our novel debiased Lasso Granger estimator 
Hypothesis testing in the highdimensional setting raises the
need for procedures to address the multiple testing problem 
FDR control is one such way to control type   error in multiple testing  Our setting poses two challenges to existing
FDR control procedures  First  the mostwidely used methods  such as the BenjaminiHochberg procedure  Benjamini
  Hochberg    assume the test statistics under consideration are independent  While Benjamini   Yekutieli  
proposed   slight variation on the BenjaminiHochberg procedure that could control FDR under  positive regression
dependency        when the covariance matrix of the explanatory variables is strictly positive  in our setting where
the explanatory variables interact in complex ways  the test
statistics will not satisfy this property  This version of the
BenjaminiHochberg procedure achieves only low power
in the presence of   general dependence structure  Romano
et al    and is thus unsuitable for our setting  Recent
methods from the area of graphical models  which explicitly model the dependency of explanatory variables  have
made progress in addressing the case of dependent test statistics  Xie et al    Liu et al      However  these
methods still encounter the second challenge of our setting 
dependent observations arising from time series data  To
control FDR for dependent observations  one must resort to
assumptionfree methods  such as the Bonferroni technique 
that achieve low power in practice  We propose   FDR control procedure that can cope with dependent test statistics
and observations  and that achieves high power 
Notation We denote matrix      Ai      Rm   and column vector      vi    RT   We write the    norm of vector
  as kvkp       
    vi    Furthermore  kvk  denotes the
maxnorm of vector    kvk    max      vi  Additionally  kvk    supp    designates the cardinality of the
support  the set of all nonzero entries  of    We represent
the the maxnorm of matrix   as kAk    maxi    Ai   
The minimum and maximum singular values of   are denoted by  min    and  max    respectively       

 

      

    dt refers to the cumulative distribution function of the standard normal distribution  For  
random variable   and   sequence of random variables
     if Xn converges in probability
Xn  we write Xn
     if Xn converges in distribution to
to    and Xn
   For sequences of random variables Xn and Yn  we say
Xn   Yn if Xn has the  same asymptotic order  as Yn  that
is  if both sequences bound each other up to some universal
multiplicative constant 
  Granger Causality and its Estimator
In this section  we set up the problem of high dimensional
Granger causal inference  Denote the design matrix    the
number of parameters    the number of observations    
and the maximal lag    For   given design matrix    

 Xt      RT   de ne the sample covariance matrix     
        Rd    The jth column of   represents time
series Xj             We can further denote lagged
versions of each column in the design matrix withfXt    
 Xt      Xt              Xt      Rp  Note that Xt  
represents the observation immediately before Xt   in time
series Xj  In Granger causal analysis  the response variable
is one of the explanatory variables  Hence  we can model an
arbitrary variable Xt    with           and                
by using the lagged values of all explanatory variables as
predictors 

Xt    

dXi 

     fXt          

 

     

              

  the Lasso Granger estimator  Arnold et al    is
given by

Here        Rp and             
    Time series Xi
is   conditional Granger cause of time series Xj  conditioned on the other       time series  if     
contains
any nonzero elements                    We can vecand all fXt    for           
torize the sets of all     
    Rpd and fXt  
as          
 fX   fX           fX        Rpd  respectively  Based on
      arg min
 Xt        fXt       jk 
Equivalently  letting eX    fXp fXp         fXT    
      pd and Yj   Xp     represent the lower      
elements of the jth column of     we can reexpress our
model in more standard notation as 

where       is the regularization parameter 

TXt   

       

 

  

 
where                     We can now reexpress

Yj   eX       

Uncertainty Assessment and False Discovery Rate Control in HighDimensional Granger Causal Inference

the Lasso Granger estimator as 

 

  

 

       jk 

For ease of presentation  we will henceforth omit the identi 

       kYj   eX jk 

      arg min
fying variable   from          and Yj  and assume we are
matrix of eX as       eX eX          Rpd pd and the
true covariance matrix as            

referring to some arbitrary response variable  Using the
above notation  we can now denote the sample covariance

  Asymptotic Inference for Lasso Granger
In this section  we introduce our debiased Lasso Granger
estimator  and construct con dence intervals and pvalues
for its elements  We will then present our method for false
discovery rate control in multiple testing 
  Con dence Intervals and Hypothesis Tests
In deriving   debiased version of the Lasso Granger estimator  we employ   variation of the Lasso debiasing procedure
proposed by Javanmard   Montanari   In particu 

lar  we de ne the debiased Lasso Granger estimatorb   as

follows 

          

 

     

MeX     eXb 

 

 

following optimization algorithm 

whereb    Rpd is the parameter vector yielded when computing the Lasso Granger estimator   for an arbitrary
response variable     Yj                     mpd   
Rpd pd is an estimate of   
    the inverse sample covariance matrix of eX  where each mi is the solution to the
minimize     nm subject to ke nm   eik     
where ei   Rpd is the ith column of Ipd pd  and the choice
of   will be clear after we deliver theory  Our unbiased estimator      though inspired by Javanmard   Montanari
matrix eX  Although in our time series setting the rows
  to eX exacerbates this dependency and renders the       
theoretical results aboutb   
Theorem   in Section   below proves that for any    
            pd  the standardized estimate of the ith element

results underpinning Javanmard and Montanari   work unusable  Hence  we appeal to Talagrand   generic chaining
 Talagrand    and martingale theory to establish our

  diverges sharply from their work in several respects 
While Javanmard and Montanari use the observed design
matrix   in their estimator  we use the transformed design

of design matrix   are already dependent  transforming

ofb   converges in distribution to the standard normal distri 

bution 

        

 

pT    

   
      
 Me nM 

   

Unfortunately  the true noise level  denoted here by   is
unknown in most realworld applications  Hence  we re 

 

the Scaled Lasso  Sun   Zhang   

place   with   consistent estimator  denotedb  yielded by
       
       
 Rpd 

 
where   is the regularization parameter  Sun   Zhang  

        kY   eX   

argmin

   

 
 

our setting as well  Then by the Slutsky Theorem  Van der

loss function is convex  Sun   Zhang   use the      
assumption to establish convexity  In our noni      setting 
we establish convexity via   restricted eigenvalue condition

proveb  is   consistent estimator of   when the penalized
for martingale difference sequences  Thus    is consistent in
Vaart    we can replace   in   withb 

One can easily apply   to construct con dence intervals
for      for         pd  If the signi cance level is      
the       con dence interval for    is 

 

where

            

               

Ii       
                  pT     Me nM 

     
We prove the asymptotic validity of this con dence interval
in Corollary  
Similarly  we can also conduct hypothesis tests on the individual regression coef cients      for         pd  In the
context of Granger causality  the relevant null and alternative
           respectively 
hypotheses are    
Having zerocoef cients for all variables            px
implies that time series           is not   conditional
Granger cause of the response time series  Conversely  re 
  for any variable               px amounts
jecting    
to rejecting the null hypothesis that time series   is not  
Granger cause of the response time series  We thus consider
the following test statistic for    

           and    

          

 

cZi  

  pT    
   
  Me nM 
Note that under the null hypothesiscZi
       cZi      

   

         by  
The hypothesis test at signi cance level   is thus given by

 

 

Uncertainty Assessment and False Discovery Rate Control in HighDimensional Granger Causal Inference

where    is the quantile of the standard normal distribution such that         We reject the null hypothesis
if and only if         The pvalue for this hypothesis
test is

 

Pi        cZi 

As usual  one would reject    
  at   prespeci ed signi cance
level   if Pi     We establish that the type   error of the hypothesis test     converges to the speci ed signi cance
level  and that the pvalue Pi is asymptotically uniformly
distributed in Corollary  
  False Discovery Rate Control
Having established test statistics for individual coef cients
of the debiased Lasso Granger estimator  we now address
the issue of FDR control  First  denote the set of coef cient
indices   such that        as                       pd 
De ne the complement of this set as                  
    pd  We de ne FDR and false discovery proportion
 FDP  as follows 

FDP   

Pi   
max     pd

 cZi     
 cZi       

 

FDR      FDP 

When conducting hypothesis tests at signi cance        
  we seek the smallest   such that FDR      In this
way  we will be able to reject the null hypothesis as often as
possible       we maximize power  while still guaranteeing
that our type   error rate does not exceed   Thus  the ideal
choice of   is

 

Note that the left hand side of the inequality in   is

Pi   
max     pd

 cZj           
     inf       
 cZi     
FDP  whose expectation is FDR  Unfortunately    cannot be
computed under the unknown     Liu et al      However  following Liu   Luo   we use the asymptotic
normality ofcZi under the null hypothesis to approximate
Pi   
 cZi      by    pd  In multiple hypothesis testing  we use     as the threshold for rejecting the null

hypothesis  instead of    in hypothesis test      
Theorem   below demonstrates the asymptotic validity of
this FDR control method 
  Main Theory
In this section we present our main theoretical results  the

test statisticcZi from   converges in distribution to the

standard normal under the null hypothesis  and the FDR
control procedure presented in   asymptotically controls
both FDR and FDP  To begin  we present several de nitions 

De nition    Vershynin      random variable   is
subGaussian if there exists   constant       such that

              exp     

for all      
  random vector     Rn is subGaussian if the onedimensional marginals          are subGaussian random
variables for all     Rn 
De nition    Javanmard   Montanari    The subGaussian norm of   random scalar variable   is 

kXk     sup
  

          

The subGaussian norm of   random vector     Rn is 

kXk     sup

  Sn  khX  uik  
where Sn  is the unit sphere in Rn space 

exist

Having established these de nitions  we impose two assumptions on the design matrix and the true covariance
matrix of the design matrix 
Assumption
  There

constants

universal

at multiple stages of the proof of Theorem   including

We use Assumption   to demonstrate that the restricted

subGaussian norm of each row is bounded by some con 

Cmin  Cmax such that     Cmin    min     
 max      Cmax 
Assumption   The rows of eX are subGaussian and the
stant   so that kfXik       for                       
eigenvalue condition holds for     in order to prove the
asymptotic unbiasedness ofb    Assumption   plays   role
proving the restricted eigenvalue condition for     and es 

tablishing   highprobability bound for the regularization
parameter   Both of these assumptions prove common in
the highdimensional inference literature 
We leverage Assumptions   and   to present the following theorem 
Theorem   Suppose Assumptions   and   are satis ed  Let      supp    pT      log pd  and
   plog pd        Then for any elementb  
  of the
debiased Lasso Granger estimatorb   de ned in   we

have

pT    

   
      
 Me nM 

   

        

Theorem   immediately yields several useful results  We
 rst demonstrate the asymptotic validity of con dence inter 

val   for any element ofb   in the following corollary 

Uncertainty Assessment and False Discovery Rate Control in HighDimensional Granger Causal Inference

Corollary   Denote signi cance level       and
for         pd  de ne interval Ii       
         
     
             Here                
 pT     Me nM 
      Ii         

      Then

lim

    

By Corollary   the asymptotic coverage probability corresponds the the given con dence level  Note that we can

replace   withb  by the Slutsky Theorem  Similarly  we

con rm in the following corollary that the type   error for hypothesis test     introduced in   matches the given
signi cance level   Furthermore  we prove that the CDF
of the pvalue Pi for     which we introduced in  
converges in distribution to   uniform distribution 
Corollary   With     and Pi de ned as above  and
signi cance level       we have 

     
    and Pi

        
            
 
We now turn our attention to demonstrating the asymptotic
validity of the FDR control method we present in Section
  To control FDR we desire the following property 

Pi   
 cZi     
         

    

 

Unfortunately  in this application  the test statisticscZi are

correlated  rendering the convergence in   nontrivial 
In order to prove   we will leverage martingale theory 
empirical process theory  and the following assumption 
Assumption   For constant      

   

Xi   

     log pd 

           

      
   
as         pd     
Assumption   implies that the number of true alternative
hypotheses approaches in nity  This property proves important because  as demonstrated by Liu et al    FDR
control is impossible when the number of true alternative
hypotheses is  xed  This assumption allows us to present
the following theorem 
Theorem   Assume pd            and log pd   
  pT      for some       Furthermore  suppose that
Assumption   and the assumptions of Theorem   hold 
Then at signi cance level  

lim

     pd 

FDR   

   pd 

    and

FDP   

   pd 

    

as         pd     

Theorem   establishes that the FDR control procedure we
present in Section   asymptotically controls both FDR
and FDP  Note that the upper bound rate imposed on pd is
very mild and will pose no issues in the vast majority of
applications  The assumptions of Theorem   guarantee

the asymptotic normality of test statisticcZi 

  Numerical Experiments
In this section  we establish the effectiveness of our debiased Lasso Granger estimator and our FDR control procedure via experimental results  We also demonstrate that our
methods outperform existing techniques 

  Synthetic Data
Table   Empirical type   errors when testing            
over   simulations for       for  random  and  cluster 
transition matrix patterns 
 

Random

Cluster

 

 

 
 
 
 

 
 
 
 

 
 
 
 

 
 
 
 

 
 
 
 

In this section  we corroborate our theoretical results and
compare our contributions to existing methods with numerical experiments on synthetic data  The data for these experiments are generated by model   In order to satisfy
the assumptions of Theorem   each     is   sparse vector
such that the probability of each element being nonzero
is pT     pd log pd  for            We use the  

package are   Li et al    to generate sparse transition
matrices  and the  glmnet  package  Friedman et al   
to compute the biased Lasso Granger estimate  We examine
multiple different transition matrix patterns  random  and
 cluster  as generated by the  are  package  and multiple
different con gurations of          
In Table   we see that the empirical type   error of hypothesis test       corresponds to the given signi cance
level across multiple con gurations of           Figure
    corroborates Theorem   by demonstrating that the

empirical distribution of test statisticcZi under the null hy 

pothesis is the standard normal distribution  Figure    
also illustrates that coef cient point estimates for the biased
Lasso Granger estimator do not follow the standard normal
distribution  Figure     validates Corollary   by demonstrating that the empirical CDF of pvalue   for   true
zero parameter is the uniform distribution  Furthermore 
Figures     and     exhibit that hypothesis test    
  attains higher power than the biased Lasso Granger estimator when testing   single true nonzero parameter  Table
  demonstrates the accuracy of the debiased Lasso Granger
estimator via computations of the   and   norms of the

Uncertainty Assessment and False Discovery Rate Control in HighDimensional Granger Causal Inference

 

 

 

 
 

 

 
 

 
 

 
 
 
 
 
 

 

 
 

 
 
 
 
 

 
 

 

 
 
 

 
 
 

 

 
 
 
 
 
 
 
 
 

 

 

 

 

 

 
 
 
 

 

 
 

 

 
 

 

 
 

 

 
 

 

 
 

 

 
 

 

 

 
 
 
 
 

 
 

 

 
 

 

 
 

 

 
 

 

 
 

 

 
 

 

 

 

 

 

 

 

 

    Pvalue CDF

De biased LG
Biased LG

 

 

 

 
Value of Non Zero Coefficient
         

 
 
 
 
 

 
 

 

 
 

 

 
 

 

 
 

 

 
 

 

 
 

 

 

De biased LG
Biased LG

 

 

 

 
Value of Non Zero Coefficient
         

       

 

 

 

De biased LG
Biased LG

 
 

 

 
 
 

 

 
 

 

 

 

 

 

 

 

 

 

Quantiles of Standard Normal Distribution

    QQ Plot

Figure       compares the QQ plots for test statisticcZi and the biased Lasso Granger coef cient point estimateb       
exhibits an empirical CDF of pvalues forcZi  The QQ plots and CDF were computed over   realizations of con guration

                   for   true zero parameter      and     compare the power curves for testing    
           under
the biased Lasso Granger  LG  estimator and under hypothesis test       for our debiased Lasso Granger estimator
across   simulations for two con gurations of           These simulations all use the  random  transition matrix pattern 
Table   Point estimation performance over   simulations for  random  and  cluster  transition matrix patterns  The
standard deviations are displayed in parentheses 

 

 
 

 

 
 

 

 
 

Random

Cluster

  

  

  

  

 
 

 
 

 
 

 
 

error vector betweenb   and  

Table   exhibits that  as suggested by theory  our FDR control procedure outperforms the Bonferroni and BenjaminiHochberg  BH   Benjamini   Hochberg    Benjamini
  Yekutieli    methods in terms of power  while still
maintaining low FDP  While the Bonferroni method generally achieves only low power  the BenjaminiHochberg
method performs poorly in this application because the test
statistics exhibit complex dependency  and thus violate  
theoretical assumption of the BenjaminiHochberg method 
Lastly  Figure   demonstrates that our debiased Lasso
Granger estimator paired with our FDR control procedure outperform the original biased Lasso Granger estimator in terms of precision and recall  De ne sets
TP              identi ed as nonzero  and FP  
           identi ed as nonzero  so precision is
 TP  max TP     FP    and recall is  TP    Note
that precision is equivalent to     FDP and recall is equivalent to power  We calculate precision and recall at each point
along the Lassopath of the regularization parameter to generate the curves in Figure   These curves demonstrate that
our debiased Lasso Granger estimator and FDR control procedure achieve higher recall than the original Lasso Granger
estimator without sacri cing precision  Thus  not only does
our method provide the interpretability and  exibility of
uncertainty characterization  it also achieves higher power

 

 

 
 
 
 
 
 
 

 
 
 

 
 
 

 
 
 

 
 
 

 
 
 

 
 
 

De biased LG
Biased LG

 

 

 
 
 
 
 
 
 

 
 
 

 
 
 

 
 
 

 
 
 

 
 
 

 
 
 

De biased LG
Biased LG

 

 

 

 

 

 

 

 

 

 

 

 

Recall

         

Recall

         

Figure   Precisionrecall curves for our debiased Lasso
Granger  LG  estimator with our FDR control procedure at
      versus the original biased Lasso Granger estimator
over   realizations of the noted con guration          

than the original Lasso Granger estimator while maintaining
low FDP  Therefore  our method proves more suitable for
highdimensional Granger causal inference 
  Real Data
To demonstrate the applicability of our method to realworld
data  we consider the climatological data set made available
by Lozano et al    This data set contains monthly observations for seventeen climatological variables       temperature  precipitation  CO  CH  etc  for   grid points
spanning the continental United States  latitudes   to
  and longitudes   to   from   to

Uncertainty Assessment and False Discovery Rate Control in HighDimensional Granger Causal Inference

Table   Empirical FDP and power values for the indicated methods for       over   simulations for the  random  and
 cluster  transition matrix patterns 

 

 
 
 
 

 

 
 
 
 

 

 
 
 
 

FDR Control

BH

Bonferroni

Transition Matrix Pattern

FDP

Power

FDP

Power

FDP

Power

Random
Random
Cluster
Cluster

 
 
 
 

 
 
 
 

 
 
 

 

 
 
 
 

 
 
 
 

 
 
 
 

  Following the setup from Lozano et al    we
enforce stationarity by deseasonlaizing the data using the
  package  deseasonalize   McLeod   Gweon    We
model the monthly temperature change of each grid point as
  linear model of the  rst three lagged values of all explanatory variables in the surrounding       grid  Thus  for each
of the   interior grid points  we obtain design matricies
with dimensions                 years of monthly
data                  climatological variables observed at   grid points  and       For each of these design
matricies  we use the   package  glmnet Friedman et al 
  to produce the biased Lasso Granger estimate from
  and then apply   to construct the debiased Lasso
Granger estimate 
For each grid point  we test the signi cance of the three
lagged values of monthly changes in Carbon Dioxide  CO 
emissions for that grid point to determine if local CO  emissions are   Granger cause of temperature changes when
conditioned on many other climatological variables  Recall that an explanatory variable is   Granger cause of the
response variable if and only if any of the coef cients for
any of the lags prove signi cant  We use the Bonferroni
method  the BenjaminiHochberg  BH  procedure  and our
FDR control method from Section   to control for multiple
testing  At signi cance level       the Bonferroni and
BenjaminiHochberg methods found that CO  emissions
are   Granger cause of monthly temperature changes for
  of the   grid points  whereas our FDR control method
discovered   such grid points  We thus corroborate the
 ndings of Lozano et al    who employed graphical
Granger modeling methods to establish Granger causality
between CO  emissions and temperature changes  and those
of many climate researchers who have found increased CO 
emissions to  cause  higher temperatures  We also  nd
empirical evidence that our FDR control method achieves
higher power than the Bonferroni and BenjaminiHochberg
methods  Figure   displays the results of this simulation 
  Conclusion
In this paper  we propose   novel unbiased estimator for conducting Granger causal inference in the highdimensional

    Bonferroni  BH

    FDR Control

    PValues

Figure   Maps of all interior grid points  Grid points where
local CO  emissions register as   Granger cause of temperature changes appear in red in     and     Test statistic critical values are chosen via the method indicated in captions
of these two maps      displays pvalues for the coef cients
corresponding to CO  emissions in the regression for each
grid point 

regime  We introduce test statistics and con dence intervals for our estimator  thereby accomplishing the previously impossible task of uncertainty characterization in
highdimensional Granger causal inference  Additionally 
we introduce   novel method for false discovery rate control
that achieves higherpower in multiple testing than existing
alternatives in our setting  Lastly  we validate our theoretical results with experiments on both synthetic data and
realworld climatological data  Future extensions of our
work may include generalizations of our method to cope
with nonGaussian noise and nonlinear causality 
Acknowledgements
We would like to thank the anonymous reviewers for their
helpful comments  This research was sponsored in part
by the National Science Foundation IIS  and IIS 
  The views and conclusions contained in this paper
are those of the authors and should not be interpreted as
representing any funding agencies 

Uncertainty Assessment and False Discovery Rate Control in HighDimensional Granger Causal Inference

References
Arnold  Andrew  Liu  Yan  and Abe  Naoki  Temporal causal
modeling with graphical granger methods  In Proceedings of the  th ACM SIGKDD international conference
on Knowledge discovery and data mining  pp   
ACM   

Benjamini  Yoav and Hochberg  Yosef  Controlling the
false discovery rate    practical and powerful approach to
multiple testing  Journal of the Royal Statistical Society 
Series    Methodological  pp     

Benjamini  Yoav and Yekutieli  Daniel  The control of the
false discovery rate in multiple testing under dependency 
Annals of statistics  pp     

  uhlmann  Peter et al  Statistical signi cance in highdimensional linear models  Bernoulli   
 

Chandrasekaran  Venkat  Recht  Benjamin  Parrilo  Pablo   
and Willsky  Alan    The convex geometry of linear
inverse problems  Foundations of Computational mathematics     

Chatterjee     Lahiri  SN  et al  Rates of convergence of the
adaptive lasso estimators to the oracle distribution and
higher order re nements by the bootstrap  The Annals of
Statistics     

Dezeure  Ruben    uhlmann  Peter  Meier  Lukas  Meinshausen  Nicolai  et al  Highdimensional inference  Con 
 dence intervals  pvalues and rsoftware hdi  Statistical
Science     

Eichler  Michael  Graphical modelling of multivariate time

series   

Eichler  Michael  Graphical modeling of multivariate time

series with latent variables   

Friedman  Jerome  Hastie  Trevor  Simon  Noah  Tibshirani 
Rob  Hastie  Maintainer Trevor  and Matrix  Depends 
Package  glmnet  Journal of Statistical Software   
 

Gordon  Yehoram  On milman   inequality and random
subspaces which escape through   mesh inn  In Geometric Aspects of Functional Analysis  pp    Springer
Berlin Heidelberg   

Granger  Clive WJ  Investigating causal relations by econometric models and crossspectral methods  Econometrica 
Journal of the Econometric Society  pp     

Hall  Philip and Heyde  Christopher Charles  Martingale
limit theory and its application  Probability and mathematical statistics     series of monographs and textbooks 

Academic Press  Boston  San Diego  New York   
ISBN   URL http opac inria 
fr record   

Javanmard  Adel and Montanari  Andrea  Con dence intervals and hypothesis testing for highdimensional regression  The Journal of Machine Learning Research   
   

Johnson  Nicholas  Sivakumar  Vidyashankar  and Banerjee 
Arindam  Structured stochastic linear bandits  arXiv
preprint arXiv   

Karoui  Noureddine El and Purdom  Elizabeth  Can we
trust the bootstrap in highdimension  arXiv preprint
arXiv   

Knight  Keith and Fu  Wenjiang  Asymptotics for lassotype

estimators  Annals of statistics  pp     

Lee  Jason    Sun  Dennis    Sun  Yuekai  and Taylor 
Jonathan    Exact postselection inference with the lasso 
arXiv preprint arXiv   

Li  Xingguo  Zhao  Tuo  Yuan  Xiaoming  and Liu  Han  An
  package  are for high dimensional linear regression and
precision matrix estimation    Package Vigette   

Liu  Hanzhong  Yu  Bin  et al  Asymptotic properties of
lasso  mls and lasso  ridge in sparse highdimensional
linear regression  Electronic Journal of Statistics   
     

Liu  Weidong and Luo  Shan  Hypothesis testing for high 

dimensional regression models   

Liu  Weidong  Shao  QiMan  et al  Phase transition and
regularized bootstrap in largescale ttests with false discovery rate control  The Annals of Statistics   
   

Liu  Weidong et al  Gaussian graphical model estimation
with false discovery rate control  The Annals of Statistics 
     

Lockhart  Richard  Taylor  Jonathan  Tibshirani  Ryan   
and Tibshirani  Robert    signi cance test for the lasso 
Annals of statistics     

Lozano  Aurelie    Li  Hongfei  NiculescuMizil  Alexandru  Liu  Yan  Perlich  Claudia  Hosking  Jonathan  and
Abe  Naoki  Spatialtemporal causal modeling for climate change attribution  In Proceedings of the  th ACM
SIGKDD international conference on Knowledge discovery and data mining  pp    ACM   

Lutkepohl  Helmut  New Introduction to Multiple Time

Series Analysis  Springer    ISBN  

Uncertainty Assessment and False Discovery Rate Control in HighDimensional Granger Causal Inference

McLeod        and Gweon  Hyukjun  Optimal deseasonalization for monthly and daily geophysical time series 
Journal of Environmental Statistics      URL
http www jenvstat org     

Van de Geer  Sara    uhlmann  Peter  Ritov  Ya acov 
Dezeure  Ruben  et al  On asymptotically optimal con 
 dence regions and tests for highdimensional models 
The Annals of Statistics     

Van der Vaart  Aad    Asymptotic statistics  volume  

Cambridge university press   

Vershynin     Introduction to the nonasymptotic analysis
of random matrices 
In Eldar       and Kutyniok    
 eds  Compressed Sensing  Theory and Applications 
pp    Cambridge University Press   

Xie  Jichun  Cai    Tony  Maris  John  and Li  Hongzhe 
Optimal false discovery rate control for dependent data 
Statistics and its interface     

Zaitsev    Yu  On the gaussian approximation of convolutions under multidimensional analogues of sn bernstein  
inequality conditions  Probability theory and related
 elds     

Zhang  CunHui and Zhang  Stephanie    Con dence intervals for low dimensional parameters in high dimensional
linear models  Journal of the Royal Statistical Society 
Series       

Meinshausen  Nicolai and   uhlmann  Peter 

Highdimensional graphs and variable selection with the lasso 
The Annals of Statistics  pp     

Mendelson  Shahar  Pajor  Alain  and TomczakJaegermann 
Nicole  Reconstruction and subgaussian operators in
asymptotic geometric analysis  Geometric and Functional Analysis     

Negahban  Sahand    Ravikumar  Pradeep  Wainwright 
Martin    and Yu  Bin    uni ed framework for highdimensional analysis of mestimators with decomposable
regularizers  Statistical Science       
doi   STS 

Pearl  Judea  Causality  Cambridge university press   

Romano  Joseph    Shaikh  Azeem    and Wolf  Michael 
Control of the false discovery rate under dependence
using the bootstrap and subsampling  Test   
   

Seth  Anil    Barrett  Adam    and Barnett  Lionel  Granger
causality analysis in neuroscience and neuroimaging  The
Journal of Neuroscience     

Shojaie  Ali and Michailidis  George  Discovering graphical granger causality using the truncating lasso penalty 
Bioinformatics         

Stock  James and Watson  Mark  Introduction to Econometrics  rd edition  Addison Wesley Longman   
Professor Stock receives royalties for this text 

Sun  Tingni and Zhang  CunHui  Scaled sparse linear

regression  Biometrika  pp  ass   

Talagrand  Michel  The generic chaining  upper and lower
bounds of stochastic processes  Springer Science   Business Media   

Talagrand  Michel  Upper and lower bounds for stochastic processes  modern methods and classical problems 
volume   Springer Science   Business Media   

Taylor  Jonathan  Lockhart  Richard  Tibshirani  Ryan    and
Tibshirani  Robert  Postselection adaptive inference for
least angle regression and the lasso  arXiv preprint   

Tibshirani  Robert  Regression shrinkage and selection via
the lasso  Journal of the Royal Statistical Society  Series
   Methodological  pp     

