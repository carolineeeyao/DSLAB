Differentially Private Chisquared Test by Unit Circle Mechanism

Kazuya Kakizaki   Kazuto Fukuchi   Jun Sakuma      

Abstract

This paper develops differentially private mechanisms for   test of independence  While existing works put their effort into properly controlling the typeI error  in addition to that  we investigate the typeII error of differentially private
mechanisms  Based on the analysis  we present
unit circle mechanism    novel differentially private mechanism based on the geometrical property of the test statistics  Compared to existing
output perturbation mechanisms  our mechanism
improves the dominated term of the typeII er 

ror from    to   exp     where   is the

sample size  Furthermore  we introduce novel
procedures for multiple   tests by incorporating the unit circle mechanism into the sparse vector technique and the exponential mechanism 
These procedures can control the familywise error rate  FWER  properly  which has never been
attained by existing mechanisms 

  Introduction
Hypothesis testing is   statistical framework to ascertain
whether or not given samples follow   speci   model or
not in   systematic manner  For this study  we presume that
highly sensitive information might be included in the samples    typical situation is genomewide association studies  GWAS  Homer et al  reported that   patient   disease
status could be inferred from aggregate statistics collected
for GWAS  Homer et al   
Differential privacy  Dwork et al    is   recent notion
of privacy that is tailored to   privacypreserving release
of aggregate statistics  As described in this paper  we give
speci   consideration to the differential privacy of   test
 Department of Computer Science  University of Tsukuba 
Japan  JST CREST
  Tennohdai  Tsukuba 
 RIKEN Center for Advanced Intelligence Project  Correspondence to  Kazuya Kakizaki  kazuya mdl cs tsukuba ac jp 
Kazuto Fukuchi  kazuto mdl cs tsukuba ac jp  Jun Sakuma
 jun cs tsukuba ac jp 

Ibaraki 

Proceedings of the   th International Conference on Machine
Learning  Sydney  Australia  PMLR     Copyright  
by the author   

of independence  Two lines of studies exist in differentially
private  tests of independence 
input perturbation and
output perturbation  The input perturbation method ensures
differential privacy by randomizing each count in the contingency table  Uhler et al    Johnson   Shmatikov 
  Wang et al    Gaboardi et al    The output
perturbation method randomizes the test statistic to satisfy
differential privacy  Fienberg et al    Yu et al   
Uhler et al    Wang et al    Also recently  there
is   study for the differential privacy of   test of identity 
which ensures typeI and typII error  Cai et al   
The contribution of this study is threefold  First  we analyze the typeII error of the differentially private mechanism for output perturbation 
In principle   nonprivacy 
preserving  hypothesis test procedures are preferred to
achieve   greater power with keeping the signi cance at
  prescribed level 
In the case of differentially private
hypothesis test  the same is required under the constraint
of differential privacy  Much efforts have been devoted
to controlling the signi cance level properly  Wang et al 
  Gaboardi et al    whereas little attention has
been paid to the power analysis  We analyze the typeII
error of the differentially private mechanism for  test 
and show that it is upperbounded by two terms which are
mechanismdependent  The bound indicates that   mechanism with   lower sensitivity and lower   error  de ned in
Section   achieves   greater power 
Second  we investigate the geometrical property of the test
statistic of the  test  Then  we propose the unit circle
mechanism    novel differentially private mechanism based
on the geometrical property  In existing mechanisms based
on output perturbation  the sensitivity is    in terms
of    Fienberg et al    Yu et al    Uhler et al 
  We demonstrate that the sensitivity of the unit circle mechanism is       which achieves lower typeII
error  Theorem  
Third  we present two procedures for differentially private
multiple   tests of independence that can control the familywise error rate  FWER  Actually  FWER can be controlled properly using existing DP mechanisms for  test
by repeatedly using  Uhler et al    for example  However  such   naive construction consumes the privacy budget  which is linear to the number of all the considered

Differentially Private Chisquared Test by Unit Circle Mechanism

tests and which would produce useless test results  There
exist several studies that work with   lower privacy budget in the multiple testing setting  Johnson   Shmatikov 
  However  to the best of our knowledge  no differentially private multiple testing procedure that can control FWER properly has been presented  We introduce
two novel procedures for multiple   tests by incorporating the unit circle mechanism into the sparse vector technique  SVT   Dwork   Roth    and exponential mechanism  McSherry   Talwar    The exponential mechanism based procedure works in the noninteractive setting  in which the set of hypotheses considered needs to
be prescribed before starting the testing procedure  This
mechanism  rst selects topk signi cant hypotheses and
then performs the statistical test for each hypothesis  The
SVT based procedure works in the interactive setting  in
which the hypothesis to be considered at each round can be
interactively chosen after observing the result of the tests
in the previous rounds  The SVT based procedure controls FWER by adjusting the threshold of SVT using Monte
Carlo sampling  Simultaneously  we show the privacy budget consumed by the both procedures is not dependent on
the total number of the hypotheses considered  but only on
the prescribed maximum number of hypothesizes to be accepted 

  Preliminaries
  Differential Privacy
Let      xi xi                       be   set of records 
Presume that an analyst holds   and wishes to release
  result of statistical analysis       to the public  where
is   statistical query    and   respecf      
tively denote the input domain and output domain  Differential privacy  DP  is   privacy de nition that restricts
privacy breach of any element in   caused by releasing
           Dwork et al    Let                xi  
     xi               denote the Hamming distance between two sets  When             we say that   and   
are adjacent  or that        Ensuring DP requires randomization of outputs  by de nition  Let Mf     denote  
randomization mechanism of    Mf is differentially private if it satis es the following de nition 
De nition    DP  Dwork et al    Mechanism    
    provides  DP if  for any        and       

Pr              exp  Pr           

We introduce   basic mechanism that ensures DP for scalar
outputs  For query    the following randomization by
Laplace mechanism

               Lap 

  
 

 

guarantees  DP  where Lap    denotes   random value
generated from the Laplace distribution for which the scale
parameter is    Dwork et al       denotes the sensitivity of the query  which is de ned as

     max

                   

We remark that no postprocessing of outputs obtained
from any DP mechanism changes the guarantee on
DP  Dwork   Roth   

  Answering Multiple Queries
When we obtain multiple outputs from   mechanism computed on disjoint data subsets  the following composition
theorem is applied 
Theorem    Composition theorem  McSherry   Talwar 
  Let Mi
         be  DP mechanism for
           Let               YK be the
mechanism that outputs       MK  Then     is   
differential private 

Let            fK be   query sequence  Suppose analyst
wishes to know whether or not fk      holds for all  
where   is   threshold  If the analyst obtains  fk    
  
the privacy budget for each query needs to be set to     to
ensure  DP  which would result in extremely unuseful outputs when   is large  Suppose the analyst is interested only
in whether or not each output is above   threshold value  If
the analyst has   good reason to believe that only      
answers would exceed the threshold value  the sparse vector technique  SVT   Dwork   Roth    helps to reduce
consumption of the privacy budget drastically  Let   mean
that fk        Assuming SVT is terminated after answering at most   outputs  it outputs   only when the following
holds for            

fk      Lap           

 
 
where     Lap    and   is the sensitivity of fk
Otherwise  it outputs nothing  It is proved that SVT guarantees  DP  What is remarkable about SVT is that the privacy
budget is independent on the total number of the queries 
but only on    See Appendix    for the detail  

  Differentially Private  Test
   Test of Independence
Let    and    be discrete random variables and presume
that we are interested in the independence between the two
random variables 
In this study  we suppose the random
variables are binary  For the statistical test of independence  the null hypothesis is that    and    are independent  Let           xN  be   set of samples drawn

 We require that all the queries have the same sensitivity

Differentially Private Chisquared Test by Unit Circle Mechanism

Table  Contingency table   of two binary varaibles

             

      
      

  
  
  

     
     
  
 

from the two random variables where xT
     xn  xn   
    are realization of    and    Given    Table   denotes the       contingency table           and    where
cpq denotes the number of samples in   such that       
and         The marginals          and    are de 
 ned as in Table   The test statistic for  test of independence is given as
     

             

                             

   

Under the null hypothesis   
the  test statistics is
known to follow the   distribution with one degree of
freedom  asymptotically  Bishop et al    Given   and
signi cance level   the  test of independence is run as

 test       rej

acc

if        
otherwise 

 

  is

   

threshold determined such that
Therein 
   dz     Here  rej and acc respectively indi 
   
cate that    is rejected and accepted  We learn that there
exists evidence that    and    are dependent on the signi cance level of   if    rejected  The type  error of  
test is equivalent to the signi cance level 
    Pr          is true 

The power is de ned by the probability of rejecting the null
hypothesis when the alternative hypothesis is true 

        Pr          is true 

Therein    denotes the typeII error 
Let   be   randomization mechanism for   testing  Under the constraints that   ensures DP and that typeI error
is preserved at most   we evaluate the utility of the mechanism by       the power of the mechanism 
  Output Perturbation Method
The most straightforward method to ensure the DP of  
test is the randomization of the test statistic  Fienberg et al 
  Yu et al    Uhler et al    Wang et al 
  Application of the Laplace mechanism to the  
statistic immediately ensures DP  as

            Lap 

 
 

 

where   is the sensitivity of the test statistic  For example  given    and    are released to the public   Yu et al 
  derived the following sensitivity 

    

   

     max      
max          

 

Other sensitivity analyses are provided elsewhere in the relevant literature  Fienberg et al    Wang et al   
In principle  these sensitivities are in    with respect to
  assuming        
  Input Perturbation Method
Given   contingency table  the input perturbation method
 rst randomizes each cell of the contingency table independently as   cpq   cpq   Lap   
    and then evaluates the test
statistic with the randomized table  Johnson   Shmatikov 
  After randomization  each cell can take   negative value   Barak et al    Li et al    Hardt et al 
  Li   Miklau    Gaboardi et al    have suggested methods of calculating   differentially private contingency table while avoiding this problem  For independence testing   Gaboardi et al    modi ed the contingency table by using the work of  Lee et al    based
on constraint optimization problem so that the total number of the samples is   and each cell has   positive value 
The DP of the test statistic is readily ensured because of
the postprocessing theorem  In input perturbation  given
         Gaboardi et al    and  Wang et al   
reported by experiments that the accuracy of the test results
can be improved when the number of samples increases 

  Signi cance Level of DP   Test
The threshold for nonprivacy preserving   test is determined based on the fact that     follows the   dis 

   dz    

does not follow the   distribution anymore  even when
  holds  For the randomization mechanism to keep the
typeI error   the threshold   needs to be adjusted so that
  denote

tribution asymptotically when   holds  However     
    Pr          is true  holds  Letting  
the distribution that    follows  then   is determined
so that   
   

For the input perturbation case   Uhler et al    demonstrated that the test static arising from randomized cell
counts asymptotically approximates the   distribution 
However  the sample distribution can deviate considerably
from the   distribution when the sample size is small   
study by  Gaboardi et al    also proved that the ex 
 When one can assume that the marginal of the table     and
   is known publicly  the global sensitivity of the count query is
 

Differentially Private Chisquared Test by Unit Circle Mechanism

pectation of     generated by input perturbation is bi 

ased   Gaboardi et al    and  Wang et al    independently presented methods to correct the bias by adjusting the threshold  respectively using Monte Carlo sampling
and   permutation test 
For the output perturbation case   Uhler et al    derived   distribution of perturbed   statistic when the test
statistic is randomized with the Laplace distribution 
In
this case  the threshold can be adjusted accurately using
the derived distribution  Although not described in the
literature above speci cally  the threshold for test statistics generated by output perturbation can be adjusted using
Monte Carlo sampling in   method similar to one reported
in  Gaboardi et al   

  Power of DP   Test
The typeI error can be correctly controlled by adjusting the
threshold appropriately as discussed in Section   whereas
theoretical analysis on the power has never been intensively
investigated in existing works  For the power analysis  we
derive the following upper bound 
Theorem   Let   denote the typeII error when one use
threshold   for the  nonprivacy preserving    test  Let
           is true  be the set of distributions of sample
sets  Let   be   differentially private mechanism for  
test and       be the threshold for   that is determined
so that the typeI error of   becomes   Then for any
    the upper bound of the typeII error of   is
Pr          acc    is true   
     Pr
sup

          acc       

   

The proof is shown in Appendix    The upper bound consists of the probability term and the typeII error term  We
discuss the behavior of these terms          
The  rst probability term represents the probability that the
privacy mechanism accepts the null hypothesis when the
nonprivacy preserving test rejects it with threshold    
For notational simplicity  we call the probability term the  
error 

       
sup
   

Pr
   

          acc           

The   error measures how often the mechanism wrongly
rejects the null hypothesis  The   error thus depends on the
mechanism    The analysis of this term will be discussed
in the next subsection again 
The second term   is the typeII error of nonprivacy 
preserving test with threshold       which depends on

the mechanism  too  This term becomes smaller if   is

closer to   This occurs when the distribution of    

is close to the distribution of     In the case of output perturbation  this happens when the sensitivity of the
mechanism decreases faster           Thus   xing sample
size      greater power would be realized by employing  
mechanism with   low sensitivity  

  Power Analysis of Output Perturbation
First  we discuss the   error of output perturbation 
Theorem   Let    be    differentially private mechanism of output perturbation with sensitivity   Then  the  
error is upper bounded by  

  exp 
   

The proof is shown in Appendix    Substituting the sensitivity derived in Eq  to this bound  we can con rm that
the   error of the mechanism of  Yu et al    is    in
terms of    The same conclusion is derived from the mechanisms of  Fienberg et al    and  Wang et al   
The sensitivities employed by these mechanisms are also
     mechanism with   lower   error and   lower sensitivity is needed to achieve greater power with ensuring
DP 

  Power Analysis of Input Perturbation
In the input perturbation method  randomization is applied
to each cell  So the analysis of the   error and the sensitivity cannot be appropriately derived  Because of this
dif culty of analysis  we will evaluate the power of input
perturbation numerically in Section  

  Unit Circle Mechanism
This section introduces   variant of output perturbation 
the unit circle mechanism  This section  rst investigates
the geometrical property  Then   novel mechanism is designed based on the property  We also show that the   error and the sensitivity asymptotically vanish in the limit
of    Because of this property  the proposed mechanism
achieves better power compared to existing output perturbation mechanisms 

  Geometrical Interpretation of   Test
Given        and the marginals    and    in Table  
the test statistic of Eq    is represented as

        

             

                       

 

 

Letting            and rearranging Eq    with respect to    and    we have   quadratic form  The following lemma provides   geometrical interpretation of the test

Differentially Private Chisquared Test by Unit Circle Mechanism

 
 
 
 
 
 
 
 
 

 
 
 
 
 
 

 
 
 
 
 
 

 
 
 
 
 
 

 
 
 

 
 
 
 
 
 

 
 
 

 
 
 

 
 
 

 
 
 
 
 
 

 
 
 
 
 
 

 
 
 

 
 
 

 
 
 
  
  

    Before trans 

 
 
 

 
 
 

 
 
 

 
 
 

 
 
 
  
  

    After trans 

Figure Plot of contingency tables on the       plane before
and after transformation  Circles and triangles respectively denote
contingency tables with which the null hypothesis is rejected and
accepted 

statistic of  test on the       plane 
Lemma   Given       for any              
and                  forms an ellipse on the
      plane 

The proof is presented in Appendix    Recall that the null
hypothesis is rejected at signi cance level   if        
Using this  we can infer the following theorem 
Theorem   Given Table   speci ed by   and   threshold
         is rejected if and only if        exists outside
of the ellipse           

The proof  although it might be readily apparent  is omitted here  Figure     present plots of contingency tables
with the ellipse  For the convenience of theoretical analysis  we introduce an af ne transformation     which transforms the ellipse to the unit circle  The formulation of the
af ne transformation   is shown in Appendix   
Using this transformation    test can be conducted by using             as the test statistic 
Theorem   Given Table   speci ed by   and   threshold
         is rejected if and only if                
                exists outside of the unit circle 

The proof is presented in the Appendix    Figure     
presents the plot of contingency tables and the ellipse after transformation 

  Privacy Analysis of Unit Circle Mechanism
The input perturbation ensures DP by randomizing   
and    independently by the Laplace or Gaussian mechanism 
In the unit circle view  equivalent results are
obtainable by randomizing the distance from the origin 
            and judging whether the randomized
distance is greater than   or not  The global sensitivity of
            is derived as described below 
Lemma    Sensitivity of             Given Table
  speci ed by   and threshold       the sensitivity of

            is given as
                 

       

            

        

 

 

 

 

 

        

The proof is presented in the Appendix    This sensitivity
analysis immediately derives the following Laplace mechanism 
                     Lap 
The mechanism releasing       ensures  DP whereas  as
we already discussed in Section   if we use       as the
test statistic  the typeI error cannot be properly controlled 
To maintain typeI error as   or less  we want           to
hold with the probability of at least       if    holds  To
attain this state  we propose the unit circle mechanism in
Algorithm   that controls the typeI error by generating the
 nite sample distribution of       with MonteCarlo sampling  At line   the randomized test statistics is evaluated 
The forloop starting from line   generates the sample distribution of the randomized test statistics when the null hypothesis is true  At line   the pvalue of   is evaluated with
the sample distribution  The null hypothesis is rejected at
line   if the pvalue is less than the signi cance level 
Theorem   Algorithm   ensures  DP 

If marginals             are public  then computation
with Sk does not consume the privacy budget because Sk
are samples that are arti cially generated using the distribution speci ed by the public marginals  All operations after
line   are attributable to post processing and therefore do
not consume the privacy budget  Consequently  the privacy
budget is consumed at line   only  Thus  the proof is immediately obtained by the privacy guarantee of the mechanism
based on the global sensitivity Dwork et al   

  Utility Analysis of Unit Circle Mechanism
From the discussion in Section   the power of test mechanisms can be investigated by analyzing the   error and the
sensitivity  The   error of Algorithm   is obtained using
the following theorem 
Theorem   The   error of Algorithm   is

 

                

 
 

exp    
 

     

       
      
              

     

       

    

 

is

The proof

shown in Appendix    Eq 

  exp     and asymptotically vanishing as the sam 

ple size increases  Furthermore  the sensitivity of the unit

  is

Differentially Private Chisquared Test by Unit Circle Mechanism

 

      
   

      
   

      
     

Algorithm   Unit Circle Mechanism
Require  Sample set    sig level   privacy budget  
  Evaluate contingency table from  
                        Lap           
  for       to   do
Sk   mult      
 
   
Evaluate contingency table from Sk
 
   Sk        ck
 
  end for
                       
 
  if     then
Return rej
 
  else
 
  end if

      Lap          

Return acc

  ck

 

      
   

 

 

circle mechanism is      
  as derived from Eq    Thus 
from the discussion in Section   the upper bound of the
typeII error of Algorithm   is expected to decrease with  
faster rate than existing output perturbation method 

  Differentially Private Multiple  test
Presume that we are interested in the independence between random variables    and other   random variables 
              XK  The objective is investigation of the independence between    and Xk for                  We
denote the null hypothesis that    and Xk are independent
by    
    The test statistic for independence between    and
Xk is calculated with the set of samples Sk  We suppose
      and   are the same for all Sk  We can verify the
independence of each random variable pair by evaluating
Eq    with Sk for                 in turn  In multiple hypothesis testing  we consider to control the familywise error rate  FWER  the probability that the null hypothesis
is rejected mistakenly at least once among   tests  If the
signi cance of each test is kept     the FWER of the  
tests in this setting is given as                  which
increases as   increases  We use Bonferroni correction to
correct the signi cance level so that the FWER for the entire test set is kept less than    Bonferroni   
We can realize DP multiple  test using the DP   test
mechanisms repeatedly  However  the privacy guarantee
weakens as the number of hypothesis   increases by Theorem    Fienberg et al    presented   multiple testing procedure using output perturbation  This method consumes   privacy budget that is proportional to    which
makes it almost impossible to obtain useful results under
  meaningful privacy guarantee 
 Johnson   Shmatikov 
  Yu et al    Simmons   Berger    presented   method which outputs the top    signi cant
random variable pairs using the exponential mechanism

 McSherry   Talwar    This method outputs    pairs
even if all pairs are not signi cant 
For that reason 
naive application of exponential mechanism cannot control
FWER 
In this section  we provide two differentially private multiple hypothesis testing methods that can conserve the privacy budget even with large   and controls FWER properly  The exponential mechanism based procedure works in
the noninteractive setting  in which the set of hypotheses
considered needs to be prescribed before starting the testing procedure  The SVT based procedure works in the interactive setting  Lyu et al    in which the hypothesis
to be considered at each round can be interactively chosen
after observing the result of the tests in the previous rounds
 Webb   Petitjean   

that

  Unit Circle Mechanism   SVT
We  rst show the SVTbased procedure with the unit
circle mechanism  UCM SVT  Recall
the unit
circle mechanism veri es the result by checking if
                Also  provided all the marginals
are public information and    and    are the same for all
Sk  the sensitivity of             is the same for any
contingency table  Thus  the unit circle mechanism can be
naturally incorporated into SVT 
Application of the unit circle mechanism       thresholding by Eq    to SVT immediately guarantees differential
privacy  However  the typeI error cannot be properly controlled by the naive combination  Recall that SVT adds
noise to the threshold to compare in Eq    In order to control the typeI error  the threshold of SVT should be properly adjusted considering the effect of the additive noise 
We employ Monte Carlo sampling to determine the threshold that properly controls the typeI error  Also  we use
Bonferoni correction to control the FWER 
The UCM SVT takes as input sample sets      SK cid 
the signi cance level   the privacy budget   and stop parameters         The UCN SVT is terminated if   it
rejects at most    null hypotheses  or   it outputs    test
results  Here  we remark the stop parameter    is not used
in the regular SVT  In our setting  we need to apply Bonferroni correction to control the FWER  We thus use    to upper bound the maximum number of hypotheses considered 
The settings and the algorithm are detailed in Appendix   
In the experimental results of single hypothesis test in Section   input perturbation MC also achieves good performance  However  when input perturbation is used  the sensitivity of the test statistic is not uniform and thus it cannot
be used with SVT 

Differentially Private Chisquared Test by Unit Circle Mechanism

  Unit Circle Mechanism   EM
We introduce another DP multiple test procedure using the
exponential mechanism  UCM EM  By simple application of the exponential mechanism  we can get the top   
signi cant random variable pairs  However  this method
outputs    pairs even if all pairs are not signi cant  For
that reason  it cannot control FWER  By adding    significant dummy pairs of random variables  we can avoid accepting nonsigni cant random variable pairs  However 
this method does not necessarily control FWER properly
because we cannot add appropriate dummy pairs to control FWER without knowing the scores related the pvalues
of nonsigni cant pairs  In order to control FWER properly  we can use the exponential mechanism to select candidate pairs  and then apply the unit circle mechanism to
the candidate pairs so that the signi cance level of each
test is properly controlled  The settings and the algorithm
is detailed in Appendix   

  Experiment
  Experiments for Single Testing
In this section  we evaluate the signi cance and the
power of the respective mechanisms 
input perturbation  Gaboardi et al    output perturbation  Yu et al 
  and unit circle mechanism for single hypothesis
testing  Both the output perturbation and the unit circle mechanism use    and    as public information  If
these are public  the sensitivity of the input perturbation
can be made   For controlling the signi cance of input
perturbation  we use MCIndepLap with the Laplace distribution in  Gaboardi et al    The signi cance of the
unit circle mechanism and output perturbation is controlled
by adjusting   by Monte Carlo sampling  For Monte
Carlo sampling  we set the number of sampling as  
for MCIndepLap with the laplace distribution  and  
for the other methods  For output perturbation  we used the
sensitivity derived in Eq 
Signi cance  To evaluate the signi cance  we sample
  contingency tables from mult       
so that    is true  mult  denotes the multinomial
distribution  Then  we assess the proportion that the mechanism outputs acc correctly  We set the privacy parameter
as       and signi cance level as      
In Figure   the signi cance of mechanisms are shown  If
Monte Carlo sampling is not used  Figure       the
signi cance remains poor for small samples  The significance of output perturbation unchanged even when the
sample size increases  However  the input perturbation and
the unit circle mechanism improve the signi cance as the
sample size increases  The controlled signi cance version
of these mechanisms can properly control the signi cance

at   for any sample size  Figure      
Power  Evaluation of the power of the respective mechanisms controlling signi cance is presented  We sample
  contingency tables from mult         
              so that    is true  To evaluate the power  we assess the rate at which the mechanism
outputs rej correctly when    is true  We set the privacy
parameter       and signi cance level      
Figure   shows that the unit circle mechanism with Monte
Carlo sampling  UCM MC  has similar power to that
of the input perturbation with Monte Carlo sampling
 IP MC  In addition  compared with output perturbation
with Monte Carlo sampling  OP MC  UCM MC quickly
improves the power as the number of samples increases 
The  error of UCM MC can be analyzed as discussed in
Section   UCM MC has   faster rate of the power than
OP MC because the  error of the UCM MC decreases as
the sample size increases  Unlike the UCM OP MC  the  
error of IP MC has never been analyzed  The UCM MC
is thus advantageous compared with the IP MC in that the
upper bound of typeII error is analyzed by Theorem   We
remark that  looking at the results of the power  IP MC
and UCM MC might have the same the  error rate  The
analysis of IP MC remains as future work 

  Experiments for Multiple Testing
In this subsection  we experimentally evaluate FWER and
utility of UCM SVT and UCM EM 
FWER  FWER can be properly controlled if the signi 
cance for   single test is exactly adjusted to   by using
the Bonferroni correction  In UCM EM  the signi cance
of each test perfomed by UCM is properly controlled with
  suf ciently large number of Monte Carlo samples  We
can thus guarantee that FWER is properly controlled by applying Bonferroni correction  Since we can con rme this
from Fig    we skip experimental evaluation of the signi cance of UCM EM  Similarly  UCM SVT is expected
to properly control FWER with   suf ciently large number
of Monte Carlo samples  To con rm this  we evaluate the
FWER of UCM SVT experimentally 
In order to evaluate the FWER of UCM SVT  all samples must be drawn from the null distribution  We
arti cially generated samples for evaluation in the following manner  We generated   sample sets from
mult        so that    is true  Then  we
assess the rate at which UCM SVT outputs acc correctly 
We set the privacy parameter as       and the signi 
cance level as       We set the stop parameters as
       and        and evaluate the signi cance      
for   single test instead of FWER  Note that we can control
FWER by Bonferroni correction for multiple tests if the

Differentially Private Chisquared Test by Unit Circle Mechanism

    Input perturbation

    Output Perturbation

    UC Mechanism

    Input perturbation   MC

    Output Perturbation MC

    UC Mechanism  MC

Figure  Plot of signi cance  The signi cance becomes   if properly controled 

       

     

       

       

     

     

     

For evaluation  we arti cially generated       sample sets in the following method  We    the marginals
    and then
   
create the sample sets            SK so that the test statistics of the resulting sample sets become  Sk   
                    Two of them reject the corresponding null hypotheses at signi cance level      
after Bonferroni correction        Sk      Regarding
the remaining eight sample sets  the corresponding null hypotheses are accepted  We input Sk to the algorithms  and
then evaluate the utility  For utility measure  we employ the
correctness  
     where   is the number that the algorithm
outputs rej correctly     is the number of the contingency
tables rejected by nonprivate multiple   tests with Bonferroni correction  In our arti cially generated sample sets 
       For UCM SVT  we input the sample sets in   random order  We set the privacy parameter as        
the signi cance levels as       and the stop parameters
as              
Figure   shows the correctness  average of   trials  of
each algorithm with respect to the sample size  As we see
from the  gure  the correctness of UCM SVT approaches
to   when   increases while the correctness of OP SVT
does not  This is because the sensitivity of the unit circle
mechanism decreases faster than that of output perturbation with respect to the sample size  Both UCM EM and
IP EM have the comparable correctness  We remark that
UCM is advantageous compared to IP in the sense that the
typeII error of UCM is upperbounded as we discuss in
Section   while no theoretical guarantee on the typeII error of input perturbation is provided 
The algorithms using EM achieves better correctness than
the algorithms using SVT  This difference of the correctness comes from the settings that SVT and EM can handle 
As we discussed in Section   SVT can deal with the interactive setting whereas EM considers the noninteractive
setting only  In this sense  the results of these two procedures are not directly comparable 

Figure Change of the power with respect to the sample size   

Figure  plot of FWER 

Figure  Plot of the correct rate 

mechanism can guarantee the signi cance of   single test 
Also  we remark that this does not mean that our mechanism cannot work with multiple sample sets 
Figure   shows the signi cance level of UCM SVT when
the sample size is changed  As we can see from the  gure 
UCM SVT can control the signi cance at the prescribed
level   for any sample size 
Utility  Next  we compare the utility of UCM SVT and
UCM EM with existing methods  We denote the SVT with
the output perturbation by OP SVT  the EM with the input perturbation by IP EM  We compare the correctness of
these algorithms with respect to the sample size 

Differentially Private Chisquared Test by Unit Circle Mechanism

Acknowledgement
We thank anonymous reviewers for insightful reviews and
discussions  We appreciate that one of the reviewers gives
an important suggestion regarding the combination of the
unit circle mechanism and exponential mechanism  We
thank Prof  Hideitsu Hino and Dr  Masayuki Terada for
important comments that greatly improved the manuscript 
The research is partly supported by JST CREST Grant
Number JPMJCR  and JSPS Grandin Aid for Scienti   Research No     

References
Barak  Boaz  Chaudhuri  Kamalika  Dwork  Cynthia  Kale 
Satyen  McSherry  Frank  and Talwar  Kunal  Privacy 
accuracy  and consistency too    holistic solution to contingency table release  In Proceedings of the twentysixth
ACM SIGMODSIGACT SIGART symposium on Principles of database systems  pp     

Bishop  Yvonne      Fienberg  Stephen    and Holland 
Paul    Discrete multivariate analysis  Theory and practice   

Bonferroni       Teoria statistica delle classi   calcolo
delle probabilit    Pubblicazioni del    Istituto superiore
di scienze economiche   commerciali di Firenze  Libreria internazionale Seeber   

Cai  Bryan  Daskalakis  Constantinos  and Kamath  Gautam  Priv it  Private and sample ef cient identity testing 
In Proceedings of The  rd International Conference on
Machine Learning  pp  to appear   

Dwork  Cynthia and Roth  Aaron  The algorithmic foundations of differential privacy  Foundations and Trends in
Theoretical Computer Science     

Dwork  Cynthia  McSherry  Frank  Nissim  Kobbi  and
Smith  Adam  Calibrating noise to sensitivity in private
data analysis  In Proceedings of the Third Conference on
Theory of Cryptography  pp     

Fienberg  Stephen    Slavkovic  Aleksandra  and Uhler 
Caroline  Privacy preserving gwas data sharing  In Proceedings of the   IEEE  th International Conference on Data Mining Workshops  pp     

Gaboardi  Marco  Arias  Emilio Jes us Gallego  Hsu  Justin 
Roth  Aaron  and Wu  Zhiwei Steven  Dual query  Practical private query release for high dimensional data  In
Proceedings of The  rd International Conference on
Machine Learning  pp     

Gaboardi  Marco  Lim  Hyun  Rogers  Ryan  and Vadhan 
Salil  Differentially private chisquared hypothesis test 

ing  Goodness of    and independence testing  In Proceedings of The  rd International Conference on Machine Learning  pp     

Hardt  Moritz  Ligett  Katrina  and McSherry  Frank   
simple and practical algorithm for differentially private
data release 
In Advances in Neural Information Processing Systems   pp     

Homer  Nils  Szelinger  Szabolcs  Redman  Margot  Duggan  David  Tembe  Waibhav  Muehling  Jill  Pearson 
John    Stephan  Dietrich    Nelson  Stanley    and
Craig  David    Resolving individuals contributing trace
amounts of dna to highly complex mixtures using highdensity snp genotyping microarrays  PLoS genetics   
     

Johnson  Aaron and Shmatikov  Vitaly  Privacypreserving
data exploration in genomewide association studies  In
Proceedings of the  th ACM SIGKDD International
Conference on Knowledge Discovery and Data Mining 
pp     

Lee  Jaewoo  Wang  Yue  and Kifer  Daniel  Maximum
likelihood postprocessing for differential privacy under
consistency constraints  In Proceedings of the  th ACM
SIGKDD International Conference on Knowledge Discovery and Data Mining  pp     

Li  Chao and Miklau  Gerome  An adaptive mechanism
for accurate query answering under differential privacy 
In Proceedings of the VLDB Endowment  volume   pp 
   

Li  Chao  Hay  Michael  Rastogi  Vibhor  Miklau  Gerome 
and McGregor  Andrew  Optimizing linear counting
queries under differential privacy 
In Proceedings of
the twentyninth ACM SIGMODSIGACT SIGART symposium on Principles of database systems  pp   
 

Lyu  Min  Su  Dong  and Li  Ninghui  Understanding the
sparse vector technique for differential privacy  In Proceedings of the VLDB Endowment  volume   pp   
   

McSherry  Frank and Talwar  Kunal  Mechanism design via
differential privacy  In Proceedings of the  th Annual
IEEE Symposium on Foundations of Computer Science 
pp     

Simmons  Sean and Berger  Bonnie  Realizing privacy preserving genomewide association studies  Bioinformatics     

Uhler  Caroline  Slavkovi    Aleksandra  and Fienberg 
Stephen    Privacypreserving data sharing for genomewide association studies  The Journal of privacy and
con dentiality     

Differentially Private Chisquared Test by Unit Circle Mechanism

Wang  Yue  Lee  Jaewoo  and Kifer  Daniel  Differentially private hypothesis testing  revisited  arXiv preprint
arXiv   

Webb  Geoffrey   and Petitjean  Franc ois    multiple test
correction for streams and cascades of statistical hypothesis tests 
In Proceedings of the  nd ACM SIGKDD
International Conference on Knowledge Discovery and
Data Mining  pp     

Yu  Fei  Fienberg  Stephen    Slavkovi    Aleksandra    and
Uhler  Caroline  Scalable privacypreserving data sharing methodology for genomewide association studies 
Journal of biomedical informatics     

